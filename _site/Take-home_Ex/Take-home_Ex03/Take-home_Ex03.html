<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yang Lu">
<meta name="dcterms.date" content="2025-05-29">

<title>Take home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/snorlax.webp" alt="Snorlax" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 3B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 4A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 4B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 4C</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 4D</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1 phase 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 1 phase 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 2-VAST Challenges 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vast-challenge-2025-mini-challenge-3" id="toc-vast-challenge-2025-mini-challenge-3" class="nav-link active" data-scroll-target="#vast-challenge-2025-mini-challenge-3">VAST Challenge 2025-Mini-Challenge 3</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.0 Background</a>
  <ul class="collapse">
  <li><a href="#overall-tasks" id="toc-overall-tasks" class="nav-link" data-scroll-target="#overall-tasks"><strong>2.0 Overall Tasks</strong></a></li>
  </ul></li>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link" data-scroll-target="#setting-up">3.0 Setting up</a>
  <ul class="collapse">
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">3.1 Loading packages</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data">3.2 Loading data</a></li>
  <li><a href="#examining-the-data-structure" id="toc-examining-the-data-structure" class="nav-link" data-scroll-target="#examining-the-data-structure">3.3 Examining the data structure</a></li>
  </ul></li>
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">4.Initial EDA</a></li>
  <li><a href="#task-1-clepper-found-that-messages-frequently-came-in-at-around-the-same-time-each-day." id="toc-task-1-clepper-found-that-messages-frequently-came-in-at-around-the-same-time-each-day." class="nav-link" data-scroll-target="#task-1-clepper-found-that-messages-frequently-came-in-at-around-the-same-time-each-day.">5.0 Task 1-Clepper found that messages frequently came in at around the same time each day.</a>
  <ul class="collapse">
  <li><a href="#task-1.1-create-visual-analytics-to-identify-daily-patterns-in-communication-timing" id="toc-task-1.1-create-visual-analytics-to-identify-daily-patterns-in-communication-timing" class="nav-link" data-scroll-target="#task-1.1-create-visual-analytics-to-identify-daily-patterns-in-communication-timing">Task 1.1: Create visual analytics to identify daily patterns in communication timing</a></li>
  <li><a href="#task-1.2-compare-the-shape-of-daily-rhythm-between-week-1-and-week-2" id="toc-task-1.2-compare-the-shape-of-daily-rhythm-between-week-1-and-week-2" class="nav-link" data-scroll-target="#task-1.2-compare-the-shape-of-daily-rhythm-between-week-1-and-week-2">Task 1.2 Compare the shape of daily rhythm between week 1 and week 2</a></li>
  <li><a href="#task-1.3-focus-on-a-specific-entity-and-use-this-information-to-determine-who-has-influence-over-them." id="toc-task-1.3-focus-on-a-specific-entity-and-use-this-information-to-determine-who-has-influence-over-them." class="nav-link" data-scroll-target="#task-1.3-focus-on-a-specific-entity-and-use-this-information-to-determine-who-has-influence-over-them.">Task 1.3: Focus on a specific entity and use this information to determine who has influence over them.</a></li>
  </ul></li>
  <li><a href="#task-2-clepper-has-noticed-that-people-often-communicate-with-or-about-the-same-people-or-vessels-and-that-grouping-them-together-may-help-with-the-investigation." id="toc-task-2-clepper-has-noticed-that-people-often-communicate-with-or-about-the-same-people-or-vessels-and-that-grouping-them-together-may-help-with-the-investigation." class="nav-link" data-scroll-target="#task-2-clepper-has-noticed-that-people-often-communicate-with-or-about-the-same-people-or-vessels-and-that-grouping-them-together-may-help-with-the-investigation.">Task 2: Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.</a>
  <ul class="collapse">
  <li><a href="#task-2.1-develop-visualizations-to-explore-connections-between-vessels-and-people" id="toc-task-2.1-develop-visualizations-to-explore-connections-between-vessels-and-people" class="nav-link" data-scroll-target="#task-2.1-develop-visualizations-to-explore-connections-between-vessels-and-people">Task 2.1 :Develop visualizations to explore connections between vessels and people</a></li>
  <li><a href="#task-2.2-identify-closely-associated-groups-and-the-predominant-topics-for-each-group" id="toc-task-2.2-identify-closely-associated-groups-and-the-predominant-topics-for-each-group" class="nav-link" data-scroll-target="#task-2.2-identify-closely-associated-groups-and-the-predominant-topics-for-each-group">Task 2.2 ：Identify closely associated groups and the predominant topics for each group</a></li>
  <li><a href="#task-3-pseudonym-identification" id="toc-task-3-pseudonym-identification" class="nav-link" data-scroll-target="#task-3-pseudonym-identification"><strong>Task 3: Pseudonym Identification</strong></a></li>
  <li><a href="#task-3.1-expand-visualizations-to-reveal-who-is-using-pseudonyms" id="toc-task-3.1-expand-visualizations-to-reveal-who-is-using-pseudonyms" class="nav-link" data-scroll-target="#task-3.1-expand-visualizations-to-reveal-who-is-using-pseudonyms">Task 3.1 Expand visualizations to reveal who is using pseudonyms</a></li>
  <li><a href="#task-3.2-visual-analytics-to-identify-common-entity-pseudonym-and-their-network" id="toc-task-3.2-visual-analytics-to-identify-common-entity-pseudonym-and-their-network" class="nav-link" data-scroll-target="#task-3.2-visual-analytics-to-identify-common-entity-pseudonym-and-their-network">Task 3.2 ：Visual analytics to identify common entity (Pseudonym and their network)</a></li>
  <li><a href="#task-3.3-how-does-your-understanding-of-activities-change-given-your-understanding-of-pseudonyms" id="toc-task-3.3-how-does-your-understanding-of-activities-change-given-your-understanding-of-pseudonyms" class="nav-link" data-scroll-target="#task-3.3-how-does-your-understanding-of-activities-change-given-your-understanding-of-pseudonyms">Task 3.3 :How does your understanding of activities change given your understanding of pseudonyms?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yang Lu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 29, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 27, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="vast-challenge-2025-mini-challenge-3" class="level1">
<h1>VAST Challenge 2025-Mini-Challenge 3</h1>
<p>For the exercise, our group will choose MC 3 as our main topic, the detail background referring to <a href="https://vast-challenge.github.io/2025/MC3.html">VAST MC3</a></p>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.0 Background</h2>
<p><strong>Oceanus: From Fishing Nets to Tourism Tensions</strong></p>
<p>Once defined by its fishing traditions, Oceanus has transformed dramatically in the last decade. After a crackdown on illegal fishing, those involved redirected investments toward ocean tourism, creating community friction. When international star Sailor Shift announced plans to film locally, investigative journalist Clepper Jessen uncovered troubling connections around the temporary closure of Nemo Reef. His work exposed expedited approvals and secretive arrangements linking island officials, Sailor’s team, influential local families, and conservationists The Green Guardians—suggesting a story of corruption hiding beneath paradise’s surface.</p>
<section id="overall-tasks" class="level3">
<h3 class="anchored" data-anchor-id="overall-tasks"><strong>2.0 Overall Tasks</strong></h3>
<p>Clepper has built a knowledge graph from two weeks of intercepted radio communications in Oceanus. Here are the key tasks to be analyzed:</p>
<p><strong>Task 1: Temporal Communication Patterns</strong></p>
<ol type="1">
<li><p>Create visual analytics to identify daily patterns in communication timing</p></li>
<li><p>Analyze how these patterns changed over the two-week observation period</p></li>
<li><p>Focus on a specific entity and use this information to determine who has influence over them.</p></li>
</ol>
<p><strong>Task 2: Relationship Analysis</strong></p>
<ol type="1">
<li><p>Develop visualizations to explore connections between vessels and people</p></li>
<li><p>Identify closely associated groups and the predominant topics for each group</p></li>
</ol>
<p><strong>Task 3: Pseudonym Identification</strong></p>
<ol type="1">
<li><p>Expand visualizations to reveal who is using pseudonyms</p></li>
<li><p>Visual analytics to identify common entity</p></li>
<li><p>Explain how understanding pseudonyms changes interpretation of activities</p></li>
</ol>
</section>
</section>
<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">3.0 Setting up</h2>
<section id="loading-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-packages">3.1 Loading packages</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">jsonlite</td>
<td style="text-align: left;">JSON parsing and generation</td>
</tr>
<tr class="even">
<td style="text-align: left;">tidyverse</td>
<td style="text-align: left;">Core data-science suite (dplyr, ggplot2, etc.)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SmartEDA</td>
<td style="text-align: left;">Automated exploratory data analysis</td>
</tr>
<tr class="even">
<td style="text-align: left;">tidygraph</td>
<td style="text-align: left;">Tidy tools for graph-data manipulation and analysis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ggraph</td>
<td style="text-align: left;">Grammar-based graph/network visualization</td>
</tr>
<tr class="even">
<td style="text-align: left;">lubridate</td>
<td style="text-align: left;">Easy parsing and manipulation of dates/times</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dplyr</td>
<td style="text-align: left;">Grammar of data manipulation (filter, mutate, etc.)</td>
</tr>
<tr class="even">
<td style="text-align: left;">patchwork</td>
<td style="text-align: left;">Combine multiple ggplots into a unified layout</td>
</tr>
<tr class="odd">
<td style="text-align: left;">purrr</td>
<td style="text-align: left;">Functional programming tools for lists and vectors</td>
</tr>
<tr class="even">
<td style="text-align: left;">scales</td>
<td style="text-align: left;">Scale functions for visualization (axis breaks, formatting)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RColorBrewer</td>
<td style="text-align: left;">Color palettes for maps and plots</td>
</tr>
<tr class="even">
<td style="text-align: left;">plotly</td>
<td style="text-align: left;">Interactive web-based charts</td>
</tr>
<tr class="odd">
<td style="text-align: left;">igraph</td>
<td style="text-align: left;">Network analysis and graph algorithms</td>
</tr>
<tr class="even">
<td style="text-align: left;">viridis</td>
<td style="text-align: left;">Color scales for scientific visualization (colorblind-friendly)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">forcats</td>
<td style="text-align: left;">Tools for working with categorical variables (factors)</td>
</tr>
<tr class="even">
<td style="text-align: left;">knitr</td>
<td style="text-align: left;">Dynamic report generation and literate programming</td>
</tr>
<tr class="odd">
<td style="text-align: left;">visNetwork</td>
<td style="text-align: left;">Interactive network visualization in R</td>
</tr>
<tr class="even">
<td style="text-align: left;">htmltools</td>
<td style="text-align: left;">Tools for HTML generation and dependency management</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stringr</td>
<td style="text-align: left;">Consistent, simple tools for string manipulation</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  jsonlite,tidyverse,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  SmartEDA,tidygraph,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  ggraph,lubridate,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  dplyr,patchwork,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  purrr,scales,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  RColorBrewer,plotly,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  igraph,viridis,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  forcats,knitr,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  visNetwork,htmltools,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-data">3.2 Loading data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC3_graph <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ directed  : logi TRUE
 $ multigraph: logi FALSE
 $ graph     :List of 4
  ..$ mode        : chr "static"
  ..$ edge_default: Named list()
  ..$ node_default: Named list()
  ..$ name        : chr "VAST_MC3_Knowledge_Graph"
 $ nodes     :'data.frame': 1159 obs. of  31 variables:
  ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  ..$ findings         : chr [1:1159] NA NA NA NA ...
  ..$ content          : chr [1:1159] NA NA NA NA ...
  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  ..$ results          : chr [1:1159] NA NA NA NA ...
  ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  ..$ destination      : chr [1:1159] NA NA NA NA ...
  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  ..$ outcome          : chr [1:1159] NA NA NA NA ...
  ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  ..$ thing_collected  :'data.frame':   1159 obs. of  2 variables:
  .. ..$ type: chr [1:1159] NA NA NA NA ...
  .. ..$ name: chr [1:1159] NA NA NA NA ...
  ..$ reference        : chr [1:1159] NA NA NA NA ...
  ..$ date             : chr [1:1159] NA NA NA NA ...
  ..$ time             : chr [1:1159] NA NA NA NA ...
  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  ..$ start_date       : chr [1:1159] NA NA NA NA ...
  ..$ end_date         : chr [1:1159] NA NA NA NA ...
  ..$ report_type      : chr [1:1159] NA NA NA NA ...
  ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  ..$ operational_role : chr [1:1159] NA NA NA NA ...
 $ edges     :'data.frame': 3226 obs. of  5 variables:
  ..$ id         : chr [1:3226] "2" "3" "5" "3013" ...
  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  ..$ source     : chr [1:3226] "Sam" "Sam" "Sam" "Sam" ...
  ..$ target     : chr [1:3226] "Relationship_Suspicious_217" "Event_Communication_370" "Event_Assessment_600" "Relationship_Colleagues_430" ...
  ..$ type       : chr [1:3226] NA "sent" NA NA ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>) </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3_schema)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ schema:List of 2
  ..$ nodes:List of 3
  .. ..$ Entity      :List of 2
  .. ..$ Event       :List of 2
  .. ..$ Relationship:List of 2
  ..$ edges:List of 3
  .. ..$ description: chr "Connections between nodes in the knowledge graph"
  .. ..$ is_inferred: chr "bool"
  .. ..$ types      :'data.frame':  6 obs. of  5 variables:</code></pre>
</div>
</div>
</section>
<section id="examining-the-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-data-structure">3.3 Examining the data structure</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nodes_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>nodes)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>edges_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(nodes_tbl, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">label</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">sub_type</th>
<th style="text-align: left;">id</th>
<th style="text-align: left;">timestamp</th>
<th style="text-align: left;">monitoring_type</th>
<th style="text-align: left;">findings</th>
<th style="text-align: left;">content</th>
<th style="text-align: left;">assessment_type</th>
<th style="text-align: left;">results</th>
<th style="text-align: left;">movement_type</th>
<th style="text-align: left;">destination</th>
<th style="text-align: left;">enforcement_type</th>
<th style="text-align: left;">outcome</th>
<th style="text-align: left;">activity_type</th>
<th style="text-align: right;">participants</th>
<th style="text-align: left;">thing_collected</th>
<th style="text-align: left;">reference</th>
<th style="text-align: left;">date</th>
<th style="text-align: left;">time</th>
<th style="text-align: left;">friendship_type</th>
<th style="text-align: left;">permission_type</th>
<th style="text-align: left;">start_date</th>
<th style="text-align: left;">end_date</th>
<th style="text-align: left;">report_type</th>
<th style="text-align: left;">submission_date</th>
<th style="text-align: left;">jurisdiction_type</th>
<th style="text-align: left;">authority_level</th>
<th style="text-align: left;">coordination_type</th>
<th style="text-align: left;">operational_role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Sailor Shift</td>
<td style="text-align: left;">Sailor Shift</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Sailor Shift</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entity</td>
<td style="text-align: left;">Clepper Jensen</td>
<td style="text-align: left;">Clepper Jensen</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Clepper Jensen</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(edges_tbl, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">is_inferred</th>
<th style="text-align: left;">source</th>
<th style="text-align: left;">target</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Relationship_Suspicious_217</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Event_Communication_370</td>
<td style="text-align: left;">sent</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Event_Assessment_600</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">3013</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Relationship_Colleagues_430</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Relationship_Friends_272</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Relationship_Colleagues_215</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: left;">Relationship_Colleagues_431</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">Event_Communication_3</td>
<td style="text-align: left;">sent</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">Event_Communication_443</td>
<td style="text-align: left;">sent</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">Kelly</td>
<td style="text-align: left;">Relationship_Friends_272</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>after split to nodes and edges, the data show <strong>3226 edges</strong> and <strong>1159 nodes</strong></p>
</section>
</section>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">4.Initial EDA</h2>
<p>It is time for us to apply appropriate EDA methods to examine the data.</p>
<p>In the code chunk below, ExpCatViz() of SmartEDA package is used to reveal the frequency distribution of all categorical fields in nodes_tbl tibble dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data =</span> nodes_tbl,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[13]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[14]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On the other hands, code chunk below uses ExpCATViz() of SmartEDA package to reveal the frequency distribution of all categorical fields in MC3_edges tibble data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>edges_tbl,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-1-clepper-found-that-messages-frequently-came-in-at-around-the-same-time-each-day." class="level2">
<h2 class="anchored" data-anchor-id="task-1-clepper-found-that-messages-frequently-came-in-at-around-the-same-time-each-day.">5.0 Task 1-Clepper found that messages frequently came in at around the same time each day.</h2>
<section id="task-1.1-create-visual-analytics-to-identify-daily-patterns-in-communication-timing" class="level3">
<h3 class="anchored" data-anchor-id="task-1.1-create-visual-analytics-to-identify-daily-patterns-in-communication-timing">Task 1.1: Create visual analytics to identify daily patterns in communication timing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>nodes_tbl,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">type</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>nodes_tbl,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">sub_type</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="step-1-generate-node-sub-type-inventory" class="level4">
<h4 class="anchored" data-anchor-id="step-1-generate-node-sub-type-inventory"><strong>Step 1: Generate Node Sub-Type Inventory</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique sub_types for each node type</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>entities      <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(nodes_tbl<span class="sc">$</span>sub_type[nodes_tbl<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Entity"</span>]))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>events        <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(nodes_tbl<span class="sc">$</span>sub_type[nodes_tbl<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Event"</span>]))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>relationships <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(nodes_tbl<span class="sc">$</span>sub_type[nodes_tbl<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Relationship"</span>]))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>node_inventory <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Entities      =</span> entities,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Events        =</span> events,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Relationships =</span> relationships</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-2-list-down-type-and-relevant-sub-types" class="level4">
<h4 class="anchored" data-anchor-id="step-2-list-down-type-and-relevant-sub-types"><strong>Step 2: List down type and relevant sub types</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (grp <span class="cf">in</span> <span class="fu">names</span>(node_inventory)) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"**"</span>, grp, <span class="st">"** ("</span>, <span class="fu">length</span>(node_inventory[[grp]]), <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"  - "</span>, node_inventory[[grp]]), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**Entities** (5):
  - Group
  - Location
  - Organization
  - Person
  - Vessel

**Events** (11):
  - Assessment
  - Collaborate
  - Communication
  - Criticize
  - Enforcement
  - Fishing
  - HarborReport
  - Monitoring
  - TourActivity
  - TransponderPing
  - VesselMovement

**Relationships** (9):
  - AccessPermission
  - Colleagues
  - Coordinates
  - Friends
  - Jurisdiction
  - Operates
  - Reports
  - Suspicious
  - Unfriendly</code></pre>
</div>
</div>
</section>
<section id="step-3-create-communication-nodes" class="level4">
<h4 class="anchored" data-anchor-id="step-3-create-communication-nodes">Step 3: Create communication nodes</h4>
<p>based on the above list, we noticed that based on the task requirement, now we only focus on type=“event” and sub_type =“communication”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>comm_nodes <span class="ot">&lt;-</span>nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Event"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>         sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> id,timestamp)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(comm_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 584
Columns: 2
$ event_id  &lt;chr&gt; "Event_Communication_1", "Event_Communication_2", "Event_Com…
$ timestamp &lt;chr&gt; "2040-10-01 08:09:00", "2040-10-01 08:10:00", "2040-10-01 08…</code></pre>
</div>
</div>
</section>
<section id="step-4-define-sender-and-receiver" class="level4">
<h4 class="anchored" data-anchor-id="step-4-define-sender-and-receiver"><strong>Step 4: Define sender and receiver</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>edges_tbl,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">type</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-extract-data-from-sender-and-receiver" class="level4">
<h4 class="anchored" data-anchor-id="step-5-extract-data-from-sender-and-receiver"><strong>Step 5: Extract data from sender and receiver</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sent_edges <span class="ot">&lt;-</span>edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"sent"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">sender =</span> source,<span class="at">event_id=</span>target)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>recv_edges <span class="ot">&lt;-</span>edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"received"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> source,<span class="at">receiver=</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-6-using-inner_join-to-combine-sender-and-receiver" class="level4">
<h4 class="anchored" data-anchor-id="step-6-using-inner_join-to-combine-sender-and-receiver"><strong>Step 6: using inner_join to combine sender and receiver</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>msgs <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(recv_edges, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_nodes, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ts =</span> <span class="fu">ymd_hms</span>(timestamp, <span class="at">tz=</span><span class="st">"UTC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(ts), <span class="at">hour =</span> <span class="fu">hour</span>(ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-7-visualizing-the-heat-map" class="level4">
<h4 class="anchored" data-anchor-id="step-7-visualizing-the-heat-map"><strong>Step 7: Visualizing the heat map</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date, hour) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">seq</span>(<span class="fu">min</span>(date), <span class="fu">max</span>(date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heatmap_data, <span class="fu">aes</span>(<span class="at">x=</span>hour, <span class="at">y=</span>date, <span class="at">fill=</span>n)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_date</span>(</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(heatmap_data<span class="sc">$</span>date), <span class="fu">max</span>(heatmap_data<span class="sc">$</span>date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%b %d"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">name    =</span> <span class="st">"Messages"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="dv">1</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Communication Patterns"</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Hour of Day"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Date"</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x  =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid  =</span> <span class="fu">element_blank</span>()</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="task-1.2-compare-the-shape-of-daily-rhythm-between-week-1-and-week-2" class="level3">
<h3 class="anchored" data-anchor-id="task-1.2-compare-the-shape-of-daily-rhythm-between-week-1-and-week-2">Task 1.2 Compare the shape of daily rhythm between week 1 and week 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>msgs <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">if_else</span>(date <span class="sc">&lt;=</span> <span class="fu">min</span>(date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">6</span>), <span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Count and normalize within each week</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>week_patterns <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(week, hour) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>hour_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(week_patterns<span class="sc">$</span>hour), <span class="fu">max</span>(week_patterns<span class="sc">$</span>hour), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>prop_breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ceiling</span>(<span class="fu">max</span>(week_patterns<span class="sc">$</span>proportion) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fl">0.02</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(week_patterns, <span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> proportion, <span class="at">color =</span> week)) <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> hour_breaks) <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> prop_breaks,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Hourly Communication Patterns: Week 1 vs Week 2"</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Hour of Day"</span>,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Percent of Total Messages"</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey80"</span>),</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>),</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x     =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="background-color: white;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>The visualization of hourly communication patterns reveals that message activity in Oceanus follows a pronounced daily cycle, with distinct peaks and lows across both observed weeks.</p>
<p>In Week 1, communication is highly concentrated in the morning hours, particularly between 8 AM and 12 PM, where a majority of the messages are exchanged.</p>
<p>By contrast, Week 2 shows a broader distribution of communication throughout the day, with notable increases in afternoon and evening activity.</p>
<p>This shift suggests that while the first week’s communications were more focused and possibly related to regular planning or operational updates, the second week’s patterns reflect heightened activity or more dynamic coordination, potentially due to emergent events or increased urgency among entities.</p>
</div>
</div>
</section>
<section id="task-1.3-focus-on-a-specific-entity-and-use-this-information-to-determine-who-has-influence-over-them." class="level3">
<h3 class="anchored" data-anchor-id="task-1.3-focus-on-a-specific-entity-and-use-this-information-to-determine-who-has-influence-over-them.">Task 1.3: Focus on a specific entity and use this information to determine who has influence over them.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>entity_info <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, <span class="at">target_subtype =</span> sub_type)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>msgs2 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(entity_info, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>top_inf <span class="ot">&lt;-</span> msgs2 <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(receiver)) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(target_subtype, receiver, sender, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target_subtype, receiver) <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> top_inf <span class="sc">%&gt;%</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>(target_subtype) <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>{</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    subtype <span class="ot">&lt;-</span> <span class="fu">unique</span>(.x<span class="sc">$</span>target_subtype)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(.x, <span class="fu">aes</span>(</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">x     =</span> <span class="fu">reorder</span>(sender, n, <span class="at">.desc=</span><span class="cn">TRUE</span>),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">y     =</span> n,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill  =</span> receiver,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">text  =</span> <span class="fu">paste0</span>(</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Subtype: "</span>, subtype, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Sender: "</span>, sender, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Receiver: "</span>, receiver, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Count: "</span>, n</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span>                    </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, <span class="at">name=</span><span class="st">"Receiver"</span>) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Subtype:"</span>, subtype),</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">x     =</span> <span class="st">"Influencer (Sender)"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">y     =</span> <span class="st">"Message Count"</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey80"</span>),</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>),</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position  =</span> <span class="st">"bottom"</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">map</span>(plot_list, <span class="sc">~</span><span class="fu">ggplotly</span>(.x, <span class="at">tooltip =</span> <span class="st">"text"</span>))</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="fu">tagList</span>(plots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-de609bf56db3f965a1ad" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-de609bf56db3f965a1ad">{"x":{"data":[{"orientation":"h","width":0.89999999999999991,"base":0,"x":[1],"y":[1],"text":"Subtype: Group<br>Sender: Neptune<br>Receiver: City Officials<br>Count: 1","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(48,18,59,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"City Officials","legendgroup":"City Officials","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":43.835616438356169,"l":65.089248650892486},"font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"title":{"text":"Subtype: Group","font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.050000000000000003,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,1.6000000000000001],"tickmode":"array","ticktext":["Neptune"],"tickvals":[1],"categoryorder":"array","categoryarray":["Neptune"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"Influencer (Sender)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"title":{"text":"Receiver","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"cbb46619205d":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"cbb46619205d","visdat":{"cbb46619205d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="plotly html-widget html-fill-item" id="htmlwidget-5c4215669ddfebef4f4f" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-5c4215669ddfebef4f4f">{"x":{"data":[{"orientation":"h","width":[0.90000000000000036,0.90000000000000036],"base":[0,0],"x":[1,1],"y":[3,4],"text":["Subtype: Location<br>Sender: Knowles<br>Receiver: Haacklee Harbor<br>Count: 1","Subtype: Location<br>Sender: Nadia Conti<br>Receiver: Haacklee Harbor<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(48,18,59,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Haacklee Harbor","legendgroup":"Haacklee Harbor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999991,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.90000000000000036],"base":[6,2,0,0,0,0,0,3,0],"x":[5,4,2,2,1,1,1,1,1],"y":[15,14,11,13,1,5,6,12,7],"text":["Subtype: Location<br>Sender: Oceanus City Council<br>Receiver: Himark Harbor<br>Count: 5","Subtype: Location<br>Sender: Mako<br>Receiver: Himark Harbor<br>Count: 4","Subtype: Location<br>Sender: Marlin<br>Receiver: Himark Harbor<br>Count: 2","Subtype: Location<br>Sender: Serenity<br>Receiver: Himark Harbor<br>Count: 2","Subtype: Location<br>Sender: Davis<br>Receiver: Himark Harbor<br>Count: 1","Subtype: Location<br>Sender: Neptune<br>Receiver: Himark Harbor<br>Count: 1","Subtype: Location<br>Sender: Northern Light<br>Receiver: Himark Harbor<br>Count: 1","Subtype: Location<br>Sender: Remora<br>Receiver: Himark Harbor<br>Count: 1","Subtype: Location<br>Sender: Seawatch<br>Receiver: Himark Harbor<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(26,228,182,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Himark Harbor","legendgroup":"Himark Harbor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.89999999999999947,0.89999999999999858],"base":[0,0,0,1,0,0,0],"x":[6,3,2,2,1,1,1],"y":[15,12,14,10,2,8,9],"text":["Subtype: Location<br>Sender: Oceanus City Council<br>Receiver: Paackland Harbor<br>Count: 6","Subtype: Location<br>Sender: Remora<br>Receiver: Paackland Harbor<br>Count: 3","Subtype: Location<br>Sender: Mako<br>Receiver: Paackland Harbor<br>Count: 2","Subtype: Location<br>Sender: Reef Guardian<br>Receiver: Paackland Harbor<br>Count: 2","Subtype: Location<br>Sender: Green Guardians<br>Receiver: Paackland Harbor<br>Count: 1","Subtype: Location<br>Sender: Sentinel<br>Receiver: Paackland Harbor<br>Count: 1","Subtype: Location<br>Sender: The Middleman<br>Receiver: Paackland Harbor<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,186,57,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Paackland Harbor","legendgroup":"Paackland Harbor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.89999999999999858,"base":0,"x":[1],"y":[10],"text":"Subtype: Location<br>Sender: Reef Guardian<br>Receiver: Port Security<br>Count: 1","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(122,4,3,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Port Security","legendgroup":"Port Security","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":43.835616438356169,"l":134.16355334163552},"font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"title":{"text":"Subtype: Location","font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.55000000000000004,11.550000000000001],"tickmode":"array","ticktext":["0","3","6","9"],"tickvals":[0,3,6.0000000000000009,9],"categoryorder":"array","categoryarray":["0","3","6","9"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,15.6],"tickmode":"array","ticktext":["Davis","Green Guardians","Knowles","Nadia Conti","Neptune","Northern Light","Seawatch","Sentinel","The Middleman","Reef Guardian","Marlin","Remora","Serenity","Mako","Oceanus City Council"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"categoryorder":"array","categoryarray":["Davis","Green Guardians","Knowles","Nadia Conti","Neptune","Northern Light","Seawatch","Sentinel","The Middleman","Reef Guardian","Marlin","Remora","Serenity","Mako","Oceanus City Council"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"Influencer (Sender)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"title":{"text":"Receiver","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"cbb480c55d7":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"cbb480c55d7","visdat":{"cbb480c55d7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="plotly html-widget html-fill-item" id="htmlwidget-8c893d9d484d9fc20add" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-8c893d9d484d9fc20add">{"x":{"data":[{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.89999999999999858],"base":[12,1,0,1,2,2,0],"x":[12,6,3,2,2,1,1],"y":[25,20,19,11,16,8,10],"text":["Subtype: Organization<br>Sender: Green Guardians<br>Receiver: Green Guardians<br>Count: 12","Subtype: Organization<br>Sender: Oceanus City Council<br>Receiver: Green Guardians<br>Count: 6","Subtype: Organization<br>Sender: The Lookout<br>Receiver: Green Guardians<br>Count: 3","Subtype: Organization<br>Sender: Horizon<br>Receiver: Green Guardians<br>Count: 2","Subtype: Organization<br>Sender: Sentinel<br>Receiver: Green Guardians<br>Count: 2","Subtype: Organization<br>Sender: Northern Light<br>Receiver: Green Guardians<br>Count: 1","Subtype: Organization<br>Sender: Seawatch<br>Receiver: Green Guardians<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(48,18,59,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Green Guardians","legendgroup":"Green Guardians","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858],"base":[0,0,0,0,3,0,0,0,0,0,2,0,1,1,0],"x":[12,7,6,4,3,2,2,2,1,1,1,1,1,1,1],"y":[25,23,22,21,18,14,15,16,2,11,4,5,7,8,20],"text":["Subtype: Organization<br>Sender: Green Guardians<br>Receiver: Oceanus City Council<br>Count: 12","Subtype: Organization<br>Sender: Himark Harbor<br>Receiver: Oceanus City Council<br>Count: 7","Subtype: Organization<br>Sender: Liam Thorne<br>Receiver: Oceanus City Council<br>Count: 6","Subtype: Organization<br>Sender: Reef Guardian<br>Receiver: Oceanus City Council<br>Count: 4","Subtype: Organization<br>Sender: Samantha Blake<br>Receiver: Oceanus City Council<br>Count: 3","Subtype: Organization<br>Sender: Haacklee Harbor<br>Receiver: Oceanus City Council<br>Count: 2","Subtype: Organization<br>Sender: Paackland Harbor<br>Receiver: Oceanus City Council<br>Count: 2","Subtype: Organization<br>Sender: Sentinel<br>Receiver: Oceanus City Council<br>Count: 2","Subtype: Organization<br>Sender: EcoVigil<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Horizon<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Mako<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Marlin<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Nadia Conti<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Northern Light<br>Receiver: Oceanus City Council<br>Count: 1","Subtype: Organization<br>Sender: Oceanus City Council<br>Receiver: Oceanus City Council<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(26,228,182,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Oceanus City Council","legendgroup":"Oceanus City Council","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999947,0.89999999999999858],"base":[0,1,1,0,0],"x":[3,2,1,1,1],"y":[18,12,4,8,9],"text":["Subtype: Organization<br>Sender: Samantha Blake<br>Receiver: Sailor Shifts Team<br>Count: 3","Subtype: Organization<br>Sender: Remora<br>Receiver: Sailor Shifts Team<br>Count: 2","Subtype: Organization<br>Sender: Mako<br>Receiver: Sailor Shifts Team<br>Count: 1","Subtype: Organization<br>Sender: Northern Light<br>Receiver: Sailor Shifts Team<br>Count: 1","Subtype: Organization<br>Sender: Rodriguez<br>Receiver: Sailor Shifts Team<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,186,57,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Sailor Shifts Team","legendgroup":"Sailor Shifts Team","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0],"x":[8,2,2,1,1,1,1,1,1],"y":[24,13,17,1,3,4,6,7,12],"text":["Subtype: Organization<br>Sender: Neptune<br>Receiver: V. Miesel Shipping<br>Count: 8","Subtype: Organization<br>Sender: Davis<br>Receiver: V. Miesel Shipping<br>Count: 2","Subtype: Organization<br>Sender: V. Miesel Shipping<br>Receiver: V. Miesel Shipping<br>Count: 2","Subtype: Organization<br>Sender: Boss<br>Receiver: V. Miesel Shipping<br>Count: 1","Subtype: Organization<br>Sender: Elise<br>Receiver: V. Miesel Shipping<br>Count: 1","Subtype: Organization<br>Sender: Mako<br>Receiver: V. Miesel Shipping<br>Count: 1","Subtype: Organization<br>Sender: Mrs. Money<br>Receiver: V. Miesel Shipping<br>Count: 1","Subtype: Organization<br>Sender: Nadia Conti<br>Receiver: V. Miesel Shipping<br>Count: 1","Subtype: Organization<br>Sender: Remora<br>Receiver: V. Miesel Shipping<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(122,4,3,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"V. Miesel Shipping","legendgroup":"V. Miesel Shipping","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":43.835616438356169,"l":134.16355334163552},"font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"title":{"text":"Subtype: Organization","font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.2000000000000002,25.199999999999999],"tickmode":"array","ticktext":["0","5","10","15","20","25"],"tickvals":[0,5,10,15,20,25],"categoryorder":"array","categoryarray":["0","5","10","15","20","25"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,25.600000000000001],"tickmode":"array","ticktext":["Boss","EcoVigil","Elise","Mako","Marlin","Mrs. Money","Nadia Conti","Northern Light","Rodriguez","Seawatch","Horizon","Remora","Davis","Haacklee Harbor","Paackland Harbor","Sentinel","V. Miesel Shipping","Samantha Blake","The Lookout","Oceanus City Council","Reef Guardian","Liam Thorne","Himark Harbor","Neptune","Green Guardians"],"tickvals":[1,2,3,4,5,6,7,7.9999999999999991,9,10,11,12,13,14.000000000000002,15,16,17,18,19,20,21,22,23,24,25],"categoryorder":"array","categoryarray":["Boss","EcoVigil","Elise","Mako","Marlin","Mrs. Money","Nadia Conti","Northern Light","Rodriguez","Seawatch","Horizon","Remora","Davis","Haacklee Harbor","Paackland Harbor","Sentinel","V. Miesel Shipping","Samantha Blake","The Lookout","Oceanus City Council","Reef Guardian","Liam Thorne","Himark Harbor","Neptune","Green Guardians"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"Influencer (Sender)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"title":{"text":"Receiver","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"cbb44d102bcf":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"cbb44d102bcf","visdat":{"cbb44d102bcf":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="plotly html-widget html-fill-item" id="htmlwidget-41f1bf2856eb4fdc405c" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-41f1bf2856eb4fdc405c">{"x":{"data":[{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999991,0.89999999999999858,0.89999999999999947],"base":[8,8,9,6,1,11,1,3,5],"x":[6,4,3,2,2,1,1,1,1],"y":[24,20,19,15,10,23,1,9,8],"text":["Subtype: Person<br>Sender: Mrs. Money<br>Receiver: Boss<br>Count: 6","Subtype: Person<br>Sender: The Middleman<br>Receiver: Boss<br>Count: 4","Subtype: Person<br>Sender: Rodriguez<br>Receiver: Boss<br>Count: 3","Subtype: Person<br>Sender: Mako<br>Receiver: Boss<br>Count: 2","Subtype: Person<br>Sender: The Accountant<br>Receiver: Boss<br>Count: 2","Subtype: Person<br>Sender: Davis<br>Receiver: Boss<br>Count: 1","Subtype: Person<br>Sender: Glitters Team<br>Receiver: Boss<br>Count: 1","Subtype: Person<br>Sender: Liam Thorne<br>Receiver: Boss<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Boss<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(48,18,59,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Boss","legendgroup":"Boss","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.89999999999999858,"base":0,"x":[18],"y":[27],"text":"Subtype: Person<br>Sender: Miranda Jordan<br>Receiver: Clepper Jensen<br>Count: 18","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(65,67,167,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Clepper Jensen","legendgroup":"Clepper Jensen","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999947],"base":[5,6,0,4,0,5,2,4],"x":[6,3,2,2,2,1,1,1],"y":[23,19,14,17,18,15,4,8],"text":["Subtype: Person<br>Sender: Davis<br>Receiver: Davis<br>Count: 6","Subtype: Person<br>Sender: Rodriguez<br>Receiver: Davis<br>Count: 3","Subtype: Person<br>Sender: Knowles<br>Receiver: Davis<br>Count: 2","Subtype: Person<br>Sender: Neptune<br>Receiver: Davis<br>Count: 2","Subtype: Person<br>Sender: Small Fry<br>Receiver: Davis<br>Count: 2","Subtype: Person<br>Sender: Mako<br>Receiver: Davis<br>Count: 1","Subtype: Person<br>Sender: Remora<br>Receiver: Davis<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Davis<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(71,113,233,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Davis","legendgroup":"Davis","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947],"base":[1,2,4,3],"x":[3,1,1,1],"y":[17,9,15,8],"text":["Subtype: Person<br>Sender: Neptune<br>Receiver: Elise<br>Count: 3","Subtype: Person<br>Sender: Liam Thorne<br>Receiver: Elise<br>Count: 1","Subtype: Person<br>Sender: Mako<br>Receiver: Elise<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Elise<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(62,155,254,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Elise","legendgroup":"Elise","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.90000000000000036,"base":0,"x":[1],"y":[6],"text":"Subtype: Person<br>Sender: Sam<br>Receiver: Kelly<br>Count: 1","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(34,197,226,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Kelly","legendgroup":"Kelly","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036],"base":[3,0,0,6,3,0],"x":[8,2,2,2,1,1],"y":[22,11,16,20,12,3],"text":["Subtype: Person<br>Sender: Oceanus City Council<br>Receiver: Liam Thorne<br>Count: 8","Subtype: Person<br>Sender: EcoVigil<br>Receiver: Liam Thorne<br>Count: 2","Subtype: Person<br>Sender: Nadia Conti<br>Receiver: Liam Thorne<br>Count: 2","Subtype: Person<br>Sender: The Middleman<br>Receiver: Liam Thorne<br>Count: 2","Subtype: Person<br>Sender: Elise<br>Receiver: Liam Thorne<br>Count: 1","Subtype: Person<br>Sender: Paackland Harbor<br>Receiver: Liam Thorne<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(26,228,182,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Liam Thorne","legendgroup":"Liam Thorne","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.89999999999999858,"base":0,"x":[20],"y":[28],"text":"Subtype: Person<br>Sender: Clepper Jensen<br>Receiver: Miranda Jordan<br>Count: 20","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(70,248,132,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Miranda Jordan","legendgroup":"Miranda Jordan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947],"base":[9,3,3,5,2],"x":[15,4,3,1,1],"y":[25,21,20,19,8],"text":["Subtype: Person<br>Sender: The Intern<br>Receiver: Mrs. Money<br>Count: 15","Subtype: Person<br>Sender: Boss<br>Receiver: Mrs. Money<br>Count: 4","Subtype: Person<br>Sender: The Middleman<br>Receiver: Mrs. Money<br>Count: 3","Subtype: Person<br>Sender: Rodriguez<br>Receiver: Mrs. Money<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Mrs. Money<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(136,255,78,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Mrs. Money","legendgroup":"Mrs. Money","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.90000000000000036,0.89999999999999947],"base":[0,0,0,0,0,2,1,4,0,0,1],"x":[5,3,2,1,1,1,1,1,1,1,1],"y":[23,12,9,2,17,22,4,19,5,7,8],"text":["Subtype: Person<br>Sender: Davis<br>Receiver: Nadia Conti<br>Count: 5","Subtype: Person<br>Sender: Elise<br>Receiver: Nadia Conti<br>Count: 3","Subtype: Person<br>Sender: Liam Thorne<br>Receiver: Nadia Conti<br>Count: 2","Subtype: Person<br>Sender: Haacklee Harbor<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Neptune<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Oceanus City Council<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Remora<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Rodriguez<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Sailor Shifts Team<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: Sentinel<br>Receiver: Nadia Conti<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Nadia Conti<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(185,246,53,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Nadia Conti","legendgroup":"Nadia Conti","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.90000000000000036,0.89999999999999947],"base":[0,0,0],"x":[4,1,1],"y":[19,4,8],"text":["Subtype: Person<br>Sender: Rodriguez<br>Receiver: Rodriguez<br>Count: 4","Subtype: Person<br>Sender: Remora<br>Receiver: Rodriguez<br>Count: 1","Subtype: Person<br>Sender: V. Miesel Shipping<br>Receiver: Rodriguez<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(225,221,55,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Rodriguez","legendgroup":"Rodriguez","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858],"base":[12,0],"x":[8,2],"y":[26,13],"text":["Subtype: Person<br>Sender: The Lookout<br>Receiver: Sam<br>Count: 8","Subtype: Person<br>Sender: Kelly<br>Receiver: Sam<br>Count: 2"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,186,57,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Sam","legendgroup":"Sam","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999991],"base":[0,0,0],"x":[4,2,1],"y":[15,22,1],"text":["Subtype: Person<br>Sender: Mako<br>Receiver: Samantha Blake<br>Count: 4","Subtype: Person<br>Sender: Oceanus City Council<br>Receiver: Samantha Blake<br>Count: 2","Subtype: Person<br>Sender: Glitters Team<br>Receiver: Samantha Blake<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(253,141,39,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Samantha Blake","legendgroup":"Samantha Blake","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.89999999999999858,"base":0,"x":[3],"y":[20],"text":"Subtype: Person<br>Sender: The Middleman<br>Receiver: The Accountant<br>Count: 3","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(240,91,18,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"The Accountant","legendgroup":"The Accountant","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,3,8],"x":[12,5,1],"y":[26,24,25],"text":["Subtype: Person<br>Sender: The Lookout<br>Receiver: The Intern<br>Count: 12","Subtype: Person<br>Sender: Mrs. Money<br>Receiver: The Intern<br>Count: 5","Subtype: Person<br>Sender: The Intern<br>Receiver: The Intern<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,53,6,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"The Intern","legendgroup":"The Intern","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.89999999999999858,"base":0,"x":[8],"y":[25],"text":"Subtype: Person<br>Sender: The Intern<br>Receiver: The Lookout<br>Count: 8","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(175,24,1,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"The Lookout","legendgroup":"The Lookout","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0],"x":[3,3,1],"y":[21,24,10],"text":["Subtype: Person<br>Sender: Boss<br>Receiver: The Middleman<br>Count: 3","Subtype: Person<br>Sender: Mrs. Money<br>Receiver: The Middleman<br>Count: 3","Subtype: Person<br>Sender: The Accountant<br>Receiver: The Middleman<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(122,4,3,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"The Middleman","legendgroup":"The Middleman","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":43.835616438356169,"l":134.16355334163552},"font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"title":{"text":"Subtype: Person","font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.2000000000000002,25.199999999999999],"tickmode":"array","ticktext":["0","5","10","15","20","25"],"tickvals":[0,5,10,15,20,25],"categoryorder":"array","categoryarray":["0","5","10","15","20","25"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,28.600000000000001],"tickmode":"array","ticktext":["Glitters Team","Haacklee Harbor","Paackland Harbor","Remora","Sailor Shifts Team","Sam","Sentinel","V. Miesel Shipping","Liam Thorne","The Accountant","EcoVigil","Elise","Kelly","Knowles","Mako","Nadia Conti","Neptune","Small Fry","Rodriguez","The Middleman","Boss","Oceanus City Council","Davis","Mrs. Money","The Intern","The Lookout","Miranda Jordan","Clepper Jensen"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15.000000000000002,16,17,18,19,20,21,22,23,24,25,26,27,28],"categoryorder":"array","categoryarray":["Glitters Team","Haacklee Harbor","Paackland Harbor","Remora","Sailor Shifts Team","Sam","Sentinel","V. Miesel Shipping","Liam Thorne","The Accountant","EcoVigil","Elise","Kelly","Knowles","Mako","Nadia Conti","Neptune","Small Fry","Rodriguez","The Middleman","Boss","Oceanus City Council","Davis","Mrs. Money","The Intern","The Lookout","Miranda Jordan","Clepper Jensen"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"Influencer (Sender)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"title":{"text":"Receiver","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"cbb47f7b8c4":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"cbb47f7b8c4","visdat":{"cbb47f7b8c4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e9a9580b05c54dd66cf2" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-e9a9580b05c54dd66cf2">{"x":{"data":[{"orientation":"h","width":0.89999999999999858,"base":25,"x":[2],"y":[15],"text":"Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Defender<br>Count: 2","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(48,18,59,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Defender","legendgroup":"Defender","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[21,16,7,9,2,0,7],"x":[4,3,3,2,1,1,1],"y":[15,16,13,17,2,3,7],"text":["Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: EcoVigil<br>Count: 4","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: EcoVigil<br>Count: 3","Subtype: Vessel<br>Sender: Horizon<br>Receiver: EcoVigil<br>Count: 3","Subtype: Vessel<br>Sender: EcoVigil<br>Receiver: EcoVigil<br>Count: 2","Subtype: Vessel<br>Sender: Haacklee Harbor<br>Receiver: EcoVigil<br>Count: 1","Subtype: Vessel<br>Sender: Liam Thorne<br>Receiver: EcoVigil<br>Count: 1","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: EcoVigil<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(66,74,179,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"EcoVigil","legendgroup":"EcoVigil","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[4,7,5,12,18],"x":[5,5,5,4,3],"y":[17,20,24,16,15],"text":["Subtype: Vessel<br>Sender: EcoVigil<br>Receiver: Horizon<br>Count: 5","Subtype: Vessel<br>Sender: Sentinel<br>Receiver: Horizon<br>Count: 5","Subtype: Vessel<br>Sender: The Lookout<br>Receiver: Horizon<br>Count: 5","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Horizon<br>Count: 4","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Horizon<br>Count: 3"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(70,126,244,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Horizon","legendgroup":"Horizon","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.90000000000000013,"base":1,"x":[1],"y":[2],"text":"Subtype: Vessel<br>Sender: Haacklee Harbor<br>Receiver: Knowles<br>Count: 1","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(49,175,245,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Knowles","legendgroup":"Knowles","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858],"base":[6,11,0,5,2,17,10,0,10,5,16,4],"x":[9,7,6,5,5,3,3,3,2,2,2,2],"y":[28,26,27,23,20,18,22,19,16,7,15,12],"text":["Subtype: Vessel<br>Sender: Remora<br>Receiver: Mako<br>Count: 9","Subtype: Vessel<br>Sender: Neptune<br>Receiver: Mako<br>Count: 7","Subtype: Vessel<br>Sender: Osprey<br>Receiver: Mako<br>Count: 6","Subtype: Vessel<br>Sender: Davis<br>Receiver: Mako<br>Count: 5","Subtype: Vessel<br>Sender: Sentinel<br>Receiver: Mako<br>Count: 5","Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Mako<br>Count: 3","Subtype: Vessel<br>Sender: Paackland Harbor<br>Receiver: Mako<br>Count: 3","Subtype: Vessel<br>Sender: Samantha Blake<br>Receiver: Mako<br>Count: 3","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Mako<br>Count: 2","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: Mako<br>Count: 2","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Mako<br>Count: 2","Subtype: Vessel<br>Sender: Serenity<br>Receiver: Mako<br>Count: 2"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(24,218,199,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Mako","legendgroup":"Mako","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036],"base":[13,15,17,2,4],"x":[3,2,1,1,1],"y":[15,18,14,10,7],"text":["Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Marlin<br>Count: 3","Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Marlin<br>Count: 2","Subtype: Vessel<br>Sender: Mako<br>Receiver: Marlin<br>Count: 1","Subtype: Vessel<br>Sender: Nadia Conti<br>Receiver: Marlin<br>Count: 1","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: Marlin<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(56,244,145,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Marlin","legendgroup":"Marlin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,10,2,14,1,0,2,4,12],"x":[6,5,4,3,2,2,2,1,1],"y":[28,18,21,14,9,10,12,23,15],"text":["Subtype: Vessel<br>Sender: Remora<br>Receiver: Neptune<br>Count: 6","Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Neptune<br>Count: 5","Subtype: Vessel<br>Sender: V. Miesel Shipping<br>Receiver: Neptune<br>Count: 4","Subtype: Vessel<br>Sender: Mako<br>Receiver: Neptune<br>Count: 3","Subtype: Vessel<br>Sender: Mrs. Money<br>Receiver: Neptune<br>Count: 2","Subtype: Vessel<br>Sender: Nadia Conti<br>Receiver: Neptune<br>Count: 2","Subtype: Vessel<br>Sender: Serenity<br>Receiver: Neptune<br>Count: 2","Subtype: Vessel<br>Sender: Davis<br>Receiver: Neptune<br>Count: 1","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Neptune<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(131,255,82,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Neptune","legendgroup":"Neptune","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999991,0.89999999999999858,0.89999999999999858,0.90000000000000036],"base":[1,9,9,3],"x":[1,1,1,1],"y":[1,16,18,7],"text":["Subtype: Vessel<br>Sender: Glitters Team<br>Receiver: Northern Light<br>Count: 1","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Northern Light<br>Count: 1","Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Northern Light<br>Count: 1","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: Northern Light<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,245,52,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Northern Light","legendgroup":"Northern Light","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.90000000000000013],"base":[12,0],"x":[2,1],"y":[14,2],"text":["Subtype: Vessel<br>Sender: Mako<br>Receiver: Osprey<br>Count: 2","Subtype: Vessel<br>Sender: Haacklee Harbor<br>Receiver: Osprey<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(233,213,57,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Osprey","legendgroup":"Osprey","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858],"base":[3,1,9,2,10,1,8,0,6,2,10,0,1,4],"x":[6,3,3,2,2,2,2,2,1,1,1,1,1,1],"y":[16,11,15,17,14,7,22,12,13,8,26,6,20,24],"text":["Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Reef Guardian<br>Count: 6","Subtype: Vessel<br>Sender: Defender<br>Receiver: Reef Guardian<br>Count: 3","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Reef Guardian<br>Count: 3","Subtype: Vessel<br>Sender: EcoVigil<br>Receiver: Reef Guardian<br>Count: 2","Subtype: Vessel<br>Sender: Mako<br>Receiver: Reef Guardian<br>Count: 2","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: Reef Guardian<br>Count: 2","Subtype: Vessel<br>Sender: Paackland Harbor<br>Receiver: Reef Guardian<br>Count: 2","Subtype: Vessel<br>Sender: Serenity<br>Receiver: Reef Guardian<br>Count: 2","Subtype: Vessel<br>Sender: Horizon<br>Receiver: Reef Guardian<br>Count: 1","Subtype: Vessel<br>Sender: Marlin<br>Receiver: Reef Guardian<br>Count: 1","Subtype: Vessel<br>Sender: Neptune<br>Receiver: Reef Guardian<br>Count: 1","Subtype: Vessel<br>Sender: Seawatch<br>Receiver: Reef Guardian<br>Count: 1","Subtype: Vessel<br>Sender: Sentinel<br>Receiver: Reef Guardian<br>Count: 1","Subtype: Vessel<br>Sender: The Lookout<br>Receiver: Reef Guardian<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(254,170,51,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Reef Guardian","legendgroup":"Reef Guardian","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.89999999999999858,0.89999999999999991,0.89999999999999858,0.90000000000000036,0.90000000000000036],"base":[1,5,0,4,0,6,0,0,0,0,0,0],"x":[9,5,4,4,4,3,2,2,1,1,1,1],"y":[26,14,23,22,25,18,8,21,1,9,4,5],"text":["Subtype: Vessel<br>Sender: Neptune<br>Receiver: Remora<br>Count: 9","Subtype: Vessel<br>Sender: Mako<br>Receiver: Remora<br>Count: 5","Subtype: Vessel<br>Sender: Davis<br>Receiver: Remora<br>Count: 4","Subtype: Vessel<br>Sender: Paackland Harbor<br>Receiver: Remora<br>Count: 4","Subtype: Vessel<br>Sender: Small Fry<br>Receiver: Remora<br>Count: 4","Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Remora<br>Count: 3","Subtype: Vessel<br>Sender: Marlin<br>Receiver: Remora<br>Count: 2","Subtype: Vessel<br>Sender: V. Miesel Shipping<br>Receiver: Remora<br>Count: 2","Subtype: Vessel<br>Sender: Glitters Team<br>Receiver: Remora<br>Count: 1","Subtype: Vessel<br>Sender: Mrs. Money<br>Receiver: Remora<br>Count: 1","Subtype: Vessel<br>Sender: Rodriguez<br>Receiver: Remora<br>Count: 1","Subtype: Vessel<br>Sender: Sailor Shifts Team<br>Receiver: Remora<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,114,28,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Remora","legendgroup":"Remora","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[3,6,1,4,0,0],"x":[3,3,2,2,1,1],"y":[18,15,16,13,11,20],"text":["Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Seawatch<br>Count: 3","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Seawatch<br>Count: 3","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Seawatch<br>Count: 2","Subtype: Vessel<br>Sender: Horizon<br>Receiver: Seawatch<br>Count: 2","Subtype: Vessel<br>Sender: Defender<br>Receiver: Seawatch<br>Count: 1","Subtype: Vessel<br>Sender: Sentinel<br>Receiver: Seawatch<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(224,63,8,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Seawatch","legendgroup":"Seawatch","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036],"base":[0,1,0,0,3,0,0,0],"x":[4,4,4,4,3,2,1,1],"y":[13,14,22,24,15,17,16,7],"text":["Subtype: Vessel<br>Sender: Horizon<br>Receiver: Sentinel<br>Count: 4","Subtype: Vessel<br>Sender: Mako<br>Receiver: Sentinel<br>Count: 4","Subtype: Vessel<br>Sender: Paackland Harbor<br>Receiver: Sentinel<br>Count: 4","Subtype: Vessel<br>Sender: The Lookout<br>Receiver: Sentinel<br>Count: 4","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Sentinel<br>Count: 3","Subtype: Vessel<br>Sender: EcoVigil<br>Receiver: Sentinel<br>Count: 2","Subtype: Vessel<br>Sender: Green Guardians<br>Receiver: Sentinel<br>Count: 1","Subtype: Vessel<br>Sender: Oceanus City Council<br>Receiver: Sentinel<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(182,28,2,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Sentinel","legendgroup":"Sentinel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0],"x":[3,3,1,1],"y":[18,15,14,26],"text":["Subtype: Vessel<br>Sender: Himark Harbor<br>Receiver: Serenity<br>Count: 3","Subtype: Vessel<br>Sender: Reef Guardian<br>Receiver: Serenity<br>Count: 3","Subtype: Vessel<br>Sender: Mako<br>Receiver: Serenity<br>Count: 1","Subtype: Vessel<br>Sender: Neptune<br>Receiver: Serenity<br>Count: 1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(122,4,3,1)","line":{"width":1.8897637795275593,"color":"rgba(255,255,255,1)"}},"name":"Serenity","legendgroup":"Serenity","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":43.835616438356169,"l":134.16355334163552},"font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"title":{"text":"Subtype: Vessel","font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.3500000000000001,28.350000000000001],"tickmode":"array","ticktext":["0","10","20"],"tickvals":[0,10,20],"categoryorder":"array","categoryarray":["0","10","20"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,28.600000000000001],"tickmode":"array","ticktext":["Glitters Team","Haacklee Harbor","Liam Thorne","Rodriguez","Sailor Shifts Team","Seawatch","Oceanus City Council","Marlin","Mrs. Money","Nadia Conti","Defender","Serenity","Horizon","Mako","Reef Guardian","Green Guardians","EcoVigil","Himark Harbor","Samantha Blake","Sentinel","V. Miesel Shipping","Paackland Harbor","Davis","The Lookout","Small Fry","Neptune","Osprey","Remora"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15.000000000000002,16,17,18,19,20,21,22,23,24,25,26,27,28],"categoryorder":"array","categoryarray":["Glitters Team","Haacklee Harbor","Liam Thorne","Rodriguez","Sailor Shifts Team","Seawatch","Oceanus City Council","Marlin","Mrs. Money","Nadia Conti","Defender","Serenity","Horizon","Mako","Reef Guardian","Green Guardians","EcoVigil","Himark Harbor","Samantha Blake","Sentinel","V. Miesel Shipping","Paackland Harbor","Davis","The Lookout","Small Fry","Neptune","Osprey","Remora"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"Influencer (Sender)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"title":{"text":"Receiver","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"cbb445c443eb":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"cbb445c443eb","visdat":{"cbb445c443eb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Subtype:Group</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Subtype: Location</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Subtype:Organization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Subtype:Person</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Vessel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ee_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>entity_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> entity_nodes, <span class="at">edges =</span> ee_edges, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="st">"Neptune"</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>g_ig <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(entity_graph, <span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>root_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>ego_vs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  root_idx,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, <span class="at">vids =</span> ego_vs)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(subg)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(ego_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="cn">NULL</span>),</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)),</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">==</span> target)),</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">6</span>,</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">!=</span> target)),</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">4</span>,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Influence Network of"</span>, target)) <span class="sc">+</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ee_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>entity_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> entity_nodes, <span class="at">edges =</span> ee_edges, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="st">"Oceanus City Council"</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>g_ig <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(entity_graph, <span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>root_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>ego_vs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  root_idx,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, <span class="at">vids =</span> ego_vs)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(subg)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(ego_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="cn">NULL</span>),</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)),</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">==</span> target)),</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">6</span>,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">!=</span> target)),</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">4</span>,</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Influence Network of"</span>, target)) <span class="sc">+</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ee_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>entity_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> entity_nodes, <span class="at">edges =</span> ee_edges, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="st">"Green Guardians"</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>g_ig <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(entity_graph, <span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>root_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>ego_vs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  root_idx,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, <span class="at">vids =</span> ego_vs)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(subg)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(ego_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="cn">NULL</span>),</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)),</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">==</span> target)),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">6</span>,</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">!=</span> target)),</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">4</span>,</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Influence Network of"</span>, target)) <span class="sc">+</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ee_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>entity_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> entity_nodes, <span class="at">edges =</span> ee_edges, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="st">"The Intern"</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>g_ig <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(entity_graph, <span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>root_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>ego_vs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  root_idx,</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, <span class="at">vids =</span> ego_vs)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(subg)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(ego_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="cn">NULL</span>),</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)),</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">==</span> target)),</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">6</span>,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">!=</span> target)),</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">4</span>,</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Influence Network of"</span>, target)) <span class="sc">+</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ee_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>entity_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> entity_nodes, <span class="at">edges =</span> ee_edges, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="st">"Reef Guardian"</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>g_ig <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(entity_graph, <span class="at">strict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>root_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>ego_vs <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  root_idx,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g_ig, root_idx, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, <span class="at">vids =</span> ego_vs)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">as_tbl_graph</span>(subg)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(ego_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="cn">NULL</span>),</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)),</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">==</span> target)),</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">6</span>,</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick"</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">filter =</span> (name <span class="sc">!=</span> target)),</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size  =</span> <span class="dv">4</span>,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Influence Network of"</span>, target)) <span class="sc">+</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="task-2-clepper-has-noticed-that-people-often-communicate-with-or-about-the-same-people-or-vessels-and-that-grouping-them-together-may-help-with-the-investigation." class="level2">
<h2 class="anchored" data-anchor-id="task-2-clepper-has-noticed-that-people-often-communicate-with-or-about-the-same-people-or-vessels-and-that-grouping-them-together-may-help-with-the-investigation.">Task 2: Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.</h2>
<section id="task-2.1-develop-visualizations-to-explore-connections-between-vessels-and-people" class="level3">
<h3 class="anchored" data-anchor-id="task-2.1-develop-visualizations-to-explore-connections-between-vessels-and-people">Task 2.1 :Develop visualizations to explore connections between vessels and people</h3>
<section id="step1clean-the-nodes-and-edges-data" class="level4">
<h4 class="anchored" data-anchor-id="step1clean-the-nodes-and-edges-data">Step1:Clean the nodes and edges data</h4>
<p>clean the raw nodes and edges data to ensure there are no missing values, all IDs are unique, and types are consistent.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected,<span class="fu">everything</span>())</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id, to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-2-extract-personvessel-indirect-links" class="level4">
<h4 class="anchored" data-anchor-id="step-2-extract-personvessel-indirect-links">Step 2: Extract person–vessel indirect links</h4>
<p>Identify “Person” and “Vessel” nodes, and link them through “Relationship” nodes to extract all person–relationship–vessel triples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>people_nodes <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>vessel_nodes <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>relationship_nodes <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, id))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>person_relationship_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> people_nodes<span class="sc">$</span>id <span class="sc">&amp;</span> to_id <span class="sc">%in%</span> relationship_nodes<span class="sc">$</span>id)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>relationship_vessel_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> relationship_nodes<span class="sc">$</span>id <span class="sc">&amp;</span> to_id <span class="sc">%in%</span> vessel_nodes<span class="sc">$</span>id)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>person_to_relationship <span class="ot">&lt;-</span> person_relationship_edges <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">person_id =</span> from_id, <span class="at">relationship_id =</span> to_id)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>relationship_to_vessel <span class="ot">&lt;-</span> relationship_vessel_edges <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">relationship_id =</span> from_id, <span class="at">vessel_id =</span> to_id)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>person_vessel_links <span class="ot">&lt;-</span> person_to_relationship <span class="sc">%&gt;%</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(relationship_to_vessel, <span class="at">by =</span> <span class="st">"relationship_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(person_id, vessel_id, relationship_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-3-add-labels-and-types-for-nodes-and-edges" class="level4">
<h4 class="anchored" data-anchor-id="step-3-add-labels-and-types-for-nodes-and-edges">Step 3: Add labels and types for nodes and edges</h4>
<p>Add labels to each person and vessel node, and add relationship type to edges for visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>person_vessel_links <span class="ot">&lt;-</span> person_vessel_links <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(people_nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">person_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"person_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(vessel_nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">vessel_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"vessel_id"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>person_vessel_links <span class="ot">&lt;-</span> person_vessel_links <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">relationship_type =</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(relationship_id, <span class="st">"(?&lt;=Relationship_)[^_]+"</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>edges_pv <span class="ot">&lt;-</span> person_vessel_links <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> person_label,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> vessel_label</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, relationship_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4-prepare-nodesedges-table-for-visualization" class="level4">
<h4 class="anchored" data-anchor-id="step-4-prepare-nodesedges-table-for-visualization">Step 4: Prepare nodes/edges table for visualization</h4>
<p>Combine all nodes (person + vessel) into a nodes dataframe with type and color, and add color to the edge dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">unique</span>(<span class="fu">c</span>(edges_pv<span class="sc">$</span>from, edges_pv<span class="sc">$</span>to)),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">unique</span>(<span class="fu">c</span>(edges_pv<span class="sc">$</span>from, edges_pv<span class="sc">$</span>to))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>      people_nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(label, <span class="at">type =</span> sub_type),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>      vessel_nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(label, <span class="at">type =</span> sub_type)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"label"</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="dv">16</span>, <span class="dv">17</span>),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"#FF8888"</span>, <span class="st">"#44C6C6"</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, type, shape, color)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>relation_types <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(edges_pv<span class="sc">$</span>relationship_type))</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(relation_types) <span class="sc">&lt;=</span> <span class="dv">8</span>) {</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  relation_colors <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">length</span>(relation_types), <span class="st">"Dark2"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  relation_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))(<span class="fu">length</span>(relation_types))</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>relation_color_map <span class="ot">&lt;-</span> <span class="fu">setNames</span>(relation_colors, relation_types)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> edges_pv <span class="sc">%&gt;%</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">relationship =</span> relationship_type,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> relation_color_map[relationship_type]</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, relationship, color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-5-plot-static-network-with-nodeedge-legends" class="level4">
<h4 class="anchored" data-anchor-id="step-5-plot-static-network-with-nodeedge-legends">Step 5: Plot static network with node/edge legends</h4>
<p>Use ggraph to plot a static network diagram. Node types (person/vessel) have different shapes and colors, and the legend on the right automatically distinguishes them. Edge colors represent relationship types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>graph_pv <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> nodes,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> edges <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">label =</span> relationship),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(graph_pv, <span class="at">layout =</span> <span class="st">'fr'</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> label),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">'mm'</span>)),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">1.4</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.85</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">TRUE</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">shape =</span> type, <span class="at">color =</span> type),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">TRUE</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.8</span>,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="cn">NA</span> </span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Node Type"</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#FF8888"</span>, <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#44C6C6"</span>),</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Node Type"</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> relation_color_map,</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Relationship"</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)),</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)),</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>))</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"People–Vessel Interaction Network"</span>) <span class="sc">+</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="task-2.2-identify-closely-associated-groups-and-the-predominant-topics-for-each-group" class="level3">
<h3 class="anchored" data-anchor-id="task-2.2-identify-closely-associated-groups-and-the-predominant-topics-for-each-group">Task 2.2 ：Identify closely associated groups and the predominant topics for each group</h3>
<section id="step-1-data-preparation" class="level4">
<h4 class="anchored" data-anchor-id="step-1-data-preparation">Step 1: Data preparation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert directed graph to undirected for community detection</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ig_undir <span class="ot">&lt;-</span> <span class="fu">as.undirected</span>(<span class="fu">as.igraph</span>(graph_pv), <span class="at">mode =</span> <span class="st">"collapse"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#run Louvain community detection</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>com <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(ig_undir)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>membership_vec <span class="ot">&lt;-</span> <span class="fu">membership</span>(com) </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assign community back to tbl_graph</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>graph_pv <span class="ot">&lt;-</span> graph_pv <span class="sc">%&gt;%</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(membership_vec[<span class="fu">seq_len</span>(<span class="fu">n</span>())]))</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">#extract node table with community info</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(graph_pv, <span class="st">"nodes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-2-community-membership-summary" class="level4">
<h4 class="anchored" data-anchor-id="step-2-community-membership-summary">Step 2: Community membership summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>group_summary <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(community, type) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">members =</span> <span class="fu">paste</span>(label, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(group_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 9%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">community</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">members</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Nadia Conti, Liam Thorne, The Middleman</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">EcoVigil, Sentinel</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Samantha Blake, Rodriguez, Clepper Jensen, Mrs.&nbsp;Money</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Mako, Neptune, Knowles</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Davis</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Marlin, Defender</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Boss, Small Fry</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Remora</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="step-3visualization-of-community-structure" class="level4">
<h4 class="anchored" data-anchor-id="step-3visualization-of-community-structure">Step 3:Visualization of community structure</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>n_communities <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">na.omit</span>(nodes<span class="sc">$</span>community)))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(n_communities <span class="sc">&gt;</span> <span class="dv">8</span>) {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Set2"</span>))(n_communities)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">max</span>(<span class="dv">3</span>, n_communities), <span class="st">"Set2"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>relation_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(edges<span class="sc">$</span>label)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>n_rel <span class="ot">&lt;-</span> <span class="fu">length</span>(relation_types)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>relation_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">max</span>(<span class="dv">3</span>, n_rel), <span class="st">"Dark2"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>relation_color_map <span class="ot">&lt;-</span> <span class="fu">setNames</span>(relation_colors, relation_types)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(graph_pv, <span class="at">layout =</span> <span class="st">'fr'</span>) <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> label),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">'mm'</span>)), </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">'mm'</span>),</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">1.3</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.9</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">TRUE</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">shape =</span> type, <span class="at">fill =</span> community),</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="fl">1.1</span>,</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">TRUE</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="cn">NA</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Person"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Node Type"</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> palette,</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Community"</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> relation_color_map,</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Relationship"</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>)</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="st">"#CCCCCC"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>)</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"People–Vessel Network: Community Structure"</span>) <span class="sc">+</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>group_summary<span class="sc">$</span>topic <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"EcoVigil|Green Guardians|Nadia Conti"</span>, group_summary<span class="sc">$</span>members, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Environmentalism"</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"Mako|Marlin|Neptune|Remora"</span>, group_summary<span class="sc">$</span>members, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Fishing/Leisure"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"Clepper Jensen|Knowles"</span>, group_summary<span class="sc">$</span>members, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Media/Investigation"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">"Boss|Small Fry"</span>, group_summary<span class="sc">$</span>members, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"Pseudonym Group"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(group_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 59%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">community</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">members</th>
<th style="text-align: left;">topic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Nadia Conti, Liam Thorne, The Middleman</td>
<td style="text-align: left;">Environmentalism</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">EcoVigil, Sentinel</td>
<td style="text-align: left;">Environmentalism</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Samantha Blake, Rodriguez, Clepper Jensen, Mrs.&nbsp;Money</td>
<td style="text-align: left;">Media/Investigation</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Mako, Neptune, Knowles</td>
<td style="text-align: left;">Fishing/Leisure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Other</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Marlin, Defender</td>
<td style="text-align: left;">Fishing/Leisure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Person</td>
<td style="text-align: left;">Boss, Small Fry</td>
<td style="text-align: left;">Pseudonym Group</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: left;">Remora</td>
<td style="text-align: left;">Fishing/Leisure</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="background-color: white;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>The community detection analysis of the people–vessel interaction network revealed several closely associated groups within the Oceanus scenario. Each community, identified through the Louvain algorithm and confirmed by network visualization, displays distinct thematic characteristics based on the key members present.</p>
<ul>
<li><p>One community centers around Nadia Conti and EcoVigil, strongly suggesting an environmentalist coalition, possibly focused on conservation activities around Nemo Reef.</p></li>
<li><p>Another group is dominated by traditional vessel names such as Mako, Marlin, and Neptune, along with key figures like Davis and Mrs.&nbsp;Money, indicating a cluster of actors involved in fishing and leisure vessel operations.</p></li>
<li><p>A smaller, tightly-knit group including Clepper Jensen and Knowles likely represents media or investigative interests, reflecting the narrative’s focus on journalistic inquiry.</p></li>
<li><p>Additionally, a community featuring members with pseudonymous names such as Boss and Small Fry appears to be engaged in covert or less formal operations.</p></li>
</ul>
<p>These findings highlight the presence of distinct interest groups within the Oceanus community, each aligned around environmentalism, fishing/leisure activities, media/investigation, or covert communications. The clear separation and internal cohesion of these groups underscore the complex social dynamics at play, supporting the investigation into tensions and alliances underlying recent events in Oceanus.</p>
</div>
</div>
</section>
</section>
<section id="task-3-pseudonym-identification" class="level3">
<h3 class="anchored" data-anchor-id="task-3-pseudonym-identification"><strong>Task 3: Pseudonym Identification</strong></h3>
</section>
<section id="task-3.1-expand-visualizations-to-reveal-who-is-using-pseudonyms" class="level3">
<h3 class="anchored" data-anchor-id="task-3.1-expand-visualizations-to-reveal-who-is-using-pseudonyms">Task 3.1 Expand visualizations to reveal who is using pseudonyms</h3>
<p>To detect the pseudonyms, below code is based on two rules for <code>sub_type = "Person"</code>:</p>
<ol type="1">
<li><p>Name starting with “The” :These are very likely pseudonyms, such as “The Lookout” or “The Intern”</p></li>
<li><p>Obvious pseudonym keywords: Names that contain certain keywords commonly used as roles or code names (e.g., “Boss”, “Accountant”, “Middleman”, etc.).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>nodes_person_vessel <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>pseudonym_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Boss"</span>, <span class="st">"Accountant"</span>, <span class="st">"Middleman"</span>, <span class="st">"Lookout"</span>, <span class="st">"Money"</span>, <span class="st">"Intern"</span>, <span class="st">"Small Fry"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>nodes_person_vessel <span class="ot">&lt;-</span> nodes_person_vessel <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_the_prefix =</span> <span class="fu">str_detect</span>(label, <span class="st">"^The "</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_keyword =</span> <span class="fu">str_detect</span>(label, <span class="fu">paste</span>(pseudonym_keywords, <span class="at">collapse =</span> <span class="st">"|"</span>)),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_pseudonym =</span> is_the_prefix <span class="sc">|</span> is_keyword</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>pseudo_table <span class="ot">&lt;-</span> nodes_person_vessel<span class="sc">%&gt;%</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_pseudonym <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pseudo_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  id             label          sub_type
  &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;   
1 The Intern     The Intern     Person  
2 The Lookout    The Lookout    Person  
3 The Accountant The Accountant Person  
4 Mrs. Money     Mrs. Money     Person  
5 The Middleman  The Middleman  Person  
6 Boss           Boss           Person  
7 Small Fry      Small Fry      Person  </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>By applying a rule-based pseudonym detection algorithm to nodes classified as sub_type = “Person”, we identified entities whose labels either begin with “The” or match a curated set of known pseudonym keywords (e.g., “Boss”, “Accountant”, “Middleman”, etc.).</p>
<p>This approach systematically flagged a total of <strong>seven</strong> unique person nodes: “The Intern”, “The Lookout”, “The Accountant”, “Mrs.&nbsp;Money”, “The Middleman”, “Boss”, and “Small Fry”.</p>
<p>These entities are highly likely to represent pseudonymous actors within the communication network, potentially serving as proxies or aliases to conceal the true identity or organizational role of the underlying individual.</p>
<p>The technical filtering strategy ensures a reproducible and objective process for pseudonym identification, which will be leveraged in downstream analyses of network influence, alias mapping, and the detection of covert activity within the Oceanus knowledge graph.</p>
</div>
</div>
</section>
<section id="task-3.2-visual-analytics-to-identify-common-entity-pseudonym-and-their-network" class="level3">
<h3 class="anchored" data-anchor-id="task-3.2-visual-analytics-to-identify-common-entity-pseudonym-and-their-network">Task 3.2 ：Visual analytics to identify common entity (Pseudonym and their network)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pseudo_labels <span class="ot">&lt;-</span> pseudo_table<span class="sc">$</span>label</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>core_ids <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(label)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>pseudo_to_rel <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> pseudo_labels <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, target)) <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">pseudo =</span> source, <span class="at">relationship =</span> target, <span class="at">type_pseudo =</span> type)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>rel_to_person <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, source) <span class="sc">&amp;</span> target <span class="sc">%in%</span> core_ids) <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">relationship =</span> source, <span class="at">person =</span> target, <span class="at">type_person =</span> type)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>pseudo_rel_network <span class="ot">&lt;-</span> pseudo_to_rel <span class="sc">%&gt;%</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(rel_to_person, <span class="at">by =</span> <span class="st">"relationship"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">pseudonym =</span> pseudo, relationship, person, <span class="at">type_pseudonym =</span> type_pseudo, type_person)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>extract_reltype <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(x, <span class="fu">regexpr</span>(<span class="st">"_(.*?)_"</span>, x))</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(m) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, m)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>rel_type_vec <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pseudo_rel_network<span class="sc">$</span>relationship, extract_reltype)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>rel_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(rel_type_vec)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>rel_colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">max</span>(<span class="dv">3</span>, <span class="fu">length</span>(rel_types)), <span class="st">"Set2"</span>), rel_types)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>person_vessel_info <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> core_ids <span class="sc">|</span> label <span class="sc">%in%</span> pseudo_labels) <span class="sc">%&gt;%</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(label, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(label, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>nodes_all <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(pseudo_rel_network<span class="sc">$</span>pseudonym, pseudo_rel_network<span class="sc">$</span>relationship, pseudo_rel_network<span class="sc">$</span>person))</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>nodes_viz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> nodes_all) <span class="sc">%&gt;%</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(person_vessel_info, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"label"</span>))</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>nodes_viz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> nodes_all) <span class="sc">%&gt;%</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(person_vessel_info, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> pseudo_labels, <span class="st">"Pseudonym"</span>,</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sub_type) <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"Person"</span>,</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sub_type) <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"Vessel"</span>,</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, id), <span class="fu">extract_reltype</span>(id), <span class="st">"Other"</span>)))),</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, id), <span class="st">""</span>, id),</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Pseudonym"</span>, <span class="fu">paste0</span>(<span class="st">"Pseudonym: "</span>, id, <span class="st">"&lt;br&gt;Type: "</span>, sub_type),</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Person"</span>, <span class="fu">paste0</span>(<span class="st">"Person: "</span>, id),</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="fu">paste0</span>(<span class="st">"Vessel: "</span>, id),</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^Relationship_"</span>, id), <span class="fu">paste0</span>(<span class="st">"Relationship: "</span>, <span class="fu">extract_reltype</span>(id)), id)))),</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Pseudonym"</span>, <span class="st">"red"</span>,</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"skyblue"</span>,</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"orange"</span>,</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(group <span class="sc">%in%</span> rel_types, rel_colors[group], <span class="st">"grey"</span>)))),</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Pseudonym"</span>, <span class="st">"square"</span>,</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"dot"</span>,</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"triangle"</span>,</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(group <span class="sc">%in%</span> rel_types, <span class="st">"diamond"</span>, <span class="st">"dot"</span>))))</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>edges_viz <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>  pseudo_rel_network <span class="sc">%&gt;%</span></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rel_type =</span> <span class="fu">extract_reltype</span>(relationship)) <span class="sc">%&gt;%</span></span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> pseudonym, <span class="at">to =</span> relationship,</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> rel_colors[rel_type],</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrows =</span> <span class="st">"to"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Pseudonym to Relationship: "</span>, rel_type)</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  pseudo_rel_network <span class="sc">%&gt;%</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rel_type =</span> <span class="fu">extract_reltype</span>(relationship)) <span class="sc">%&gt;%</span></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> relationship, <span class="at">to =</span> person,</span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> rel_colors[rel_type],</span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrows =</span> <span class="st">"to"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Relationship to Person/Vessel: "</span>, rel_type)</span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>all_legend <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Pseudonym"</span>, <span class="at">shape =</span> <span class="st">"square"</span>, <span class="at">color =</span> <span class="st">"red"</span>),</span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Person"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"skyblue"</span>),</span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Vessel"</span>, <span class="at">shape =</span> <span class="st">"triangle"</span>, <span class="at">color =</span> <span class="st">"orange"</span>)</span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_viz, edges_viz, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"800px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>,<span class="at">smooth =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>, <span class="at">selectedBy =</span> <span class="st">"group"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> all_legend,</span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">stabilization =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-752a2e3af59381c421a8" style="width:100%;height:800px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-752a2e3af59381c421a8">{"x":{"nodes":{"id":["The Intern","The Lookout","Mrs. Money","The Middleman","Boss","Small Fry","Relationship_Reports_41","Relationship_Coordinates_274","Relationship_Suspicious_219","Relationship_Operates_283","Relationship_Coordinates_437","Relationship_Reports_496","Relationship_Operates_602","Relationship_Operates_506","Relationship_Coordinates_618","Clepper Jensen","Mako","Sentinel","Remora"],"sub_type":["Person","Person","Person","Person","Person","Person",null,null,null,null,null,null,null,null,null,"Person","Vessel","Vessel","Vessel"],"group":["Pseudonym","Pseudonym","Pseudonym","Pseudonym","Pseudonym","Pseudonym","Operates","Operates","Coordinates","Reports","Coordinates","Suspicious","Operates","Coordinates","Reports","Person","Vessel","Vessel","Vessel"],"label":["The Intern","The Lookout","Mrs. Money","The Middleman","Boss","Small Fry","","","","","","","","","","Clepper Jensen","Mako","Sentinel","Remora"],"title":["Pseudonym: The Intern<br>Type: Person","Pseudonym: The Lookout<br>Type: Person","Pseudonym: Mrs. Money<br>Type: Person","Pseudonym: The Middleman<br>Type: Person","Pseudonym: Boss<br>Type: Person","Pseudonym: Small Fry<br>Type: Person","Relationship: Operates","Relationship: Operates","Relationship: Coordinates","Relationship: Reports","Relationship: Coordinates","Relationship: Suspicious","Relationship: Operates","Relationship: Coordinates","Relationship: Reports","Person: Clepper Jensen","Vessel: Mako","Vessel: Sentinel","Vessel: Remora"],"color":["red","red","red","red","red","red","#E78AC3","#E78AC3","#FC8D62","#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#FC8D62","#66C2A5","skyblue","orange","orange","orange"],"shape":["square","square","square","square","square","square","diamond","diamond","diamond","diamond","diamond","diamond","diamond","diamond","diamond","dot","triangle","triangle","triangle"]},"edges":{"from":["The Intern","The Intern","The Lookout","Mrs. Money","The Middleman","The Middleman","Boss","Small Fry","Small Fry","Relationship_Reports_41","Relationship_Coordinates_274","Relationship_Suspicious_219","Relationship_Operates_283","Relationship_Coordinates_437","Relationship_Reports_496","Relationship_Operates_602","Relationship_Operates_506","Relationship_Coordinates_618"],"to":["Relationship_Reports_41","Relationship_Coordinates_274","Relationship_Suspicious_219","Relationship_Operates_283","Relationship_Coordinates_437","Relationship_Reports_496","Relationship_Operates_602","Relationship_Operates_506","Relationship_Coordinates_618","Mrs. Money","Mrs. Money","Clepper Jensen","Mako","Sentinel","Boss","Remora","Remora","Remora"],"color":["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#FC8D62","#66C2A5","#E78AC3","#E78AC3","#FC8D62","#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#FC8D62","#66C2A5","#E78AC3","#E78AC3","#FC8D62"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"title":["Pseudonym to Relationship: Reports","Pseudonym to Relationship: Coordinates","Pseudonym to Relationship: Suspicious","Pseudonym to Relationship: Operates","Pseudonym to Relationship: Coordinates","Pseudonym to Relationship: Reports","Pseudonym to Relationship: Operates","Pseudonym to Relationship: Operates","Pseudonym to Relationship: Coordinates","Relationship to Person/Vessel: Reports","Relationship to Person/Vessel: Coordinates","Relationship to Person/Vessel: Suspicious","Relationship to Person/Vessel: Operates","Relationship to Person/Vessel: Coordinates","Relationship to Person/Vessel: Reports","Relationship to Person/Vessel: Operates","Relationship to Person/Vessel: Operates","Relationship to Person/Vessel: Coordinates"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":false},"physics":{"stabilization":true}},"groups":["Pseudonym","Operates","Coordinates","Reports","Suspicious","Person","Vessel"],"width":"100%","height":"800px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Coordinates","Operates","Person","Pseudonym","Reports","Suspicious","Vessel"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Pseudonym","shape":"square","color":"red"},{"label":"Person","shape":"dot","color":"skyblue"},{"label":"Vessel","shape":"triangle","color":"orange"}],"nodesToDataframe":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="task-3.3-how-does-your-understanding-of-activities-change-given-your-understanding-of-pseudonyms" class="level3">
<h3 class="anchored" data-anchor-id="task-3.3-how-does-your-understanding-of-activities-change-given-your-understanding-of-pseudonyms">Task 3.3 :How does your understanding of activities change given your understanding of pseudonyms?</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" style="background-color: white;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>With the explicit identification of pseudonyms such as “Boss,” “The Intern,” “The Accountant,” “Mrs.&nbsp;Money,” “The Middleman,” “The Lookout,” and “Small Fry,” my understanding of the activities within the Oceanus network changed significantly.</p>
<p><strong>Initially</strong>, communications and relationships appeared to be fragmented among many individuals and vessels. However, after mapping pseudonyms onto the network, several important patterns emerged:</p>
<ul>
<li><p><strong>Pseudonyms as Key Hubs:</strong> In the visual network, the detected pseudonyms are not peripheral actors—they consistently occupy central hub positions, connecting to multiple vessels and people through various types of relationships (such as “Reports,” “Coordinates,” “Operates,” and “Suspicious”).</p></li>
<li><p><strong>Obscured True Roles:</strong> What previously looked like many unrelated participants was actually a small set of influential actors operating under multiple pseudonyms. For example, “The Intern” and “Boss” are both connected to several vessels via “Coordinates” and “Operates” relationships, indicating they may be orchestrating or managing operations behind the scenes.</p></li>
<li><p><strong>Concealment of Illicit Activity:</strong> The structure revealed that pseudonyms are often used to mask direct links between real individuals and vessels—particularly in suspicious or high-frequency communication events. This suggests intentional obfuscation, possibly to hide illicit coordination or the flow of sensitive information.</p></li>
<li><p><strong>Redefining Influence and Risk:</strong> By highlighting pseudonyms, it becomes clear that influence within the network is far more centralized than the real-name view suggested. A few pseudonyms control or interact with a large proportion of vessels and people, making them high-value targets for further investigation.</p></li>
</ul>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>