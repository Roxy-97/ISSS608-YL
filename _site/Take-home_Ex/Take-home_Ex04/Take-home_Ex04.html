<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yang Lu">
<meta name="dcterms.date" content="2025-06-15">

<title>Take home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d4be639c637f3db3c684c66cefad7e0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/snorlax.webp" alt="Snorlax" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 3B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 4A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 4B</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 4C</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 4D</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html">
 <span class="dropdown-text">Hands-on Exercise 7:Choropleth Mapping in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex12/Hands-on_Ex12.html">
 <span class="dropdown-text">Hands-on Exercise 7:Visualising Geospatial Point Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex13/Hands-on_Ex13.html">
 <span class="dropdown-text">Hands-on Exercise 7:Analytical Mapping.</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1 phase 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 1 phase 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 2-VAST Challenges 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#take-home-exercise-3-prototyping-modules-for-visual-analytics-shiny-application" id="toc-take-home-exercise-3-prototyping-modules-for-visual-analytics-shiny-application" class="nav-link active" data-scroll-target="#take-home-exercise-3-prototyping-modules-for-visual-analytics-shiny-application"><strong>Take-home Exercise 3: Prototyping Modules for Visual Analytics Shiny Application</strong></a></li>
  <li><a href="#storyboard" id="toc-storyboard" class="nav-link" data-scroll-target="#storyboard"><strong>Storyboard</strong></a>
  <ul class="collapse">
  <li><a href="#section-1-design-for-ui-theme-navbar" id="toc-section-1-design-for-ui-theme-navbar" class="nav-link" data-scroll-target="#section-1-design-for-ui-theme-navbar">Section 1: Design for UI theme +Navbar</a></li>
  <li><a href="#section-2-project-introduction" id="toc-section-2-project-introduction" class="nav-link" data-scroll-target="#section-2-project-introduction">Section 2 :Project Introduction</a></li>
  <li><a href="#section-3-project-timeline" id="toc-section-3-project-timeline" class="nav-link" data-scroll-target="#section-3-project-timeline">Section 3: Project Timeline</a></li>
  <li><a href="#section-4-ui-sketch" id="toc-section-4-ui-sketch" class="nav-link" data-scroll-target="#section-4-ui-sketch">Section 4: UI Sketch</a></li>
  <li><a href="#section-5-task-1-interactive-visual-analytics" id="toc-section-5-task-1-interactive-visual-analytics" class="nav-link" data-scroll-target="#section-5-task-1-interactive-visual-analytics">Section 5: Task 1 Interactive Visual Analytics</a></li>
  <li><a href="#section-6task-2" id="toc-section-6task-2" class="nav-link" data-scroll-target="#section-6task-2">Section 6:Task 2</a></li>
  <li><a href="#section-7task-3-pseudonym-identification" id="toc-section-7task-3-pseudonym-identification" class="nav-link" data-scroll-target="#section-7task-3-pseudonym-identification">Section 7:Task 3 Pseudonym Identification</a></li>
  <li><a href="#section-8task-4-nidia-conti-investigation" id="toc-section-8task-4-nidia-conti-investigation" class="nav-link" data-scroll-target="#section-8task-4-nidia-conti-investigation">Section 8:Task 4 Nidia Conti Investigation</a></li>
  <li><a href="#section-9-team-introduction" id="toc-section-9-team-introduction" class="nav-link" data-scroll-target="#section-9-team-introduction">Section 9: Team introduction</a></li>
  <li><a href="#section-10-the-entire-shiny-code-chunk" id="toc-section-10-the-entire-shiny-code-chunk" class="nav-link" data-scroll-target="#section-10-the-entire-shiny-code-chunk">Section 10: The Entire Shiny Code Chunk</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yang Lu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 15, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="take-home-exercise-3-prototyping-modules-for-visual-analytics-shiny-application" class="level1">
<h1><strong>Take-home Exercise 3: Prototyping Modules for Visual Analytics Shiny Application</strong></h1>
</section>
<section id="storyboard" class="level1">
<h1><strong>Storyboard</strong></h1>
<section id="section-1-design-for-ui-theme-navbar" class="level2">
<h2 class="anchored" data-anchor-id="section-1-design-for-ui-theme-navbar">Section 1: Design for UI theme +Navbar</h2>
<p>There will split the section into : Homepage about project introduction, Project timeline, the hand draw UI sketch, Task 1, Task 2, Task 3 , Task 4 and Team member.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DIY bslib theme</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>theme_covert <span class="ot">&lt;-</span> <span class="fu">bs_theme</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg           =</span> <span class="st">"#585651"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fg           =</span> <span class="st">"#090605"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">primary      =</span> <span class="st">"#ba9b8d"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">secondary    =</span> <span class="st">"#814a38"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">base_font    =</span> <span class="fu">font_google</span>(<span class="st">"Rubik"</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">heading_font =</span> <span class="fu">font_google</span>(<span class="st">"Rubik"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  UI</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> theme_covert,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">head</span>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">      html, body { scroll-behavior: smooth; }</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert { background-color: #FFF; }</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert .nav-link { color: #c17e72 !important; font-weight: 500; }</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert .nav-link:hover { color: #DBCAC3 !important; }</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="st">      body { padding-top: 70px; }</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">      section { padding: 60px 20px; }</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="st">      /* web BG set for #DBCAC3 section */</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="st">#home,</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="st">#sketch,</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="st">#task2,</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">#task4 {</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="st">  background-color: #DBCAC3 !important;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="st">/* web BG set for #ebe2de section */</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="st">#timeline,</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="st">#task1,</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="st">#task3,</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="st">#team {</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="st">  background-color: #ebe2de !important;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="st">      /* TabsetPanel  */</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link {</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-item.show .nav-link,</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link.active {</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="st">      /* Dropdown box color matching */</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="st">      .form-control.shiny-bound-input,</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="st">      .selectize-control.single .selectize-input {</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="st">      .selectize-dropdown {</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="st">      /* dateRangeInput bg &amp; text */</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="st">      #date_range .form-control {</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">      #date_range .input-group-text {</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Navbar</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">nav</span>(<span class="at">class =</span> <span class="st">"navbar navbar-expand-lg navbar-covert fixed-top"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>           tags<span class="sc">$</span><span class="fu">div</span>(<span class="at">class =</span> <span class="st">"container-fluid"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"navbar-brand text-white"</span>, <span class="at">href =</span> <span class="st">"#home"</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                           tags<span class="sc">$</span><span class="fu">span</span>(<span class="st">"COVERT REEF "</span>), tags<span class="sc">$</span><span class="fu">span</span>(<span class="st">"\U0001FAB8"</span>, <span class="at">style =</span> <span class="st">"font-size:24px;"</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">button</span>(<span class="at">class =</span> <span class="st">"navbar-toggler"</span>, <span class="at">type =</span> <span class="st">"button"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">data-bs-toggle</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"collapse"</span>, <span class="st">`</span><span class="at">data-bs-target</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#menuCovert"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                                tags<span class="sc">$</span><span class="fu">span</span>(<span class="at">class =</span> <span class="st">"navbar-toggler-icon"</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">div</span>(<span class="at">class =</span> <span class="st">"collapse navbar-collapse"</span>, <span class="at">id =</span> <span class="st">"menuCovert"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                             tags<span class="sc">$</span><span class="fu">ul</span>(<span class="at">class =</span> <span class="st">"navbar-nav ms-auto"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#home"</span>,     <span class="st">"Home"</span>)),</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#timeline"</span>,<span class="st">"Timeline"</span>)),</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class=</span>  <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class=</span><span class="st">"nav-link"</span>, <span class="at">href=</span><span class="st">"#sketch"</span>, <span class="st">"UI Sketch"</span>)),</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task1"</span>,   <span class="st">"Task 1"</span>)),</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task2"</span>,   <span class="st">"Task 2"</span>)),</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task3"</span>,   <span class="st">"Task 3"</span>)),</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task4"</span>,   <span class="st">"Task 4"</span>)),</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#team"</span>,    <span class="st">"Team"</span>))</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>                             )</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="section-2-project-introduction" class="level2">
<h2 class="anchored" data-anchor-id="section-2-project-introduction">Section 2 :Project Introduction</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Home Section</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"home"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h1</span>(<span class="st">"Project Introduction"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">p</span>(<span class="st">"Clepper, a lead investigator on Oceanus, has been closely monitoring the closure of Nemo Reef. Over the span of two weeks, he and his intern listened to and analyzed radio communications and utilized his investigative tools to uncover a complex web of expedited approvals, hidden communication, and secretive logistics. Their investigation revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and the Green Guardians, who are a local conservationist group, pointing towards possibilities of corruption and manipulation. Amidst this investigation, Nadia Conti, a known figure formerly entangled in illegal fishing operations, has resurfaced as a person of interest. The project aims to develop new and novel visual analytics techniques to support Clepper’s investigation in uncovering the full extent of the events on Oceanus."</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h3</span>(<span class="st">"Objectives"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                          tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Identifying daily temporal patterns in communication to detect recurring message timings.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Analysing the shifts in communication patterns across the two weeks.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Focus on specific entities to determine influence within the network."</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Visualising the interactions between people and vessels to explore the interactions and relationships in the knowledge graph"</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Applying community detection to uncover groups that are closely associated with the community and the topic areas predominant for each group."</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Detecting which person or vessel is using pseudonyms and unraveling them.</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Identifying common entities in the knowledge graph."</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Understanding of the activities by unraveling pseudonyms and tracking their interactions."</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Providing evidence through visual analytics to determine whether Nadia Conti is engaging in illicit activity."</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Presenting a summary of Nadia’s actions and visual reasoning behind any suspicion."</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                                          )</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-117768707.png" class="img-fluid"></p>
</section>
<section id="section-3-project-timeline" class="level2">
<h2 class="anchored" data-anchor-id="section-3-project-timeline">Section 3: Project Timeline</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------UI-------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Timeline Section</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"timeline"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">h2</span>(<span class="st">"Project Timeline"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">plotOutput</span>(<span class="st">"timeline_plot"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#-----server----</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Project Timeline ---</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>timeline_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> <span class="st">"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">event,group,start,end,color</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">,Project Proposal,2025-06-02,2025-06-08,#a5d6a7</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">,Exploratory data analysis,2025-05-20,2025-06-08,#a5d6a7</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">,Exploratory data analysis,2025-06-08,2025-06-09,#DD4B39</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">,R Quarto/ Netlify,2025-05-20,2025-06-08,#a5d6a7</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">,R Quarto/ Netlify,2025-06-08,2025-06-30,#DD4B39</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">,R Shiny App,2025-06-15,2025-07-06,#DD4B39</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">,Poster,2025-06-23,2025-06-26,#DD4B39</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">,User Guide,2025-06-15,2025-06-26,#DD4B39</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">start =</span> <span class="fu">as.POSIXct</span>(start),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">end   =</span> <span class="fu">as.POSIXct</span>(end),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">recode</span>(color,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">#a5d6a7</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#8979BF"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">#DD4B39</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#B0BF79"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gg_vistime</span>(data) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2025-06-08"</span>)), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_datetime</span>(<span class="at">date_breaks =</span> <span class="st">"3 days"</span>, <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Rubik"</span>) <span class="sc">+</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-1059278560.png" class="img-fluid"></p>
</section>
<section id="section-4-ui-sketch" class="level2">
<h2 class="anchored" data-anchor-id="section-4-ui-sketch">Section 4: UI Sketch</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># UI Sketch</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"sketch"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">h2</span>(<span class="st">"UI Sketch"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">img</span>(<span class="at">src=</span><span class="st">"sketch.jpg"</span>, <span class="at">alt=</span><span class="st">"UI Sketch"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style=</span><span class="st">"max-width:60%; border:1px solid #ccc;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-1342992341.png" class="img-fluid" width="191"></p>
</section>
<section id="section-5-task-1-interactive-visual-analytics" class="level2">
<h2 class="anchored" data-anchor-id="section-5-task-1-interactive-visual-analytics">Section 5: Task 1 Interactive Visual Analytics</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----UI-------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — Task 1 —</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task1"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">h2</span>(<span class="st">"Task 1: Interactive Visual Analytics"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task1_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.1 Daily Patterns"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">dateRangeInput</span>(<span class="st">"date_range"</span>,<span class="st">"Select date range:"</span>, <span class="at">start=</span><span class="cn">NULL</span>, <span class="at">end=</span><span class="cn">NULL</span>)),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">sliderInput</span>(<span class="st">"hour_range"</span>,<span class="st">"Select hour range:"</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">23</span>),<span class="at">step=</span><span class="dv">1</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotOutput</span>(<span class="st">"heatmap"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.2 Week Comparison"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">checkboxGroupInput</span>(<span class="st">"weeks"</span>,<span class="st">"Select Week:"</span>,<span class="fu">c</span>(<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>),<span class="fu">c</span>(<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>))),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">sliderInput</span>(<span class="st">"hour_range2"</span>,<span class="st">"Hourly interval:"</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">23</span>),<span class="at">step=</span><span class="dv">1</span>))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotOutput</span>(<span class="st">"week_plot"</span>, <span class="at">height=</span><span class="st">"450px"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.3 Influence Analysis"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">selectInput</span>(<span class="st">"subtype"</span>,<span class="st">"Select subtype:"</span>,<span class="at">choices=</span><span class="cn">NULL</span>),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotlyOutput</span>(<span class="st">"inf_plot"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                                                                  ),</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">selectInput</span>(<span class="st">"target"</span>,<span class="st">"Select entity:"</span>,<span class="at">choices=</span><span class="cn">NULL</span>),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"net_plot"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>                                                                )</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">#-----server----</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Load data ---</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  MC3_graph <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  nodes_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>nodes)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  edges_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>edges)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  comm_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Event"</span>, sub_type<span class="sc">==</span><span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">event_id=</span>id, timestamp)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  sent_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"sent"</span>)   <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">sender=</span>source, <span class="at">event_id=</span>target)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  recv_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"received"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">event_id=</span>source, <span class="at">receiver=</span>target)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  msgs <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(recv_edges, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(comm_nodes, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">ts   =</span> <span class="fu">ymd_hms</span>(timestamp, <span class="at">tz=</span><span class="st">"UTC"</span>),</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as_date</span>(ts),</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">hour =</span> <span class="fu">hour</span>(ts)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Task 1 logic ----</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  heatmap_data <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(date, hour) <span class="sc">%&gt;%</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">complete</span>(<span class="at">date=</span><span class="fu">seq</span>(<span class="fu">min</span>(date),<span class="fu">max</span>(date),<span class="at">by=</span><span class="st">"1 day"</span>),</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>             <span class="at">hour=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">fill=</span><span class="fu">list</span>(<span class="at">n=</span><span class="dv">0</span>))</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateDateRangeInput</span>(session,<span class="st">"date_range"</span>,</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>                       <span class="at">start=</span><span class="fu">min</span>(heatmap_data<span class="sc">$</span>date),</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>                       <span class="at">end  =</span><span class="fu">max</span>(heatmap_data<span class="sc">$</span>date))</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  week_patterns <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">week=</span><span class="fu">if_else</span>(date<span class="sc">&lt;=</span><span class="fu">min</span>(date)<span class="sc">+</span><span class="fu">days</span>(<span class="dv">6</span>),<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(week,hour) <span class="sc">%&gt;%</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(week) <span class="sc">%&gt;%</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion=</span>n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  entity_info <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id, <span class="at">target_subtype=</span>sub_type)</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>  msgs2 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(entity_info, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"receiver"</span><span class="ot">=</span><span class="st">"id"</span>))</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>  top_inf <span class="ot">&lt;-</span> msgs2 <span class="sc">%&gt;%</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(receiver)) <span class="sc">%&gt;%</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(target_subtype, receiver, sender, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target_subtype, receiver) <span class="sc">%&gt;%</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(n, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>  subtypes <span class="ot">&lt;-</span> <span class="fu">unique</span>(top_inf<span class="sc">$</span>target_subtype)</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateSelectInput</span>(session,<span class="st">"subtype"</span>,</span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>                    <span class="at">choices=</span>subtypes,</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>                    <span class="at">selected=</span>subtypes[<span class="dv">1</span>])</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>  ee_edges     <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">from=</span>sender, <span class="at">to=</span>receiver)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>  entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id,name)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>  g_ig         <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(ee_edges, <span class="at">vertices=</span>entity_nodes, <span class="at">directed=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>  all_targets  <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateSelectInput</span>(session,<span class="st">"target"</span>,</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                    <span class="at">choices=</span>all_targets,</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>                    <span class="at">selected=</span>all_targets[<span class="dv">1</span>])</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co">#---- 1.1 Heat map-------------</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>date_range)</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    heatmap_data <span class="sc">%&gt;%</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>        date <span class="sc">&gt;=</span> input<span class="sc">$</span>date_range[<span class="dv">1</span>],</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>        date <span class="sc">&lt;=</span> input<span class="sc">$</span>date_range[<span class="dv">2</span>],</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>        hour <span class="sc">&gt;=</span> input<span class="sc">$</span>hour_range[<span class="dv">1</span>],</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>        hour <span class="sc">&lt;=</span> input<span class="sc">$</span>hour_range[<span class="dv">2</span>]</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">filtered_data</span>()</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(hour, date, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(input<span class="sc">$</span>hour_range[<span class="dv">1</span>], input<span class="sc">$</span>hour_range[<span class="dv">2</span>], <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>                         <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_date</span>(</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(heatmap_data<span class="sc">$</span>date), <span class="fu">max</span>(heatmap_data<span class="sc">$</span>date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">date_labels =</span> <span class="st">"%b %d"</span>,</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_distiller</span>(<span class="at">name =</span> <span class="st">"Messages"</span>, <span class="at">palette =</span> <span class="st">"Spectral"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="co">#---------- 1.2 Week Comparison-------------</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>week_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> week_patterns <span class="sc">%&gt;%</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(week <span class="sc">%in%</span> input<span class="sc">$</span>weeks,</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>             hour <span class="sc">&gt;=</span> input<span class="sc">$</span>hour_range2[<span class="dv">1</span>],</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>             hour <span class="sc">&lt;=</span> input<span class="sc">$</span>hour_range2[<span class="dv">2</span>])</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(hour, proportion, <span class="at">color=</span>week)) <span class="sc">+</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>)</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a> <span class="co">#--------------1.3 Influence Bar--------------</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>inf_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> top_inf <span class="sc">%&gt;%</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(target_subtype <span class="sc">==</span> input<span class="sc">$</span>subtype)</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="fu">reorder</span>(sender, n), n,</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> receiver,</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>                    <span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"Sender: "</span>, sender, <span class="st">"</span><span class="sc">\n</span><span class="st">Count: "</span>, n))) <span class="sc">+</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Sender"</span>, <span class="at">y=</span><span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.3 Influence Network</span></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>net_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>target)</span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> input<span class="sc">$</span>target)</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>    vids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>      root,</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">neighbors</span>(g_ig, root, <span class="at">mode=</span><span class="st">"in"</span>),</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">neighbors</span>(g_ig, root, <span class="at">mode=</span><span class="st">"out"</span>)</span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>    subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, vids)</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(subg, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>(name<span class="sc">==</span>input<span class="sc">$</span>target)),</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">"firebrick"</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>(name<span class="sc">!=</span>input<span class="sc">$</span>target)),</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">"steelblue"</span>, <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name),</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-616636990.png" class="img-fluid"></p>
</section>
<section id="section-6task-2" class="level2">
<h2 class="anchored" data-anchor-id="section-6task-2">Section 6:Task 2</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------UI---------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># — Task 2 —</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task2"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">h2</span>(<span class="st">"Task 2: People &amp; Vessels Analysis"</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task2_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"2.1 Plotted Timeline- People &amp; Vessels"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotlyOutput</span>(<span class="st">"pv_timeline"</span>, <span class="at">height=</span><span class="st">"500px"</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">br</span>(), <span class="fu">verbatimTextOutput</span>(<span class="st">"task2a_findings"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                                                       <span class="co"># inside your tabsetPanel(id="task2_tabs", type="tabs", …)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"2.2 Communities Detection"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 1) Community Detection (static)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">" Community Detection – People &amp; Vessels"</span>)),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotOutput</span>(<span class="st">"comm_graph"</span>, <span class="at">height =</span> <span class="st">"450px"</span>))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 2) PageRank PageRank bar + network</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">h4</span>(<span class="st">"PageRank Centrality (Top 10 Nodes)"</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"pr_bar"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                                                                  ),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">h4</span>(<span class="st">"PageRank‐Sized Network"</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"pr_graph"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">h5</span>(<span class="st">" Findings"</span>),</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task2b_pr_findings"</span>),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 4) Membership summary (white background)</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">"Community Group Membership – Top 5"</span>)),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">div</span>(<span class="at">style=</span><span class="st">"background:white; padding:8px;"</span>,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>                                                                             <span class="fu">tableOutput</span>(<span class="st">"comm_membership"</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>                                                                         )</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 5) Interactive community timeline</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">"Plotted Community Timeline"</span>)),</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotlyOutput</span>(<span class="st">"comm_timeline"</span>, <span class="at">height =</span> <span class="st">"450px"</span>))</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 6) Discussion</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">h5</span>(<span class="st">"Discussion / Interpretation"</span>),</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task2b_discussion"</span>)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co">#--------Server---------</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Task 2 prep ----</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  g_undir <span class="ot">&lt;-</span> <span class="fu">as_undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>)</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  comm_obj <span class="ot">&lt;-</span> <span class="fu">reactive</span>({ <span class="fu">cluster_walktrap</span>(g_undir) })</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shared timeline reactive</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  entity_meta <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id,name,sub_type)</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  timeline_df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    msgs <span class="sc">%&gt;%</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(entity_meta, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"sender"</span><span class="ot">=</span><span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Type=</span>sub_type)</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2.a Interactive Timeline</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pv_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">timeline_df</span>()</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(date, hour,</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> name,</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>                    <span class="at">shape =</span> Type,</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>                    <span class="at">text  =</span> <span class="fu">paste</span>(name, Type, hour))) <span class="sc">+</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">ncol=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Person=</span><span class="dv">16</span>, <span class="at">Vessel=</span><span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Time of Day"</span>, <span class="at">color=</span><span class="st">"Sender"</span>) <span class="sc">+</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2a_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Findings on People/ Vessels:</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="st">Core logic:</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="st">-If two names appear as sender and recipient in the same message, they cannot belong to the same person — i.e., they’re not aliases of each other.</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="st">-If two names sent a message at the exact time, they cannot belong to the same person.</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="st">-For instance, if Nadia sent a message to The Accountant, they would not be the same individual. If Nadia sent a message at 10am to The Accountant and The Lookout also sent a message at 10am to The Intern, Nadia and The Lookout cannot be the same person.</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Accountant, Mrs. Money, Elise: We see close timings between Mrs. Money and Elise on 8 Oct, and 10 Oct. These were on the same topic. Elise then disappears from radar on 10 Oct. She reappears as The Accountant and Mrs. Money on 11 Oct on the same topic and remains only as The Accountant till 14 Oct.</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="st">Select only Liam and The Middleman: The Middleman disappeared on 7 Oct and appeared as Liam on 8 Oct. On 11 Oct Mrs. Money asked The Middleman if anything was found by conservation vessels. On the same day, Liam reappeared and replied Elise that nothing was found by them.</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Boss and Nadia: The Boss disappeared on 5 Oct and reappeared as Nadia on 8 Oct. Likely the same person.</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="st">Select only Small Fry and Rodriguez: on 2 Oct Rodriguez corresponded with Remora and Mako on meeting at the slip #14. It happened again on 14 Oct as he took on dual roles and responded to the same message with different names. Likely the same person.</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Lookout and Sam: on 7 Oct Sam asked Kelly to get information on who authorized the permit. 2 minutes later, The Lookout (Kelly) responded to The Intern (Sam), that it was signed by Jensen from City Council.</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="st">Seawatch only appeared on 10 Oct but Horizon talked to Seawatch on 8 Oct. Therefore, some other entity is Seawatch before or during 8 Oct. Defender told Seawatch on 3 Oct at 8.39am that it increased its patrol and informed Seawatch to maintain vigilance. The Lookout (Seawatch) responded to Sentinel (Defender) at 8.41am that it acknowledged the need for vigilance.</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2.b Static Community Detection</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_net_static <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>    mem <span class="ot">&lt;-</span> <span class="fu">membership</span>(<span class="fu">comm_obj</span>())</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(g_undir, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,</span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,<span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Community"</span>) <span class="sc">+</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Before these outputs, define a shared reactive timeline_df() ---</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>  timeline_df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>    msgs <span class="sc">%&gt;%</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>        nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id,name,sub_type),</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Type =</span> sub_type)</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Static community‐detection plot</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_graph <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>    com  <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>))</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>    mem  <span class="ot">&lt;-</span> <span class="fu">membership</span>(com)</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>), <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,<span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># precompute PageRank</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>  pr_vals <span class="ot">&lt;-</span> <span class="fu">page_rank</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>))<span class="sc">$</span>vector</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2a) Bar chart of top PageRank nodes</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pr_bar <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>    pr_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">name     =</span> <span class="fu">V</span>(g_ig)<span class="sc">$</span>name,</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">pagerank =</span> pr_vals</span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank)) <span class="sc">%&gt;%</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(pr_df, <span class="fu">aes</span>(<span class="fu">reorder</span>(name, pagerank), pagerank)) <span class="sc">+</span></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"#377EB8"</span>) <span class="sc">+</span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Node"</span>, <span class="at">y=</span><span class="st">"PageRank"</span>, <span class="at">title=</span><span class="st">"Top 10 by PageRank"</span>) <span class="sc">+</span></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">12</span>)</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2b) Static network sized by PageRank</span></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pr_graph <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>    mem <span class="ot">&lt;-</span> <span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))</span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>), <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>pr_vals, <span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">show.legend=</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>), <span class="at">name=</span><span class="st">"PageRank"</span>) <span class="sc">+</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,<span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 3) Findings for PageRank step</span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2b_pr_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Findings:</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a><span class="st">- There were 5 closely associated groups. Community 5 (Clepper and Miranda) appeared to be segmented from the central group, due to the non-involvement from the nature of their investigative work.</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a><span class="st">From the graph, we extracted the 8 influential nodes to focus on:</span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a><span class="st">Community 1: Mako</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a><span class="st">Community 2: Neptune, Remora, Nadia, Davis</span></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a><span class="st">Community 3: N/A as they were not very influential at global level</span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="st">Community 4: Mrs. Money, Boss, The Middleman</span></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a><span class="st">Community 5: N/A as they were not very influential at global level</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="st">Community 6: N/A as they were not very influential at global level"</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4) Membership &amp; top topics (top 5 groups)</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_membership <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>    com   <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>))</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>    mem   <span class="ot">&lt;-</span> <span class="fu">membership</span>(com)</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># build membership + topics as before</span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>    mem_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name=</span><span class="fu">names</span>(mem), <span class="at">community=</span>mem)</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>    part   <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sent"</span>,<span class="st">"received"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">"sent"</span>, source, target),</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>             <span class="at">event  =</span> <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">"sent"</span>, target, source)) <span class="sc">%&gt;%</span></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(entity, event)</span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>    about  <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"about"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">event=</span>source, <span class="at">topic=</span>target)</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>    topics <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Topic"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">topic_name=</span>name)</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>    joined <span class="ot">&lt;-</span> part <span class="sc">%&gt;%</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inner_join</span>(about, <span class="at">by=</span><span class="st">"event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inner_join</span>(topics, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"topic"</span><span class="ot">=</span><span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(mem_df, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"entity"</span><span class="ot">=</span><span class="st">"name"</span>))</span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>    top_topics <span class="ot">&lt;-</span> joined <span class="sc">%&gt;%</span></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(community, topic_name, <span class="at">name=</span><span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_max</span>(n, <span class="at">n=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">predominant =</span> <span class="fu">paste</span>(topic_name, <span class="at">collapse=</span><span class="st">", "</span>))</span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>    members <span class="ot">&lt;-</span> mem_df <span class="sc">%&gt;%</span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">Members=</span><span class="fu">paste</span>(name, <span class="at">collapse=</span><span class="st">", "</span>))</span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> members <span class="sc">%&gt;%</span></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(top_topics, <span class="at">by=</span><span class="st">"community"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">Group=</span>community) <span class="sc">%&gt;%</span></span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(Group) <span class="sc">%&gt;%</span></span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">bordered=</span><span class="cn">TRUE</span>, <span class="at">spacing=</span><span class="st">"xs"</span>)</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6) Interactive community timeline</span></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reuse timeline_df() defined above Task 2.a</span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">timeline_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">name=</span><span class="fu">names</span>(<span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))),</span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a>                       <span class="at">community=</span><span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))),</span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a>                <span class="at">by=</span><span class="st">"name"</span>)</span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(date, hour, <span class="at">color=</span><span class="fu">factor</span>(community), <span class="at">shape=</span>Type,</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a>                        <span class="at">text=</span><span class="fu">paste</span>(name, <span class="st">"Grp"</span>, community, hour))) <span class="sc">+</span></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">ncol=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Person=</span><span class="dv">16</span>, <span class="at">Vessel=</span><span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Time of Day"</span>, <span class="at">color=</span><span class="st">"Community"</span>) <span class="sc">+</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 7) Discussion / Interpretation</span></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2b_discussion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Discussion:</span></span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a><span class="st">We mainly focused on the conversations by 8 influential nodes and some related nodes:</span></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a><span class="st">Conservation Group (Comm.1): Samantha Blake informed Mako to stop operations on 8 and 10th Oct. Serenity is a private luxury yacht. Osprey was likely a tourism vessel looking for charter from Mako for their tourists.</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a><span class="st">Permit (Comm. 2): Neptune, Remora, Nadia, and Davis were working on Nemo Reef operation. This referred to the Music Video Production for Sailor Shift on 14 Oct.</span></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a><span class="st">Pseudonym (Comm. 3): Other than communicating among themselves, The Lookout appeared to have also externally corresponded with Sentinel, Reef Guardian and Horizon (conservation based topics), while The Intern also externally corresponded with Mrs. Money.</span></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a><span class="st">Suspicious (Comm. 4): The Middleman had access to Council documents. Mrs. Money had funding from sources that would not flag out to regulators for her operations. Mrs. Money was investigating V. Miesel’s structures. On 5 Oct, Boss told Mrs. Money to disguise financial trails through tourism ventures and destroy evidence of Nemo Reef operations.</span></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a><span class="st">Hacklee Herald (Comm. 5): Conversations between Clepper and his intern Miranda which ended on 11 Oct. Miranda mentioned an Oceanus City Council Member meeting with unmarked vessels at night."</span></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-3540139786.png" class="img-fluid"></p>
</section>
<section id="section-7task-3-pseudonym-identification" class="level2">
<h2 class="anchored" data-anchor-id="section-7task-3-pseudonym-identification">Section 7:Task 3 Pseudonym Identification</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------UI------------------</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — Task 3: Pseudonym Identification —</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task3"</span>, <span class="fu">fluidRow</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">h2</span>(<span class="st">"Task 3: Pseudonym Identification"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task3_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.1: Rules &amp; Table</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.1 Rules &amp; Table"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">h4</span>(<span class="st">"Rules to identify pseudonyms:"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                  tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Names starting with “The ” are likely pseudonyms."</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                  tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Names containing keywords: Boss, Accountant, Middleman, Lookout, Intern, Money, Fry."</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                ),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tableOutput</span>(<span class="st">"pseudo_table"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.2: Pseudonym Network</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.2 Pseudonym Network"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">visNetworkOutput</span>(<span class="st">"pseudonym_net"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.3: Conclusion</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.3 Conclusion"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task3_conclusion"</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#-----server--------</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.1 Build the pseudo table</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  nodes_person <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id, <span class="at">label =</span> name, sub_type)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  pseudonym_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Boss"</span>, <span class="st">"Accountant"</span>, <span class="st">"Middleman"</span>, <span class="st">"Lookout"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Intern"</span>, <span class="st">"Money"</span>, <span class="st">"Fry"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  pseudo_df <span class="ot">&lt;-</span> nodes_person <span class="sc">%&gt;%</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_prefix   =</span> <span class="fu">str_detect</span>(label, <span class="st">"^The "</span>),</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_keyword  =</span> <span class="fu">str_detect</span>(label, <span class="fu">paste</span>(pseudonym_keywords, <span class="at">collapse =</span> <span class="st">"|"</span>)),</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_pseudonym =</span> is_prefix <span class="sc">|</span> is_keyword</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is_pseudonym) <span class="sc">%&gt;%</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, label, sub_type)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pseudo_table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    pseudo_df</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">bordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.2 Build &amp; render the pseudonym-only communication network</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  pseudo_labels <span class="ot">&lt;-</span> pseudo_df<span class="sc">$</span>label</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  pv_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> pseudo_labels, <span class="at">label =</span> pseudo_labels)</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  pv_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># attach sender label</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># attach receiver label</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(from <span class="sc">%in%</span> pseudo_labels, to <span class="sc">%in%</span> pseudo_labels) <span class="sc">%&gt;%</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pseudonym_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visNetwork</span>(pv_nodes, pv_edges) <span class="sc">%&gt;%</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.3 Conclusion</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task3_conclusion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>      <span class="st">"→ Identified pseudonyms:"</span>,</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(pseudo_df<span class="sc">$</span>label, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>      <span class="st">"With the explicit identification of pseudonyms such as “Boss,” “The Intern,” “The Accountant,” “Mrs. Money,” “The Middleman,” “The Lookout,” and “Small Fry,” my understanding of the activities within the Oceanus network changed significantly."</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Initially, communications and relationships appeared to be fragmented among many individuals and vessels. However, after mapping pseudonyms onto the network, several important patterns emerged:"</span>,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Pseudonyms as Key Hubs: In the visual network, the detected pseudonyms are not peripheral actors—they consistently occupy central hub positions, connecting to multiple vessels and people through various types of relationships (such as “Reports,” “Coordinates,” “Operates,” and “Suspicious”)."</span>,</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Obscured True Roles: What previously looked like many unrelated participants was actually a small set of influential actors operating under multiple pseudonyms. For example, “The Intern” and “Boss” are both connected to several vessels via “Coordinates” and “Operates” relationships, indicating they may be orchestrating or managing operations behind the scenes.)."</span>,</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Concealment of Illicit Activity: The structure revealed that pseudonyms are often used to mask direct links between real individuals and vessels—particularly in suspicious or high-frequency communication events. This suggests intentional obfuscation, possibly to hide illicit coordination or the flow of sensitive information.)"</span>,</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Redefining Influence and Risk: By highlighting pseudonyms, it becomes clear that influence within the network is far more centralized than the real-name view suggested. A few pseudonyms control or interact with a large proportion of vessels and people, making them high-value targets for further investigation."</span>,</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-2117641910.png" class="img-fluid"></p>
</section>
<section id="section-8task-4-nidia-conti-investigation" class="level2">
<h2 class="anchored" data-anchor-id="section-8task-4-nidia-conti-investigation">Section 8:Task 4 Nidia Conti Investigation</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------UI-------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task4"</span>, <span class="fu">fluidRow</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">h2</span>(<span class="st">"Task 4: Nadia Conti Investigation"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task4_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 4.1 Evidence (5 steps) —</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"4.1 Evidence"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tabsetPanel</span>(<span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 1) 8.1 Nadia’s Ego Network (1-hop Louvain)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.1 Ego (1-hop)"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">plotOutput</span>(<span class="st">"nadia_ego_1hop"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 2) 8.2 Sent vs Received Comms Nets</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.2 Comms Nets"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">fluidRow</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">h4</span>(<span class="st">"8.2.2.1 Sent Communications Network"</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">visNetworkOutput</span>(<span class="st">"nadia_sent_net"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">h4</span>(<span class="st">"8.2.2.2 Received Communications Network"</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">visNetworkOutput</span>(<span class="st">"nadia_recv_net"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                                                     )</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 3) Findings</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"Findings"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">verbatimTextOutput</span>(<span class="st">"task4_1_findings"</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 4) 8.3 Nadia’s 2-Hop Ego (Degree Centrality)</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.3 Ego (2-hop)"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">plotOutput</span>(<span class="st">"nadia_ego_2hop"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 5) Conclusion</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"Conclusion"</span>,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">verbatimTextOutput</span>(<span class="st">"task4_1_conclusion"</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                                            )</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 4.2 Summary (2 steps) —</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"4.2 Summary"</span>,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">fluidRow</span>(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">h4</span>(<span class="st">"8.4.2 Plotted Timeline (2-hop)"</span>),</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">plotlyOutput</span>(<span class="st">"nadia_2hop_timeline"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>                                  ),</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">h4</span>(<span class="st">"8.5.1 Ego &amp; Comms Table"</span>),</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>                                         DT<span class="sc">::</span><span class="fu">dataTableOutput</span>(<span class="st">"nadia_comm_table"</span>)</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="co">#------------Server-------------</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a> <span class="co"># 4.0 Nadia’s node ID</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  nadia_id <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(id)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.1 Nadia’s 1-Hop Ego Network (Louvain) —</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  ego1 <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>),</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">order =</span> <span class="dv">1</span>,</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nodes =</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>))[[<span class="dv">1</span>]]</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  com1 <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(ego1)</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>  mem1 <span class="ot">&lt;-</span> <span class="fu">membership</span>(com1)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_ego_1hop <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(ego1, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(mem1)), <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> <span class="fu">factor</span>(mem1)),</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Nadia’s 1-Hop Ego Network"</span>, <span class="at">color =</span> <span class="st">"Comm"</span>) <span class="sc">+</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.2 Sent vs Received Communications Networks —</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare sent edges/nodes</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>  sent_edges1 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sender <span class="sc">==</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  sent_nodes1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">unique</span>(<span class="fu">c</span>(sent_edges1<span class="sc">$</span>from, sent_edges1<span class="sc">$</span>to)),</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> id)</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_sent_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>    g_sent <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(sent_edges1,</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vertices =</span> sent_nodes1,</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visIgraph</span>(g_sent, <span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare received edges/nodes</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>  recv_edges1 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(receiver <span class="sc">==</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>  recv_nodes1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">unique</span>(<span class="fu">c</span>(recv_edges1<span class="sc">$</span>from, recv_edges1<span class="sc">$</span>to)),</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> id)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_recv_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>    g_recv <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(recv_edges1,</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vertices =</span> recv_nodes1,</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visIgraph</span>(g_recv, <span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.3 Findings —</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task4_1_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Nodes involved: Nadia, Davis, Elise, Haacklee Harbor, Liam, Marlin,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Neptune, Oceanus City Council, Remora, Rodriguez,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sailor Shifts Team, Sentinel, V. Miesel Shipping.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>      <span class="st">"• Sent more direct communications to Liam (2) and Neptune (2).</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>      <span class="st">"• Received more communications from Davis (5), Elise (3), Liam (2).</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Next step: drill into suspicious chars/activities."</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.4 Nadia’s 2-Hop Ego (Degree Centrality) —</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>  ego2 <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>),</span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>                         <span class="at">order =</span> <span class="dv">2</span>,</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nodes =</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>))[[<span class="dv">1</span>]]</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>  deg2 <span class="ot">&lt;-</span> <span class="fu">degree</span>(ego2)</span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>  deg2_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">names</span>(deg2), <span class="at">degree =</span> deg2)</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_ego_2hop <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(deg2_df, <span class="fu">aes</span>(<span class="fu">reorder</span>(name, degree), degree)) <span class="sc">+</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Nadia’s 2-Hop Ego (Degree Centrality)"</span>,</span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Node"</span>, <span class="at">y =</span> <span class="st">"Degree"</span>) <span class="sc">+</span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.5 Conclusion —</span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task4_1_conclusion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>      <span class="st">"1-Hop nodes: Nadia, Davis, Elise, Haacklee Harbor, Liam, Marlin,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Neptune, Oceanus City Council, Remora, Rodriguez,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sailor Shifts Team, Sentinel, V. Miesel Shipping.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2-Hop additions: EcoVigil, Sam, The Accountant, Nemo Reef.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Use these 2-hop nodes to drill deeper for suspicious links."</span></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.2.1 Plotted Timeline for all 2-Hop actors —</span></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>  hop2_names <span class="ot">&lt;-</span> <span class="fu">V</span>(ego2)<span class="sc">$</span>name</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>  id_map    <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">%in%</span> hop2_names) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, name)</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>  timeline2 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sender <span class="sc">%in%</span> id_map<span class="sc">$</span>id <span class="sc">|</span> receiver <span class="sc">%in%</span> id_map<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Actor =</span> <span class="fu">if_else</span>(sender <span class="sc">%in%</span> id_map<span class="sc">$</span>id,</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>                           id_map<span class="sc">$</span>name[<span class="fu">match</span>(sender, id_map<span class="sc">$</span>id)],</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>                           id_map<span class="sc">$</span>name[<span class="fu">match</span>(receiver, id_map<span class="sc">$</span>id)]))</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_2hop_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline2, <span class="fu">aes</span>(date, hour, <span class="at">color =</span> Actor,</span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>                               <span class="at">text =</span> <span class="fu">paste0</span>(Actor, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">format</span>(ts, <span class="st">"%Y-%m-%d %H:%M"</span>)))) <span class="sc">+</span></span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Hour"</span>, <span class="at">color =</span> <span class="st">"Actor"</span>) <span class="sc">+</span></span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.2.2 Ego &amp; Comms Table for 2-Hop actors —</span></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>  comm2_table <span class="ot">&lt;-</span> timeline2 <span class="sc">%&gt;%</span></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>      <span class="at">Date     =</span> <span class="fu">as.character</span>(date),</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time     =</span> <span class="fu">format</span>(ts, <span class="st">"%H:%M"</span>),</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sender   =</span> nodes_tbl<span class="sc">$</span>name[<span class="fu">match</span>(sender, nodes_tbl<span class="sc">$</span>id)],</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>      <span class="at">Receiver =</span> nodes_tbl<span class="sc">$</span>name[<span class="fu">match</span>(receiver, nodes_tbl<span class="sc">$</span>id)],</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">EventID  =</span> event_id</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_comm_table <span class="ot">&lt;-</span> DT<span class="sc">::</span><span class="fu">renderDataTable</span>({</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">datatable</span>(comm2_table,</span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>                  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-3686079315.png" class="img-fluid"></p>
</section>
<section id="section-9-team-introduction" class="level2">
<h2 class="anchored" data-anchor-id="section-9-team-introduction">Section 9: Team introduction</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------UI---------</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"team"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h2</span>(<span class="st">"Team Members"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                          tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Audrey"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Li JianYi"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Yang Lu"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                                          )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="er">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-2777381791.png" class="img-fluid"></p>
</section>
<section id="section-10-the-entire-shiny-code-chunk" class="level2">
<h2 class="anchored" data-anchor-id="section-10-the-entire-shiny-code-chunk">Section 10: The Entire Shiny Code Chunk</h2>
<p>The final UI link: https://roxyyanglu.shinyapps.io/Take-home_Ex03/</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vistime)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bslib)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># general HTTP downloads</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> <span class="fu">max</span>(<span class="dv">600</span>, <span class="fu">getOption</span>(<span class="st">"timeout"</span>)))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># rsconnect-specific network operations</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">rsconnect.http.timeout =</span> <span class="dv">120</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DIY bslib theme</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>theme_covert <span class="ot">&lt;-</span> <span class="fu">bs_theme</span>(</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg           =</span> <span class="st">"#585651"</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">fg           =</span> <span class="st">"#090605"</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">primary      =</span> <span class="st">"#ba9b8d"</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">secondary    =</span> <span class="st">"#814a38"</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">base_font    =</span> <span class="fu">font_google</span>(<span class="st">"Rubik"</span>),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">heading_font =</span> <span class="fu">font_google</span>(<span class="st">"Rubik"</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> theme_covert,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">head</span>(</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">"</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="st">      html, body { scroll-behavior: smooth; }</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert { background-color: #FFF; }</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert .nav-link { color: #c17e72 !important; font-weight: 500; }</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="st">      .navbar-covert .nav-link:hover { color: #DBCAC3 !important; }</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="st">      body { padding-top: 70px; }</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="st">      section { padding: 60px 20px; }</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="st">      /* web BG set for #DBCAC3 section */</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="st">#home,</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="st">#sketch,</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="st">#task2,</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="st">#task4 {</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="st">  background-color: #DBCAC3 !important;</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="st">/* web BG set for #ebe2de section */</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="st">#timeline,</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="st">#task1,</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="st">#task3,</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="st">#team {</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="st">  background-color: #ebe2de !important;</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="st">      /* TabsetPanel  */</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link {</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-item.show .nav-link,</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link.active {</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="st">      /* Dropdown box color matching */</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="st">      .form-control.shiny-bound-input,</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="st">      .selectize-control.single .selectize-input {</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="st">      .selectize-dropdown {</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="st">      /* dateRangeInput bg &amp; text */</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="st">      #date_range .form-control {</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="st">      #date_range .input-group-text {</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #bda59f !important;</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #000 !important;</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="st">        border-color: #bda59f !important;page</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>))</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Navbar</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">nav</span>(<span class="at">class =</span> <span class="st">"navbar navbar-expand-lg navbar-covert fixed-top"</span>,</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>           tags<span class="sc">$</span><span class="fu">div</span>(<span class="at">class =</span> <span class="st">"container-fluid"</span>,</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"navbar-brand text-white"</span>, <span class="at">href =</span> <span class="st">"#home"</span>,</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>                           tags<span class="sc">$</span><span class="fu">span</span>(<span class="st">"COVERT REEF "</span>), tags<span class="sc">$</span><span class="fu">span</span>(<span class="st">"\U0001FAB8"</span>, <span class="at">style =</span> <span class="st">"font-size:24px;"</span>)</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">button</span>(<span class="at">class =</span> <span class="st">"navbar-toggler"</span>, <span class="at">type =</span> <span class="st">"button"</span>,</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">data-bs-toggle</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"collapse"</span>, <span class="st">`</span><span class="at">data-bs-target</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#menuCovert"</span>,</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>                                tags<span class="sc">$</span><span class="fu">span</span>(<span class="at">class =</span> <span class="st">"navbar-toggler-icon"</span>)</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>                    tags<span class="sc">$</span><span class="fu">div</span>(<span class="at">class =</span> <span class="st">"collapse navbar-collapse"</span>, <span class="at">id =</span> <span class="st">"menuCovert"</span>,</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>                             tags<span class="sc">$</span><span class="fu">ul</span>(<span class="at">class =</span> <span class="st">"navbar-nav ms-auto"</span>,</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#home"</span>,     <span class="st">"Home"</span>)),</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#timeline"</span>,<span class="st">"Timeline"</span>)),</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class=</span>  <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class=</span><span class="st">"nav-link"</span>, <span class="at">href=</span><span class="st">"#sketch"</span>, <span class="st">"UI Sketch"</span>)),</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task1"</span>,   <span class="st">"Task 1"</span>)),</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task2"</span>,   <span class="st">"Task 2"</span>)),</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task3"</span>,   <span class="st">"Task 3"</span>)),</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#task4"</span>,   <span class="st">"Task 4"</span>)),</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>                                     tags<span class="sc">$</span><span class="fu">li</span>(<span class="at">class =</span> <span class="st">"nav-item"</span>, tags<span class="sc">$</span><span class="fu">a</span>(<span class="at">class =</span> <span class="st">"nav-link"</span>, <span class="at">href =</span> <span class="st">"#team"</span>,    <span class="st">"Team"</span>))</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>                             )</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Home Section</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"home"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h1</span>(<span class="st">"Project Introduction"</span>),</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">p</span>(<span class="st">"Clepper, a lead investigator on Oceanus, has been closely monitoring the closure of Nemo Reef. Over the span of two weeks, he and his intern listened to and analyzed radio communications and utilized his investigative tools to uncover a complex web of expedited approvals, hidden communication, and secretive logistics. Their investigation revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and the Green Guardians, who are a local conservationist group, pointing towards possibilities of corruption and manipulation. Amidst this investigation, Nadia Conti, a known figure formerly entangled in illegal fishing operations, has resurfaced as a person of interest. The project aims to develop new and novel visual analytics techniques to support Clepper’s investigation in uncovering the full extent of the events on Oceanus."</span>),</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h3</span>(<span class="st">"Objectives"</span>),</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>                                          tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Identifying daily temporal patterns in communication to detect recurring message timings.</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Analysing the shifts in communication patterns across the two weeks.</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Focus on specific entities to determine influence within the network."</span>),</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Visualising the interactions between people and vessels to explore the interactions and relationships in the knowledge graph"</span>),</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Applying community detection to uncover groups that are closely associated with the community and the topic areas predominant for each group."</span>),</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Detecting which person or vessel is using pseudonyms and unraveling them.</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>),</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Identifying common entities in the knowledge graph."</span>),</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Understanding of the activities by unraveling pseudonyms and tracking their interactions."</span>),</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Providing evidence through visual analytics to determine whether Nadia Conti is engaging in illicit activity."</span>),</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Presenting a summary of Nadia’s actions and visual reasoning behind any suspicion."</span>)</span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>                                          )</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Timeline Section</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"timeline"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">h2</span>(<span class="st">"Project Timeline"</span>),</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">plotOutput</span>(<span class="st">"timeline_plot"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># UI Sketch</span></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"sketch"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">h2</span>(<span class="st">"UI Sketch"</span>),</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">img</span>(<span class="at">src=</span><span class="st">"sketch.jpg"</span>, <span class="at">alt=</span><span class="st">"UI Sketch"</span>,</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style=</span><span class="st">"max-width:60%; border:1px solid #ccc;"</span>)</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — Task 1 —</span></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task1"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">h2</span>(<span class="st">"Task 1: Interactive Visual Analytics"</span>),</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task1_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.1 Daily Patterns"</span>,</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">dateRangeInput</span>(<span class="st">"date_range"</span>,<span class="st">"Select date range:"</span>, <span class="at">start=</span><span class="cn">NULL</span>, <span class="at">end=</span><span class="cn">NULL</span>)),</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">sliderInput</span>(<span class="st">"hour_range"</span>,<span class="st">"Select hour range:"</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">23</span>),<span class="at">step=</span><span class="dv">1</span>))</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotOutput</span>(<span class="st">"heatmap"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.2 Week Comparison"</span>,</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">checkboxGroupInput</span>(<span class="st">"weeks"</span>,<span class="st">"Select Week:"</span>,<span class="fu">c</span>(<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>),<span class="fu">c</span>(<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>))),</span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">sliderInput</span>(<span class="st">"hour_range2"</span>,<span class="st">"Hourly interval:"</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">23</span>),<span class="at">step=</span><span class="dv">1</span>))</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotOutput</span>(<span class="st">"week_plot"</span>, <span class="at">height=</span><span class="st">"450px"</span>)</span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"1.3 Influence Analysis"</span>,</span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">selectInput</span>(<span class="st">"subtype"</span>,<span class="st">"Select subtype:"</span>,<span class="at">choices=</span><span class="cn">NULL</span>),</span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotlyOutput</span>(<span class="st">"inf_plot"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>                                                                  ),</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">selectInput</span>(<span class="st">"target"</span>,<span class="st">"Select entity:"</span>,<span class="at">choices=</span><span class="cn">NULL</span>),</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"net_plot"</span>, <span class="at">height=</span><span class="st">"600px"</span>)</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>                                                                )</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — Task 2 —</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task2"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">h2</span>(<span class="st">"Task 2: People &amp; Vessels Analysis"</span>),</span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task2_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"2.1 Plotted Timeline- People &amp; Vessels"</span>,</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">plotlyOutput</span>(<span class="st">"pv_timeline"</span>, <span class="at">height=</span><span class="st">"500px"</span>),</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">br</span>(), <span class="fu">verbatimTextOutput</span>(<span class="st">"task2a_findings"</span>)</span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>                                                       <span class="co"># inside your tabsetPanel(id="task2_tabs", type="tabs", …)</span></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">tabPanel</span>(<span class="st">"2.2 Communities Detection"</span>,</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 1) Community Detection (static)</span></span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">" Community Detection – People &amp; Vessels"</span>)),</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotOutput</span>(<span class="st">"comm_graph"</span>, <span class="at">height =</span> <span class="st">"450px"</span>))</span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 2) PageRank PageRank bar + network</span></span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">h4</span>(<span class="st">"PageRank Centrality (Top 10 Nodes)"</span>),</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"pr_bar"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>                                                                  ),</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">h4</span>(<span class="st">"PageRank‐Sized Network"</span>),</span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">plotOutput</span>(<span class="st">"pr_graph"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)</span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">h5</span>(<span class="st">" Findings"</span>),</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task2b_pr_findings"</span>),</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 4) Membership summary (white background)</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">"Community Group Membership – Top 5"</span>)),</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="fu">div</span>(<span class="at">style=</span><span class="st">"background:white; padding:8px;"</span>,</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>                                                                             <span class="fu">tableOutput</span>(<span class="st">"comm_membership"</span>)</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>                                                                         )</span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>                                                                  )</span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 5) Interactive community timeline</span></span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">h4</span>(<span class="st">"Plotted Community Timeline"</span>)),</span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotlyOutput</span>(<span class="st">"comm_timeline"</span>, <span class="at">height =</span> <span class="st">"450px"</span>))</span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a>                                                                ),</span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># 6) Discussion</span></span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">h5</span>(<span class="st">"Discussion / Interpretation"</span>),</span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task2b_discussion"</span>)</span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>                                                       </span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>  ))),</span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — Task 3: Pseudonym Identification —</span></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task3"</span>, <span class="fu">fluidRow</span>(</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>           <span class="fu">h2</span>(<span class="st">"Task 3: Pseudonym Identification"</span>),</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task3_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.1: Rules &amp; Table</span></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.1 Rules &amp; Table"</span>,</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">h4</span>(<span class="st">"Rules to identify pseudonyms:"</span>),</span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>                                tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>                                  tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Names starting with “The ” are likely pseudonyms."</span>),</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>                                  tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Names containing keywords: Boss, Accountant, Middleman, Lookout, Intern, Money, Fry."</span>)</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>                                ),</span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tableOutput</span>(<span class="st">"pseudo_table"</span>)</span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.2: Pseudonym Network</span></span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.2 Pseudonym Network"</span>,</span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">visNetworkOutput</span>(<span class="st">"pseudonym_net"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 3.3: Conclusion</span></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"3.3 Conclusion"</span>,</span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">verbatimTextOutput</span>(<span class="st">"task3_conclusion"</span>)</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>  <span class="do">## — Task 4: Nadia Conti Investigation —</span></span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ——————— UI ————————</span></span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"task4"</span>, <span class="fu">fluidRow</span>(</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>           <span class="fu">h2</span>(<span class="st">"Task 4: Nadia Conti Investigation"</span>),</span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>           <span class="fu">tabsetPanel</span>(<span class="at">id=</span><span class="st">"task4_tabs"</span>, <span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 4.1 Evidence (5 steps) —</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"4.1 Evidence"</span>,</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tabsetPanel</span>(<span class="at">type=</span><span class="st">"tabs"</span>,</span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 1) 8.1 Nadia’s Ego Network (1-hop Louvain)</span></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.1 Ego (1-hop)"</span>,</span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">plotOutput</span>(<span class="st">"nadia_ego_1hop"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 2) 8.2 Sent vs Received Comms Nets</span></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.2 Comms Nets"</span>,</span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">fluidRow</span>(</span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">h4</span>(<span class="st">"8.2.2.1 Sent Communications Network"</span>),</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">visNetworkOutput</span>(<span class="st">"nadia_sent_net"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>                                                       ),</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">h4</span>(<span class="st">"8.2.2.2 Received Communications Network"</span>),</span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">visNetworkOutput</span>(<span class="st">"nadia_recv_net"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>                                                       )</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>                                                     )</span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 3) Findings</span></span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"Findings"</span>,</span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">verbatimTextOutput</span>(<span class="st">"task4_1_findings"</span>)</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 4) 8.3 Nadia’s 2-Hop Ego (Degree Centrality)</span></span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"8.3 Ego (2-hop)"</span>,</span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">plotOutput</span>(<span class="st">"nadia_ego_2hop"</span>, <span class="at">height=</span><span class="st">"400px"</span>)</span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>                                            ),</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># 5) Conclusion</span></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">tabPanel</span>(<span class="st">"Conclusion"</span>,</span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">verbatimTextOutput</span>(<span class="st">"task4_1_conclusion"</span>)</span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a>                                            )</span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># 4.2 Summary (2 steps) —</span></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">tabPanel</span>(<span class="st">"4.2 Summary"</span>,</span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">fluidRow</span>(</span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">h4</span>(<span class="st">"8.4.2 Plotted Timeline (2-hop)"</span>),</span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">plotlyOutput</span>(<span class="st">"nadia_2hop_timeline"</span>, <span class="at">height=</span><span class="st">"350px"</span>)</span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>                                  ),</span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">h4</span>(<span class="st">"8.5.1 Ego &amp; Comms Table"</span>),</span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>                                         DT<span class="sc">::</span><span class="fu">dataTableOutput</span>(<span class="st">"nadia_comm_table"</span>)</span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Team introduction</span></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">section</span>(<span class="at">id=</span><span class="st">"team"</span>, <span class="fu">fluidRow</span>(<span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">h2</span>(<span class="st">"Team Members"</span>),</span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>                                          tags<span class="sc">$</span><span class="fu">ul</span>(</span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Audrey"</span>),</span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Li JianYi"</span>),</span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a>                                            tags<span class="sc">$</span><span class="fu">li</span>(<span class="st">"Yang Lu"</span>)</span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a>                                          )</span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Task 0: Timeline ---</span></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>timeline_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> <span class="st">"</span></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a><span class="st">event,group,start,end,color</span></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="st">,Project Proposal,2025-06-02,2025-06-08,#a5d6a7</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a><span class="st">,Exploratory data analysis,2025-05-20,2025-06-08,#a5d6a7</span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a><span class="st">,Exploratory data analysis,2025-06-08,2025-06-09,#DD4B39</span></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a><span class="st">,R Quarto/ Netlify,2025-05-20,2025-06-08,#a5d6a7</span></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a><span class="st">,R Quarto/ Netlify,2025-06-08,2025-06-30,#DD4B39</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a><span class="st">,R Shiny App,2025-06-15,2025-07-06,#DD4B39</span></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a><span class="st">,Poster,2025-06-23,2025-06-26,#DD4B39</span></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="st">,User Guide,2025-06-15,2025-06-26,#DD4B39</span></span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a>        <span class="at">start =</span> <span class="fu">as.POSIXct</span>(start),</span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a>        <span class="at">end   =</span> <span class="fu">as.POSIXct</span>(end),</span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">recode</span>(color,</span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">#a5d6a7</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#8979BF"</span>,</span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a>                       <span class="st">`</span><span class="at">#DD4B39</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"#B0BF79"</span>)</span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gg_vistime</span>(data) <span class="sc">+</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2025-06-08"</span>)), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_datetime</span>(<span class="at">date_breaks =</span> <span class="st">"3 days"</span>, <span class="at">date_labels =</span> <span class="st">"%d %b"</span>) <span class="sc">+</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Rubik"</span>) <span class="sc">+</span></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Load &amp; preprocess for Task 1 &amp; 2 ---</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a>  MC3_graph <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a>  nodes_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>nodes)</span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a>  edges_tbl  <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3_graph<span class="sc">$</span>edges)</span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a>  comm_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Event"</span>, sub_type<span class="sc">==</span><span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(<span class="at">event_id=</span>id, timestamp)</span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a>  sent_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"sent"</span>)   <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">sender=</span>source, <span class="at">event_id=</span>target)</span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a>  recv_edges <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"received"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">event_id=</span>source, <span class="at">receiver=</span>target)</span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a>  msgs <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(recv_edges, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(comm_nodes, <span class="at">by=</span><span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a>      <span class="at">ts   =</span> <span class="fu">ymd_hms</span>(timestamp, <span class="at">tz=</span><span class="st">"UTC"</span>),</span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as_date</span>(ts),</span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a>      <span class="at">hour =</span> <span class="fu">hour</span>(ts)</span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Task 1 logic ----</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a>  heatmap_data <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(date, hour) <span class="sc">%&gt;%</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">complete</span>(<span class="at">date=</span><span class="fu">seq</span>(<span class="fu">min</span>(date),<span class="fu">max</span>(date),<span class="at">by=</span><span class="st">"1 day"</span>),</span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a>             <span class="at">hour=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">fill=</span><span class="fu">list</span>(<span class="at">n=</span><span class="dv">0</span>))</span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateDateRangeInput</span>(session,<span class="st">"date_range"</span>,</span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a>                       <span class="at">start=</span><span class="fu">min</span>(heatmap_data<span class="sc">$</span>date),</span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a>                       <span class="at">end  =</span><span class="fu">max</span>(heatmap_data<span class="sc">$</span>date))</span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a>  week_patterns <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">week=</span><span class="fu">if_else</span>(date<span class="sc">&lt;=</span><span class="fu">min</span>(date)<span class="sc">+</span><span class="fu">days</span>(<span class="dv">6</span>),<span class="st">"Week 1"</span>,<span class="st">"Week 2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(week,hour) <span class="sc">%&gt;%</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(week) <span class="sc">%&gt;%</span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion=</span>n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a>  entity_info <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id, <span class="at">target_subtype=</span>sub_type)</span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a>  msgs2 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(entity_info, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"receiver"</span><span class="ot">=</span><span class="st">"id"</span>))</span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a>  top_inf <span class="ot">&lt;-</span> msgs2 <span class="sc">%&gt;%</span></span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(receiver)) <span class="sc">%&gt;%</span></span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(target_subtype, receiver, sender, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target_subtype, receiver) <span class="sc">%&gt;%</span></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(n, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a>  subtypes <span class="ot">&lt;-</span> <span class="fu">unique</span>(top_inf<span class="sc">$</span>target_subtype)</span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateSelectInput</span>(session,<span class="st">"subtype"</span>,</span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a>                    <span class="at">choices=</span>subtypes,</span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a>                    <span class="at">selected=</span>subtypes[<span class="dv">1</span>])</span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a>  ee_edges     <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">from=</span>sender, <span class="at">to=</span>receiver)</span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a>  entity_nodes <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id,name)</span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a>  g_ig         <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(ee_edges, <span class="at">vertices=</span>entity_nodes, <span class="at">directed=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a>  all_targets  <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name)</span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateSelectInput</span>(session,<span class="st">"target"</span>,</span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a>                    <span class="at">choices=</span>all_targets,</span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a>                    <span class="at">selected=</span>all_targets[<span class="dv">1</span>])</span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.1 Heatmap</span></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>date_range)</span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a>    heatmap_data <span class="sc">%&gt;%</span></span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(</span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a>        date <span class="sc">&gt;=</span> input<span class="sc">$</span>date_range[<span class="dv">1</span>],</span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a>        date <span class="sc">&lt;=</span> input<span class="sc">$</span>date_range[<span class="dv">2</span>],</span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a>        hour <span class="sc">&gt;=</span> input<span class="sc">$</span>hour_range[<span class="dv">1</span>],</span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a>        hour <span class="sc">&lt;=</span> input<span class="sc">$</span>hour_range[<span class="dv">2</span>]</span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">filtered_data</span>()</span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(hour, date, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(input<span class="sc">$</span>hour_range[<span class="dv">1</span>], input<span class="sc">$</span>hour_range[<span class="dv">2</span>], <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a>                         <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_date</span>(</span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(heatmap_data<span class="sc">$</span>date), <span class="fu">max</span>(heatmap_data<span class="sc">$</span>date), <span class="at">by =</span> <span class="st">"1 day"</span>),</span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a>        <span class="at">date_labels =</span> <span class="st">"%b %d"</span>,</span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a>        <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_distiller</span>(<span class="at">name =</span> <span class="st">"Messages"</span>, <span class="at">palette =</span> <span class="st">"Spectral"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.2 Week Comparison</span></span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>week_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> week_patterns <span class="sc">%&gt;%</span></span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(week <span class="sc">%in%</span> input<span class="sc">$</span>weeks,</span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a>             hour <span class="sc">&gt;=</span> input<span class="sc">$</span>hour_range2[<span class="dv">1</span>],</span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a>             hour <span class="sc">&lt;=</span> input<span class="sc">$</span>hour_range2[<span class="dv">2</span>])</span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(hour, proportion, <span class="at">color=</span>week)) <span class="sc">+</span></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>)</span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.3 Influence Bar</span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>inf_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> top_inf <span class="sc">%&gt;%</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(target_subtype <span class="sc">==</span> input<span class="sc">$</span>subtype)</span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,</span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="fu">reorder</span>(sender, n), n,</span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> receiver,</span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a>                    <span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"Sender: "</span>, sender, <span class="st">"</span><span class="sc">\n</span><span class="st">Count: "</span>, n))) <span class="sc">+</span></span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Sender"</span>, <span class="at">y=</span><span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.3 Influence Network</span></span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>net_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>target)</span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> input<span class="sc">$</span>target)</span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a>    vids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a>      root,</span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a>      <span class="fu">neighbors</span>(g_ig, root, <span class="at">mode=</span><span class="st">"in"</span>),</span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a>      <span class="fu">neighbors</span>(g_ig, root, <span class="at">mode=</span><span class="st">"out"</span>)</span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a>    subg <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(g_ig, vids)</span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(subg, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>(name<span class="sc">==</span>input<span class="sc">$</span>target)),</span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">"firebrick"</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>(name<span class="sc">!=</span>input<span class="sc">$</span>target)),</span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">"steelblue"</span>, <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name),</span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Task 2 prep ----</span></span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a>  g_undir <span class="ot">&lt;-</span> <span class="fu">as_undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>)</span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a>  comm_obj <span class="ot">&lt;-</span> <span class="fu">reactive</span>({ <span class="fu">cluster_walktrap</span>(g_undir) })</span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shared timeline reactive</span></span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a>  entity_meta <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id,name,sub_type)</span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a>  timeline_df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a>    msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(entity_meta, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"sender"</span><span class="ot">=</span><span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Type=</span>sub_type)</span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2.a Interactive Timeline</span></span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pv_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">timeline_df</span>()</span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,</span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(date, hour,</span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> name,</span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a>                    <span class="at">shape =</span> Type,</span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a>                    <span class="at">text  =</span> <span class="fu">paste</span>(name, Type, hour))) <span class="sc">+</span></span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">ncol=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Person=</span><span class="dv">16</span>, <span class="at">Vessel=</span><span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Time of Day"</span>, <span class="at">color=</span><span class="st">"Sender"</span>) <span class="sc">+</span></span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2a_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Findings on People/ Vessels:</span></span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a><span class="st">Core logic:</span></span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a><span class="st">-If two names appear as sender and recipient in the same message, they cannot belong to the same person — i.e., they’re not aliases of each other.</span></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a><span class="st">-If two names sent a message at the exact time, they cannot belong to the same person.</span></span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a><span class="st">-For instance, if Nadia sent a message to The Accountant, they would not be the same individual. If Nadia sent a message at 10am to The Accountant and The Lookout also sent a message at 10am to The Intern, Nadia and The Lookout cannot be the same person.</span></span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Accountant, Mrs. Money, Elise: We see close timings between Mrs. Money and Elise on 8 Oct, and 10 Oct. These were on the same topic. Elise then disappears from radar on 10 Oct. She reappears as The Accountant and Mrs. Money on 11 Oct on the same topic and remains only as The Accountant till 14 Oct.</span></span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a><span class="st">Select only Liam and The Middleman: The Middleman disappeared on 7 Oct and appeared as Liam on 8 Oct. On 11 Oct Mrs. Money asked The Middleman if anything was found by conservation vessels. On the same day, Liam reappeared and replied Elise that nothing was found by them.</span></span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Boss and Nadia: The Boss disappeared on 5 Oct and reappeared as Nadia on 8 Oct. Likely the same person.</span></span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a><span class="st">Select only Small Fry and Rodriguez: on 2 Oct Rodriguez corresponded with Remora and Mako on meeting at the slip #14. It happened again on 14 Oct as he took on dual roles and responded to the same message with different names. Likely the same person.</span></span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a><span class="st">Select only The Lookout and Sam: on 7 Oct Sam asked Kelly to get information on who authorized the permit. 2 minutes later, The Lookout (Kelly) responded to The Intern (Sam), that it was signed by Jensen from City Council.</span></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a><span class="st">Seawatch only appeared on 10 Oct but Horizon talked to Seawatch on 8 Oct. Therefore, some other entity is Seawatch before or during 8 Oct. Defender told Seawatch on 3 Oct at 8.39am that it increased its patrol and informed Seawatch to maintain vigilance. The Lookout (Seawatch) responded to Sentinel (Defender) at 8.41am that it acknowledged the need for vigilance.</span></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a><span class="st">        "</span></span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2.b Static Community Detection</span></span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_net_static <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a>    mem <span class="ot">&lt;-</span> <span class="fu">membership</span>(<span class="fu">comm_obj</span>())</span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(g_undir, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,</span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,<span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Community"</span>) <span class="sc">+</span></span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Before these outputs, define a shared reactive timeline_df() ---</span></span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a>  timeline_df <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a>    msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(</span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a>        nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Entity"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id,name,sub_type),</span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)</span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Type =</span> sub_type)</span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Static community‐detection plot</span></span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_graph <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a>    com  <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>))</span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a>    mem  <span class="ot">&lt;-</span> <span class="fu">membership</span>(com)</span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>), <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,<span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,</span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a>  <span class="co"># precompute PageRank</span></span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a>  pr_vals <span class="ot">&lt;-</span> <span class="fu">page_rank</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>))<span class="sc">$</span>vector</span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2a) Bar chart of top PageRank nodes</span></span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pr_bar <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a>    pr_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a>      <span class="at">name     =</span> <span class="fu">V</span>(g_ig)<span class="sc">$</span>name,</span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a>      <span class="at">pagerank =</span> pr_vals</span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank)) <span class="sc">%&gt;%</span></span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(pr_df, <span class="fu">aes</span>(<span class="fu">reorder</span>(name, pagerank), pagerank)) <span class="sc">+</span></span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"#377EB8"</span>) <span class="sc">+</span></span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Node"</span>, <span class="at">y=</span><span class="st">"PageRank"</span>, <span class="at">title=</span><span class="st">"Top 10 by PageRank"</span>) <span class="sc">+</span></span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">12</span>)</span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2b) Static network sized by PageRank</span></span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pr_graph <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a>    mem <span class="ot">&lt;-</span> <span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))</span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>), <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>pr_vals, <span class="at">color=</span><span class="fu">factor</span>(mem[name])), <span class="at">show.legend=</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb10-671"><a href="#cb10-671" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name, <span class="at">color=</span><span class="fu">factor</span>(mem[name])),</span>
<span id="cb10-672"><a href="#cb10-672" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-673"><a href="#cb10-673" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>), <span class="at">name=</span><span class="st">"PageRank"</span>) <span class="sc">+</span></span>
<span id="cb10-674"><a href="#cb10-674" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"1"</span><span class="ot">=</span><span class="st">"#E41A1C"</span>,<span class="st">"2"</span><span class="ot">=</span><span class="st">"#377EB8"</span>,<span class="st">"3"</span><span class="ot">=</span><span class="st">"#4DAF4A"</span>,</span>
<span id="cb10-675"><a href="#cb10-675" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"4"</span><span class="ot">=</span><span class="st">"#984EA3"</span>,<span class="st">"5"</span><span class="ot">=</span><span class="st">"#FF7F00"</span>)) <span class="sc">+</span></span>
<span id="cb10-676"><a href="#cb10-676" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb10-677"><a href="#cb10-677" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-678"><a href="#cb10-678" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-679"><a href="#cb10-679" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3) Findings for PageRank step</span></span>
<span id="cb10-680"><a href="#cb10-680" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2b_pr_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-681"><a href="#cb10-681" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Findings:</span></span>
<span id="cb10-682"><a href="#cb10-682" aria-hidden="true" tabindex="-1"></a><span class="st">- There were 5 closely associated groups. Community 5 (Clepper and Miranda) appeared to be segmented from the central group, due to the non-involvement from the nature of their investigative work.</span></span>
<span id="cb10-683"><a href="#cb10-683" aria-hidden="true" tabindex="-1"></a><span class="st">From the graph, we extracted the 8 influential nodes to focus on:</span></span>
<span id="cb10-684"><a href="#cb10-684" aria-hidden="true" tabindex="-1"></a><span class="st">Community 1: Mako</span></span>
<span id="cb10-685"><a href="#cb10-685" aria-hidden="true" tabindex="-1"></a><span class="st">Community 2: Neptune, Remora, Nadia, Davis</span></span>
<span id="cb10-686"><a href="#cb10-686" aria-hidden="true" tabindex="-1"></a><span class="st">Community 3: N/A as they were not very influential at global level</span></span>
<span id="cb10-687"><a href="#cb10-687" aria-hidden="true" tabindex="-1"></a><span class="st">Community 4: Mrs. Money, Boss, The Middleman</span></span>
<span id="cb10-688"><a href="#cb10-688" aria-hidden="true" tabindex="-1"></a><span class="st">Community 5: N/A as they were not very influential at global level</span></span>
<span id="cb10-689"><a href="#cb10-689" aria-hidden="true" tabindex="-1"></a><span class="st">Community 6: N/A as they were not very influential at global level"</span></span>
<span id="cb10-690"><a href="#cb10-690" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-691"><a href="#cb10-691" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-692"><a href="#cb10-692" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4) Membership &amp; top topics (top 5 groups)</span></span>
<span id="cb10-693"><a href="#cb10-693" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_membership <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb10-694"><a href="#cb10-694" aria-hidden="true" tabindex="-1"></a>    com   <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>))</span>
<span id="cb10-695"><a href="#cb10-695" aria-hidden="true" tabindex="-1"></a>    mem   <span class="ot">&lt;-</span> <span class="fu">membership</span>(com)</span>
<span id="cb10-696"><a href="#cb10-696" aria-hidden="true" tabindex="-1"></a>    <span class="co"># build membership + topics as before</span></span>
<span id="cb10-697"><a href="#cb10-697" aria-hidden="true" tabindex="-1"></a>    mem_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name=</span><span class="fu">names</span>(mem), <span class="at">community=</span>mem)</span>
<span id="cb10-698"><a href="#cb10-698" aria-hidden="true" tabindex="-1"></a>    part   <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-699"><a href="#cb10-699" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sent"</span>,<span class="st">"received"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-700"><a href="#cb10-700" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">"sent"</span>, source, target),</span>
<span id="cb10-701"><a href="#cb10-701" aria-hidden="true" tabindex="-1"></a>             <span class="at">event  =</span> <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">"sent"</span>, target, source)) <span class="sc">%&gt;%</span></span>
<span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(entity, event)</span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a>    about  <span class="ot">&lt;-</span> edges_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"about"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">event=</span>source, <span class="at">topic=</span>target)</span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a>    topics <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Topic"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">topic_name=</span>name)</span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a>    joined <span class="ot">&lt;-</span> part <span class="sc">%&gt;%</span></span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inner_join</span>(about, <span class="at">by=</span><span class="st">"event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inner_join</span>(topics, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"topic"</span><span class="ot">=</span><span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(mem_df, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"entity"</span><span class="ot">=</span><span class="st">"name"</span>))</span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a>    top_topics <span class="ot">&lt;-</span> joined <span class="sc">%&gt;%</span></span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(community, topic_name, <span class="at">name=</span><span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_max</span>(n, <span class="at">n=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">predominant =</span> <span class="fu">paste</span>(topic_name, <span class="at">collapse=</span><span class="st">", "</span>))</span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a>    members <span class="ot">&lt;-</span> mem_df <span class="sc">%&gt;%</span></span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(community) <span class="sc">%&gt;%</span></span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">Members=</span><span class="fu">paste</span>(name, <span class="at">collapse=</span><span class="st">", "</span>))</span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> members <span class="sc">%&gt;%</span></span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(top_topics, <span class="at">by=</span><span class="st">"community"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">Group=</span>community) <span class="sc">%&gt;%</span></span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(Group) <span class="sc">%&gt;%</span></span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">bordered=</span><span class="cn">TRUE</span>, <span class="at">spacing=</span><span class="st">"xs"</span>)</span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6) Interactive community timeline</span></span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>comm_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reuse timeline_df() defined above Task 2.a</span></span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">timeline_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(<span class="fu">tibble</span>(<span class="at">name=</span><span class="fu">names</span>(<span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))),</span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a>                       <span class="at">community=</span><span class="fu">membership</span>(<span class="fu">cluster_louvain</span>(<span class="fu">as.undirected</span>(g_ig,<span class="at">mode=</span><span class="st">"collapse"</span>)))),</span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a>                <span class="at">by=</span><span class="st">"name"</span>)</span>
<span id="cb10-739"><a href="#cb10-739" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(date, hour, <span class="at">color=</span><span class="fu">factor</span>(community), <span class="at">shape=</span>Type,</span>
<span id="cb10-740"><a href="#cb10-740" aria-hidden="true" tabindex="-1"></a>                        <span class="at">text=</span><span class="fu">paste</span>(name, <span class="st">"Grp"</span>, community, hour))) <span class="sc">+</span></span>
<span id="cb10-741"><a href="#cb10-741" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-742"><a href="#cb10-742" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">ncol=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-743"><a href="#cb10-743" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Person=</span><span class="dv">16</span>, <span class="at">Vessel=</span><span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb10-744"><a href="#cb10-744" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Time of Day"</span>, <span class="at">color=</span><span class="st">"Community"</span>) <span class="sc">+</span></span>
<span id="cb10-745"><a href="#cb10-745" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb10-746"><a href="#cb10-746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip=</span><span class="st">"text"</span>)</span>
<span id="cb10-747"><a href="#cb10-747" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-748"><a href="#cb10-748" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-749"><a href="#cb10-749" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 7) Discussion / Interpretation</span></span>
<span id="cb10-750"><a href="#cb10-750" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task2b_discussion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-751"><a href="#cb10-751" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Discussion:</span></span>
<span id="cb10-752"><a href="#cb10-752" aria-hidden="true" tabindex="-1"></a><span class="st">We mainly focused on the conversations by 8 influential nodes and some related nodes:</span></span>
<span id="cb10-753"><a href="#cb10-753" aria-hidden="true" tabindex="-1"></a><span class="st">Conservation Group (Comm.1): Samantha Blake informed Mako to stop operations on 8 and 10th Oct. Serenity is a private luxury yacht. Osprey was likely a tourism vessel looking for charter from Mako for their tourists.</span></span>
<span id="cb10-754"><a href="#cb10-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-755"><a href="#cb10-755" aria-hidden="true" tabindex="-1"></a><span class="st">Permit (Comm. 2): Neptune, Remora, Nadia, and Davis were working on Nemo Reef operation. This referred to the Music Video Production for Sailor Shift on 14 Oct.</span></span>
<span id="cb10-756"><a href="#cb10-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-757"><a href="#cb10-757" aria-hidden="true" tabindex="-1"></a><span class="st">Pseudonym (Comm. 3): Other than communicating among themselves, The Lookout appeared to have also externally corresponded with Sentinel, Reef Guardian and Horizon (conservation based topics), while The Intern also externally corresponded with Mrs. Money.</span></span>
<span id="cb10-758"><a href="#cb10-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-759"><a href="#cb10-759" aria-hidden="true" tabindex="-1"></a><span class="st">Suspicious (Comm. 4): The Middleman had access to Council documents. Mrs. Money had funding from sources that would not flag out to regulators for her operations. Mrs. Money was investigating V. Miesel’s structures. On 5 Oct, Boss told Mrs. Money to disguise financial trails through tourism ventures and destroy evidence of Nemo Reef operations.</span></span>
<span id="cb10-760"><a href="#cb10-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-761"><a href="#cb10-761" aria-hidden="true" tabindex="-1"></a><span class="st">Hacklee Herald (Comm. 5): Conversations between Clepper and his intern Miranda which ended on 11 Oct. Miranda mentioned an Oceanus City Council Member meeting with unmarked vessels at night."</span></span>
<span id="cb10-762"><a href="#cb10-762" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-763"><a href="#cb10-763" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-764"><a href="#cb10-764" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-765"><a href="#cb10-765" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Task 3: rule-based pseudonym detection ----</span></span>
<span id="cb10-766"><a href="#cb10-766" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-767"><a href="#cb10-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.1 Build the pseudo table</span></span>
<span id="cb10-768"><a href="#cb10-768" aria-hidden="true" tabindex="-1"></a>  nodes_person <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-769"><a href="#cb10-769" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-770"><a href="#cb10-770" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(id, <span class="at">label =</span> name, sub_type)</span>
<span id="cb10-771"><a href="#cb10-771" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-772"><a href="#cb10-772" aria-hidden="true" tabindex="-1"></a>  pseudonym_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Boss"</span>, <span class="st">"Accountant"</span>, <span class="st">"Middleman"</span>, <span class="st">"Lookout"</span>,</span>
<span id="cb10-773"><a href="#cb10-773" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Intern"</span>, <span class="st">"Money"</span>, <span class="st">"Fry"</span>)</span>
<span id="cb10-774"><a href="#cb10-774" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-775"><a href="#cb10-775" aria-hidden="true" tabindex="-1"></a>  pseudo_df <span class="ot">&lt;-</span> nodes_person <span class="sc">%&gt;%</span></span>
<span id="cb10-776"><a href="#cb10-776" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb10-777"><a href="#cb10-777" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_prefix   =</span> <span class="fu">str_detect</span>(label, <span class="st">"^The "</span>),</span>
<span id="cb10-778"><a href="#cb10-778" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_keyword  =</span> <span class="fu">str_detect</span>(label, <span class="fu">paste</span>(pseudonym_keywords, <span class="at">collapse =</span> <span class="st">"|"</span>)),</span>
<span id="cb10-779"><a href="#cb10-779" aria-hidden="true" tabindex="-1"></a>      <span class="at">is_pseudonym =</span> is_prefix <span class="sc">|</span> is_keyword</span>
<span id="cb10-780"><a href="#cb10-780" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-781"><a href="#cb10-781" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is_pseudonym) <span class="sc">%&gt;%</span></span>
<span id="cb10-782"><a href="#cb10-782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, label, sub_type)</span>
<span id="cb10-783"><a href="#cb10-783" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-784"><a href="#cb10-784" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pseudo_table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb10-785"><a href="#cb10-785" aria-hidden="true" tabindex="-1"></a>    pseudo_df</span>
<span id="cb10-786"><a href="#cb10-786" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">bordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-787"><a href="#cb10-787" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-788"><a href="#cb10-788" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.2 Build &amp; render the pseudonym-only communication network</span></span>
<span id="cb10-789"><a href="#cb10-789" aria-hidden="true" tabindex="-1"></a>  pseudo_labels <span class="ot">&lt;-</span> pseudo_df<span class="sc">$</span>label</span>
<span id="cb10-790"><a href="#cb10-790" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-791"><a href="#cb10-791" aria-hidden="true" tabindex="-1"></a>  pv_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> pseudo_labels, <span class="at">label =</span> pseudo_labels)</span>
<span id="cb10-792"><a href="#cb10-792" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-793"><a href="#cb10-793" aria-hidden="true" tabindex="-1"></a>  pv_edges <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-794"><a href="#cb10-794" aria-hidden="true" tabindex="-1"></a>    <span class="co"># attach sender label</span></span>
<span id="cb10-795"><a href="#cb10-795" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-796"><a href="#cb10-796" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-797"><a href="#cb10-797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-798"><a href="#cb10-798" aria-hidden="true" tabindex="-1"></a>    <span class="co"># attach receiver label</span></span>
<span id="cb10-799"><a href="#cb10-799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-800"><a href="#cb10-800" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-801"><a href="#cb10-801" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-802"><a href="#cb10-802" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(from <span class="sc">%in%</span> pseudo_labels, to <span class="sc">%in%</span> pseudo_labels) <span class="sc">%&gt;%</span></span>
<span id="cb10-803"><a href="#cb10-803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb10-804"><a href="#cb10-804" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-805"><a href="#cb10-805" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>pseudonym_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb10-806"><a href="#cb10-806" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visNetwork</span>(pv_nodes, pv_edges) <span class="sc">%&gt;%</span></span>
<span id="cb10-807"><a href="#cb10-807" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-808"><a href="#cb10-808" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-809"><a href="#cb10-809" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-810"><a href="#cb10-810" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-811"><a href="#cb10-811" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.3 Conclusion</span></span>
<span id="cb10-812"><a href="#cb10-812" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task3_conclusion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-813"><a href="#cb10-813" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb10-814"><a href="#cb10-814" aria-hidden="true" tabindex="-1"></a>      <span class="st">"→ Identified pseudonyms:"</span>,</span>
<span id="cb10-815"><a href="#cb10-815" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(pseudo_df<span class="sc">$</span>label, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb10-816"><a href="#cb10-816" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb10-817"><a href="#cb10-817" aria-hidden="true" tabindex="-1"></a>      <span class="st">"With the explicit identification of pseudonyms such as “Boss,” “The Intern,” “The Accountant,” “Mrs. Money,” “The Middleman,” “The Lookout,” and “Small Fry,” my understanding of the activities within the Oceanus network changed significantly."</span>,</span>
<span id="cb10-818"><a href="#cb10-818" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Initially, communications and relationships appeared to be fragmented among many individuals and vessels. However, after mapping pseudonyms onto the network, several important patterns emerged:"</span>,</span>
<span id="cb10-819"><a href="#cb10-819" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb10-820"><a href="#cb10-820" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Pseudonyms as Key Hubs: In the visual network, the detected pseudonyms are not peripheral actors—they consistently occupy central hub positions, connecting to multiple vessels and people through various types of relationships (such as “Reports,” “Coordinates,” “Operates,” and “Suspicious”)."</span>,</span>
<span id="cb10-821"><a href="#cb10-821" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Obscured True Roles: What previously looked like many unrelated participants was actually a small set of influential actors operating under multiple pseudonyms. For example, “The Intern” and “Boss” are both connected to several vessels via “Coordinates” and “Operates” relationships, indicating they may be orchestrating or managing operations behind the scenes.)."</span>,</span>
<span id="cb10-822"><a href="#cb10-822" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Concealment of Illicit Activity: The structure revealed that pseudonyms are often used to mask direct links between real individuals and vessels—particularly in suspicious or high-frequency communication events. This suggests intentional obfuscation, possibly to hide illicit coordination or the flow of sensitive information.)"</span>,</span>
<span id="cb10-823"><a href="#cb10-823" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-Redefining Influence and Risk: By highlighting pseudonyms, it becomes clear that influence within the network is far more centralized than the real-name view suggested. A few pseudonyms control or interact with a large proportion of vessels and people, making them high-value targets for further investigation."</span>,</span>
<span id="cb10-824"><a href="#cb10-824" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-825"><a href="#cb10-825" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-826"><a href="#cb10-826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-827"><a href="#cb10-827" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-828"><a href="#cb10-828" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Task 4: Nadia Conti Investigation ---</span></span>
<span id="cb10-829"><a href="#cb10-829" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-830"><a href="#cb10-830" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ——————— SERVER ———————</span></span>
<span id="cb10-831"><a href="#cb10-831" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-832"><a href="#cb10-832" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.0 Nadia’s node ID</span></span>
<span id="cb10-833"><a href="#cb10-833" aria-hidden="true" tabindex="-1"></a>  nadia_id <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(id)</span>
<span id="cb10-834"><a href="#cb10-834" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-835"><a href="#cb10-835" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.1 Nadia’s 1-Hop Ego Network (Louvain) —</span></span>
<span id="cb10-836"><a href="#cb10-836" aria-hidden="true" tabindex="-1"></a>  ego1 <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>),</span>
<span id="cb10-837"><a href="#cb10-837" aria-hidden="true" tabindex="-1"></a>                         <span class="at">order =</span> <span class="dv">1</span>,</span>
<span id="cb10-838"><a href="#cb10-838" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nodes =</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>))[[<span class="dv">1</span>]]</span>
<span id="cb10-839"><a href="#cb10-839" aria-hidden="true" tabindex="-1"></a>  com1 <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(ego1)</span>
<span id="cb10-840"><a href="#cb10-840" aria-hidden="true" tabindex="-1"></a>  mem1 <span class="ot">&lt;-</span> <span class="fu">membership</span>(com1)</span>
<span id="cb10-841"><a href="#cb10-841" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-842"><a href="#cb10-842" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_ego_1hop <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-843"><a href="#cb10-843" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggraph</span>(ego1, <span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span></span>
<span id="cb10-844"><a href="#cb10-844" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">"grey80"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-845"><a href="#cb10-845" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(mem1)), <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb10-846"><a href="#cb10-846" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> <span class="fu">factor</span>(mem1)),</span>
<span id="cb10-847"><a href="#cb10-847" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repel=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb10-848"><a href="#cb10-848" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Nadia’s 1-Hop Ego Network"</span>, <span class="at">color =</span> <span class="st">"Comm"</span>) <span class="sc">+</span></span>
<span id="cb10-849"><a href="#cb10-849" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb10-850"><a href="#cb10-850" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-851"><a href="#cb10-851" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-852"><a href="#cb10-852" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.2 Sent vs Received Communications Networks —</span></span>
<span id="cb10-853"><a href="#cb10-853" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-854"><a href="#cb10-854" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare sent edges/nodes</span></span>
<span id="cb10-855"><a href="#cb10-855" aria-hidden="true" tabindex="-1"></a>  sent_edges1 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-856"><a href="#cb10-856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sender <span class="sc">==</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb10-857"><a href="#cb10-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-858"><a href="#cb10-858" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-859"><a href="#cb10-859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-860"><a href="#cb10-860" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-861"><a href="#cb10-861" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb10-862"><a href="#cb10-862" aria-hidden="true" tabindex="-1"></a>  sent_nodes1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">unique</span>(<span class="fu">c</span>(sent_edges1<span class="sc">$</span>from, sent_edges1<span class="sc">$</span>to)),</span>
<span id="cb10-863"><a href="#cb10-863" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> id)</span>
<span id="cb10-864"><a href="#cb10-864" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-865"><a href="#cb10-865" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_sent_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb10-866"><a href="#cb10-866" aria-hidden="true" tabindex="-1"></a>    g_sent <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(sent_edges1,</span>
<span id="cb10-867"><a href="#cb10-867" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vertices =</span> sent_nodes1,</span>
<span id="cb10-868"><a href="#cb10-868" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-869"><a href="#cb10-869" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visIgraph</span>(g_sent, <span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-870"><a href="#cb10-870" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-871"><a href="#cb10-871" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-872"><a href="#cb10-872" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-873"><a href="#cb10-873" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare received edges/nodes</span></span>
<span id="cb10-874"><a href="#cb10-874" aria-hidden="true" tabindex="-1"></a>  recv_edges1 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-875"><a href="#cb10-875" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(receiver <span class="sc">==</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb10-876"><a href="#cb10-876" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-877"><a href="#cb10-877" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">from =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-878"><a href="#cb10-878" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, <span class="at">label =</span> name),</span>
<span id="cb10-879"><a href="#cb10-879" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">to =</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb10-880"><a href="#cb10-880" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(from, to)</span>
<span id="cb10-881"><a href="#cb10-881" aria-hidden="true" tabindex="-1"></a>  recv_nodes1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">unique</span>(<span class="fu">c</span>(recv_edges1<span class="sc">$</span>from, recv_edges1<span class="sc">$</span>to)),</span>
<span id="cb10-882"><a href="#cb10-882" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> id)</span>
<span id="cb10-883"><a href="#cb10-883" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-884"><a href="#cb10-884" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_recv_net <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb10-885"><a href="#cb10-885" aria-hidden="true" tabindex="-1"></a>    g_recv <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(recv_edges1,</span>
<span id="cb10-886"><a href="#cb10-886" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">vertices =</span> recv_nodes1,</span>
<span id="cb10-887"><a href="#cb10-887" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-888"><a href="#cb10-888" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visIgraph</span>(g_recv, <span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-889"><a href="#cb10-889" aria-hidden="true" tabindex="-1"></a>      <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-890"><a href="#cb10-890" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-891"><a href="#cb10-891" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-892"><a href="#cb10-892" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.3 Findings —</span></span>
<span id="cb10-893"><a href="#cb10-893" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task4_1_findings <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-894"><a href="#cb10-894" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb10-895"><a href="#cb10-895" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Nodes involved: Nadia, Davis, Elise, Haacklee Harbor, Liam, Marlin,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-896"><a href="#cb10-896" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Neptune, Oceanus City Council, Remora, Rodriguez,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-897"><a href="#cb10-897" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sailor Shifts Team, Sentinel, V. Miesel Shipping.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb10-898"><a href="#cb10-898" aria-hidden="true" tabindex="-1"></a>      <span class="st">"• Sent more direct communications to Liam (2) and Neptune (2).</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-899"><a href="#cb10-899" aria-hidden="true" tabindex="-1"></a>      <span class="st">"• Received more communications from Davis (5), Elise (3), Liam (2).</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb10-900"><a href="#cb10-900" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Next step: drill into suspicious chars/activities."</span></span>
<span id="cb10-901"><a href="#cb10-901" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-902"><a href="#cb10-902" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-903"><a href="#cb10-903" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-904"><a href="#cb10-904" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.4 Nadia’s 2-Hop Ego (Degree Centrality) —</span></span>
<span id="cb10-905"><a href="#cb10-905" aria-hidden="true" tabindex="-1"></a>  ego2 <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(<span class="fu">as.undirected</span>(g_ig, <span class="at">mode=</span><span class="st">"collapse"</span>),</span>
<span id="cb10-906"><a href="#cb10-906" aria-hidden="true" tabindex="-1"></a>                         <span class="at">order =</span> <span class="dv">2</span>,</span>
<span id="cb10-907"><a href="#cb10-907" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nodes =</span> <span class="fu">which</span>(<span class="fu">V</span>(g_ig)<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>))[[<span class="dv">1</span>]]</span>
<span id="cb10-908"><a href="#cb10-908" aria-hidden="true" tabindex="-1"></a>  deg2 <span class="ot">&lt;-</span> <span class="fu">degree</span>(ego2)</span>
<span id="cb10-909"><a href="#cb10-909" aria-hidden="true" tabindex="-1"></a>  deg2_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">names</span>(deg2), <span class="at">degree =</span> deg2)</span>
<span id="cb10-910"><a href="#cb10-910" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-911"><a href="#cb10-911" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_ego_2hop <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb10-912"><a href="#cb10-912" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(deg2_df, <span class="fu">aes</span>(<span class="fu">reorder</span>(name, degree), degree)) <span class="sc">+</span></span>
<span id="cb10-913"><a href="#cb10-913" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb10-914"><a href="#cb10-914" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-915"><a href="#cb10-915" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Nadia’s 2-Hop Ego (Degree Centrality)"</span>,</span>
<span id="cb10-916"><a href="#cb10-916" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Node"</span>, <span class="at">y =</span> <span class="st">"Degree"</span>) <span class="sc">+</span></span>
<span id="cb10-917"><a href="#cb10-917" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-919"><a href="#cb10-919" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-920"><a href="#cb10-920" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.1.5 Conclusion —</span></span>
<span id="cb10-921"><a href="#cb10-921" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>task4_1_conclusion <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb10-922"><a href="#cb10-922" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb10-923"><a href="#cb10-923" aria-hidden="true" tabindex="-1"></a>      <span class="st">"1-Hop nodes: Nadia, Davis, Elise, Haacklee Harbor, Liam, Marlin,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-924"><a href="#cb10-924" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Neptune, Oceanus City Council, Remora, Rodriguez,</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-925"><a href="#cb10-925" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sailor Shifts Team, Sentinel, V. Miesel Shipping.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb10-926"><a href="#cb10-926" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2-Hop additions: EcoVigil, Sam, The Accountant, Nemo Reef.</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb10-927"><a href="#cb10-927" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Use these 2-hop nodes to drill deeper for suspicious links."</span></span>
<span id="cb10-928"><a href="#cb10-928" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-929"><a href="#cb10-929" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-930"><a href="#cb10-930" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-931"><a href="#cb10-931" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.2.1 Plotted Timeline for all 2-Hop actors —</span></span>
<span id="cb10-932"><a href="#cb10-932" aria-hidden="true" tabindex="-1"></a>  hop2_names <span class="ot">&lt;-</span> <span class="fu">V</span>(ego2)<span class="sc">$</span>name</span>
<span id="cb10-933"><a href="#cb10-933" aria-hidden="true" tabindex="-1"></a>  id_map    <span class="ot">&lt;-</span> nodes_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">%in%</span> hop2_names) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(id, name)</span>
<span id="cb10-934"><a href="#cb10-934" aria-hidden="true" tabindex="-1"></a>  timeline2 <span class="ot">&lt;-</span> msgs <span class="sc">%&gt;%</span></span>
<span id="cb10-935"><a href="#cb10-935" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sender <span class="sc">%in%</span> id_map<span class="sc">$</span>id <span class="sc">|</span> receiver <span class="sc">%in%</span> id_map<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb10-936"><a href="#cb10-936" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Actor =</span> <span class="fu">if_else</span>(sender <span class="sc">%in%</span> id_map<span class="sc">$</span>id,</span>
<span id="cb10-937"><a href="#cb10-937" aria-hidden="true" tabindex="-1"></a>                           id_map<span class="sc">$</span>name[<span class="fu">match</span>(sender, id_map<span class="sc">$</span>id)],</span>
<span id="cb10-938"><a href="#cb10-938" aria-hidden="true" tabindex="-1"></a>                           id_map<span class="sc">$</span>name[<span class="fu">match</span>(receiver, id_map<span class="sc">$</span>id)]))</span>
<span id="cb10-939"><a href="#cb10-939" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-940"><a href="#cb10-940" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_2hop_timeline <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb10-941"><a href="#cb10-941" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline2, <span class="fu">aes</span>(date, hour, <span class="at">color =</span> Actor,</span>
<span id="cb10-942"><a href="#cb10-942" aria-hidden="true" tabindex="-1"></a>                               <span class="at">text =</span> <span class="fu">paste0</span>(Actor, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">format</span>(ts, <span class="st">"%Y-%m-%d %H:%M"</span>)))) <span class="sc">+</span></span>
<span id="cb10-943"><a href="#cb10-943" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-944"><a href="#cb10-944" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Hour"</span>, <span class="at">color =</span> <span class="st">"Actor"</span>) <span class="sc">+</span></span>
<span id="cb10-945"><a href="#cb10-945" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb10-946"><a href="#cb10-946" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span>
<span id="cb10-947"><a href="#cb10-947" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-948"><a href="#cb10-948" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-949"><a href="#cb10-949" aria-hidden="true" tabindex="-1"></a>  <span class="co"># — 4.2.2 Ego &amp; Comms Table for 2-Hop actors —</span></span>
<span id="cb10-950"><a href="#cb10-950" aria-hidden="true" tabindex="-1"></a>  comm2_table <span class="ot">&lt;-</span> timeline2 <span class="sc">%&gt;%</span></span>
<span id="cb10-951"><a href="#cb10-951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb10-952"><a href="#cb10-952" aria-hidden="true" tabindex="-1"></a>      <span class="at">Date     =</span> <span class="fu">as.character</span>(date),</span>
<span id="cb10-953"><a href="#cb10-953" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time     =</span> <span class="fu">format</span>(ts, <span class="st">"%H:%M"</span>),</span>
<span id="cb10-954"><a href="#cb10-954" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sender   =</span> nodes_tbl<span class="sc">$</span>name[<span class="fu">match</span>(sender, nodes_tbl<span class="sc">$</span>id)],</span>
<span id="cb10-955"><a href="#cb10-955" aria-hidden="true" tabindex="-1"></a>      <span class="at">Receiver =</span> nodes_tbl<span class="sc">$</span>name[<span class="fu">match</span>(receiver, nodes_tbl<span class="sc">$</span>id)],</span>
<span id="cb10-956"><a href="#cb10-956" aria-hidden="true" tabindex="-1"></a>      <span class="at">EventID  =</span> event_id</span>
<span id="cb10-957"><a href="#cb10-957" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-958"><a href="#cb10-958" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-959"><a href="#cb10-959" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>nadia_comm_table <span class="ot">&lt;-</span> DT<span class="sc">::</span><span class="fu">renderDataTable</span>({</span>
<span id="cb10-960"><a href="#cb10-960" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">datatable</span>(comm2_table,</span>
<span id="cb10-961"><a href="#cb10-961" aria-hidden="true" tabindex="-1"></a>                  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-962"><a href="#cb10-962" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-963"><a href="#cb10-963" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-964"><a href="#cb10-964" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-965"><a href="#cb10-965" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-966"><a href="#cb10-966" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-967"><a href="#cb10-967" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-968"><a href="#cb10-968" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-969"><a href="#cb10-969" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-970"><a href="#cb10-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-971"><a href="#cb10-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-972"><a href="#cb10-972" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>