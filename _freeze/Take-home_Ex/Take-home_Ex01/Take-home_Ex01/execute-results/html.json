{
  "hash": "a6517ad0e469d90564dc94953ca78a82",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 01\"\nauthor: \"Yang Lu\"\ndate: \"3 May 2025\"\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nexecute: \n  eval: true  \n  echo: true  \n  warning: false \n  freeze: true \n---\n\n\n\n## Overview\n\n------------------------------------------------------------------------\n\n## **Setting the scene**\n\nA local online media company that publishes daily content on digital platforms is planning to release an article on **demographic structures and distribution of Singapore in 2024**.\n\n## **About Data**\n\nI will use the data for this task from the [Singapore Residents by Planning Area/Subzone, Single Year of Age and Sex, June 2024' dataset, published by the Department of Statistics, Singapore (DOS)](https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data)\n\n![](images/clipboard-2786007129.png){width=\"581\"}\n\n## **My Task**\n\nAs the graphical editor of the media company, my task is to design and prepare up to **three** data visualisations to support an upcoming article on Singapore’s demographic structure and distribution in 2024.\n\n## Getting started\n\n------------------------------------------------------------------------\n\n### Load packages\n\nFirstly, write below code chunk to install and check the R packages installed.\n\n-   `tidyverse` → Core data wrangling & plotting (`readr`, `dplyr`, `ggplot2`, etc.)\n\n-   `gapminder` → Sample dataset & example pipeline for animated bubble plots.\n\n-   `ggiraph` → Make ggplot2 charts interactive (tooltips, hover/click).\n\n-   `plotly` → Convert plots into fully interactive JavaScript charts.\n\n-   `patchwork` → Combine multiple ggplots into a single layout.\n\n-   `DT` → Render data frames as interactive HTML tables.\n\n-   `gganimate` → Animate ggplot2 visuals via transitions & easing.\n\n-   `gifski` → Render gganimate output as a shareable GIF file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,ggiraph,\n               plotly, patchwork, \n               DT,gifski,\n               gapminder,gganimate)\n```\n:::\n\n\n\n### Import data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_age_sex_2024 <- read_csv(\"respopagesex2024/respopagesex2024.csv\")\n```\n:::\n\n\n\n### **Review the dataframe's structure**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(population_age_sex_2024)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,424\nColumns: 6\n$ PA   <chr> \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo K…\n$ SZ   <chr> \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Town Centre\", \"Ang Mo Kio T…\n$ Age  <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"5\", \"6\", …\n$ Sex  <chr> \"Males\", \"Females\", \"Males\", \"Females\", \"Males\", \"Females\", \"Male…\n$ Pop  <dbl> 10, 10, 10, 10, 10, 10, 10, 10, 30, 10, 20, 10, 20, 30, 30, 10, 3…\n$ Time <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024,…\n```\n\n\n:::\n:::\n\n\n\n### Checking duplicate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopulation_age_sex_2024[duplicated(population_age_sex_2024),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <chr>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n\n\n:::\n:::\n\n\n\n## Filtering data for selected variables\n\n| Variable Abbreviation | Variable Term | Variable Descrption |\n|:-------------------|:------------------|---------------------------------|\n| PA | Planning Area | These are the main geographical divisions used for planning and census purposes in Singapore. They are delineated by the Urban Redevelopment Authority (URA). |\n| SZ | Subzone | Each planning area is further divided into subzones, which are smaller areas typically focused around a specific activity or neighborhood center. For example, within the Singapore River planning area, subzones include Boat Quay, Clarke Quay, and Robertson Quay. |\n| Age | Age in years | The age of individuals, measured in completed years. |\n| Sex | Gender | Biological sex classification of the population group, recorded as “Males” or “Females.” |\n| Pop | Population count | The total number of individuals in each age–sex group (or area) for the given year. |\n| Time | Year | The calendar year to which the population data refers (e.g. 2024). |\n\n## EDA 1: What is Singapore’s overall age-sex profile in 2024?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(scales)\nlibrary(plotly)\n\npop_pyramid <- population_age_sex_2024 %>%\n  mutate(\n    Age_num = case_when(\n      Age == \"90_and_Over\" ~ 85,\n      TRUE                 ~ as.numeric(Age)\n    )\n  ) %>%\n  filter(Time == 2024, !is.na(Age_num)) %>%\n  mutate(\n    AgeGroup = cut(\n      Age_num,\n      breaks = c(seq(0, 85, by = 5), Inf),\n      right = FALSE,\n      labels = paste0(seq(0, 80, by = 5), \"-\", seq(4, 84, by = 5), c(rep(\"\",17), \"+\"))\n    )\n  ) %>%\n  group_by(AgeGroup, Sex) %>%\n  summarise(count = sum(Pop), .groups = \"drop\") %>%\n  mutate(\n    count    = ifelse(Sex == \"Males\", -count, count),\n    AgeGroup = fct_rev(AgeGroup)\n  )\n\nbase_plot <- ggplot(pop_pyramid, \n                    aes(x = count, \n                        y = AgeGroup, \n                        fill = Sex,\n                        text = paste0(\n                          AgeGroup, \"\\n\",\n                          Sex, \": \", comma(abs(count)), \" people\"\n                        ))) +\n  geom_col(width = 0.8, colour = \"white\") +\n  scale_x_continuous(\n    breaks = pretty_breaks(n = 5),\n    labels = comma,\n    expand = expansion(mult = c(0.02, 0.02))\n  ) +\n  scale_fill_manual(values = c(\"Males\" = \"#75E6E1\", \"Females\" = \"#E6757A\")) +\n  labs(\n    title = \"Age-Sex and Population Pyramids of Singapore (2024)\",\n    x     = \"Population count\",\n    y     = \"Age group\",\n    fill  = NULL\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid.major.y = element_blank(),\n    panel.grid.major.x = element_line(colour = \"#ECECEC\"),\n    axis.text.x        = element_text(margin = margin(t = 5)),\n    legend.position    = \"bottom\"\n  )\nggplotly(base_plot, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-dc2a6334547d5e0995e7\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-dc2a6334547d5e0995e7\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[83550,99100,100490,104160,110570,134990,165620,166150,164120,157770,158690,149970,149770,136150,107590,73330,45290,44740],\"base\":[17.600000000000001,16.600000000000001,15.6,14.6,13.6,12.6,11.6,10.6,9.5999999999999996,8.5999999999999996,7.5999999999999996,6.5999999999999996,5.5999999999999996,4.5999999999999996,3.6000000000000001,2.6000000000000001,1.6000000000000001,0.59999999999999998],\"x\":[41775,49550,50245,52080,55285,67495,82810,83075,82060,78885,79345,74985,74885,68075,53795,36665,22645,22370],\"y\":[0.79999999999999716,0.79999999999999716,0.79999999999999893,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000027,0.79999999999999982,0.79999999999999982,0.79999999999999993],\"text\":[\"0-4<br />Females: 83,550 people\",\"5-9<br />Females: 99,100 people\",\"10-14<br />Females: 100,490 people\",\"15-19<br />Females: 104,160 people\",\"20-24<br />Females: 110,570 people\",\"25-29<br />Females: 134,990 people\",\"30-34<br />Females: 165,620 people\",\"35-39<br />Females: 166,150 people\",\"40-44<br />Females: 164,120 people\",\"45-49<br />Females: 157,770 people\",\"50-54<br />Females: 158,690 people\",\"55-59<br />Females: 149,970 people\",\"60-64<br />Females: 149,770 people\",\"65-69<br />Females: 136,150 people\",\"70-74<br />Females: 107,590 people\",\"75-79<br />Females: 73,330 people\",\"80-84<br />Females: 45,290 people\",\"0-4+<br />Females: 44,740 people\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(230,117,122,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,255,255,1)\"}},\"name\":\"Females\",\"legendgroup\":\"Females\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[87850,103620,104790,107670,114860,135250,155630,149340,146630,144140,149260,145080,147600,130550,99540,62080,32840,24750],\"base\":[17.600000000000001,16.600000000000001,15.6,14.6,13.6,12.6,11.6,10.6,9.5999999999999996,8.5999999999999996,7.5999999999999996,6.5999999999999996,5.5999999999999996,4.5999999999999996,3.6000000000000001,2.6000000000000001,1.6000000000000001,0.59999999999999998],\"x\":[-43925,-51810,-52395,-53835,-57430,-67625,-77815,-74670,-73315,-72070,-74630,-72540,-73800,-65275,-49770,-31040,-16420,-12375],\"y\":[0.79999999999999716,0.79999999999999716,0.79999999999999893,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000071,0.80000000000000027,0.79999999999999982,0.79999999999999982,0.79999999999999993],\"text\":[\"0-4<br />Males: 87,850 people\",\"5-9<br />Males: 103,620 people\",\"10-14<br />Males: 104,790 people\",\"15-19<br />Males: 107,670 people\",\"20-24<br />Males: 114,860 people\",\"25-29<br />Males: 135,250 people\",\"30-34<br />Males: 155,630 people\",\"35-39<br />Males: 149,340 people\",\"40-44<br />Males: 146,630 people\",\"45-49<br />Males: 144,140 people\",\"50-54<br />Males: 149,260 people\",\"55-59<br />Males: 145,080 people\",\"60-64<br />Males: 147,600 people\",\"65-69<br />Males: 130,550 people\",\"70-74<br />Males: 99,540 people\",\"75-79<br />Males: 62,080 people\",\"80-84<br />Males: 32,840 people\",\"0-4+<br />Males: 24,750 people\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(117,230,225,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,255,255,1)\"}},\"name\":\"Males\",\"legendgroup\":\"Males\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":46.286425902864259,\"r\":7.9701120797011216,\"b\":43.835616438356169,\"l\":59.775840597758425},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"title\":{\"text\":\"Age-Sex and Population Pyramids of Singapore (2024)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":19.128268991282692},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-162065.60000000001,172585.60000000001],\"tickmode\":\"array\",\"ticktext\":[\"-150,000\",\"-100,000\",\"-50,000\",\"0\",\"50,000\",\"100,000\",\"150,000\"],\"tickvals\":[-150000,-100000,-49999.999999999985,0,49999.999999999971,100000,149999.99999999997],\"categoryorder\":\"array\",\"categoryarray\":[\"-150,000\",\"-100,000\",\"-50,000\",\"0\",\"50,000\",\"100,000\",\"150,000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(236,236,236,1)\",\"gridwidth\":0.72455564360919278,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Population count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,18.600000000000001],\"tickmode\":\"array\",\"ticktext\":[\"0-4+\",\"80-84\",\"75-79\",\"70-74\",\"65-69\",\"60-64\",\"55-59\",\"50-54\",\"45-49\",\"40-44\",\"35-39\",\"30-34\",\"25-29\",\"20-24\",\"15-19\",\"10-14\",\"5-9\",\"0-4\"],\"tickvals\":[1,2,3,4,5,5.9999999999999991,7,8,9,10,11,12,13,14,15,16,17,18],\"categoryorder\":\"array\",\"categoryarray\":[\"0-4+\",\"80-84\",\"75-79\",\"70-74\",\"65-69\",\"60-64\",\"55-59\",\"50-54\",\"45-49\",\"40-44\",\"35-39\",\"30-34\",\"25-29\",\"20-24\",\"15-19\",\"10-14\",\"5-9\",\"0-4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Age group\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":12.7521793275218},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"6c6064e41099\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"6c6064e41099\",\"visdat\":{\"6c6064e41099\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.info style=\"color: #9DBCF3\"}\n## Insights {#sec-insights}\n\n-   The 2024 pyramid reveals a broad central bulge (ages 30–44), reflecting Singapore’s large working-age cohorts.\n-   Child and adolescent bands (0–19) are noticeably narrower, hinting at lower birth rates in recent years.\n-   The sex ratio is near-balanced among younger ages, tilts to a modest female surplus in middle age (35–59), and flips to a male edge in the oldest cohorts (85+).\n\n**Policy implications**\\\n- Workforce planning should account for the sizeable mid-career population.\\\n- A shrinking youth base may lead to future labour shortages and calls for strategies to bolster the next generation.\n:::\n\n## EDA 2: Which Planning Areas(PA) are the most populous, and how is that population split by gender?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(plotly)\n\npa_gender <- population_age_sex_2024 %>%\n  filter(Time == 2024) %>%\n  group_by(PA, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\")\n\ntop_pa_totals <- pa_gender %>%\n  group_by(PA) %>%\n  summarise(total = sum(Pop), .groups = \"drop\") %>%\n  arrange(desc(total)) %>%\n  slice_head(n = 10)\n\nplot_data <- pa_gender %>%\n  filter(PA %in% top_pa_totals$PA) %>%\n  mutate(PA = factor(PA, levels = top_pa_totals$PA))\n\nplot_ly(\n  data        = plot_data,\n  x           = ~Pop,\n  y           = ~PA,\n  color       = ~Sex,\n  colors      = c(\"Males\"   = \"#75E6E1\",\n                  \"Females\" = \"#E6757A\"),\n  type        = \"bar\",\n  orientation = \"h\",\n  text        = ~paste0(Sex, \": \", format(Pop, big.mark = \",\"), \" people\"),\n  hoverinfo   = \"text\"\n) %>%\n  layout(\n    barmode   = \"stack\",\n    hovermode = \"closest\",\n    title     = \"Singapore Top 10 Most Populous Planning Areas (2024)\",\n    xaxis     = list(\n      title      = \"Population\",\n      tickformat = \",\"\n    ),\n    yaxis = list(\n      title          = \"\",\n      categoryorder  = \"array\",\n      categoryarray  = top_pa_totals$PA  \n    ),\n    legend = list(orientation = \"h\", x = 0.3, y = -0.2)\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-0725a010b11d164f9a3c\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0725a010b11d164f9a3c\">{\"x\":{\"visdat\":{\"6c6060624134\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"6c6060624134\",\"attrs\":{\"6c6060624134\":{\"x\":{},\"y\":{},\"orientation\":\"h\",\"text\":{},\"hoverinfo\":\"text\",\"color\":{},\"colors\":[\"#75E6E1\",\"#E6757A\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"barmode\":\"stack\",\"hovermode\":\"closest\",\"title\":\"Singapore Top 10 Most Populous Planning Areas (2024)\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Population\",\"tickformat\":\",\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"categoryorder\":\"array\",\"categoryarray\":[\"Tampines\",\"Bedok\",\"Sengkang\",\"Jurong West\",\"Woodlands\",\"Yishun\",\"Hougang\",\"Punggol\",\"Choa Chu Kang\",\"Bukit Batok\"],\"type\":\"category\"},\"legend\":{\"orientation\":\"h\",\"x\":0.29999999999999999,\"y\":-0.20000000000000001},\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[143770,86070,96100,117490,129130,101730,135400,146050,127750,117400],\"y\":[\"Bedok\",\"Bukit Batok\",\"Choa Chu Kang\",\"Hougang\",\"Jurong West\",\"Punggol\",\"Sengkang\",\"Tampines\",\"Woodlands\",\"Yishun\"],\"orientation\":\"h\",\"text\":[\"Females: 143,770 people\",\"Females:  86,070 people\",\"Females:  96,100 people\",\"Females: 117,490 people\",\"Females: 129,130 people\",\"Females: 101,730 people\",\"Females: 135,400 people\",\"Females: 146,050 people\",\"Females: 127,750 people\",\"Females: 117,400 people\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Females\",\"marker\":{\"color\":\"rgba(230,117,122,1)\",\"line\":{\"color\":\"rgba(230,117,122,1)\"}},\"textfont\":{\"color\":\"rgba(230,117,122,1)\"},\"error_y\":{\"color\":\"rgba(230,117,122,1)\"},\"error_x\":{\"color\":\"rgba(230,117,122,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[133890,82320,94540,111290,128780,98150,130150,138900,127760,112920],\"y\":[\"Bedok\",\"Bukit Batok\",\"Choa Chu Kang\",\"Hougang\",\"Jurong West\",\"Punggol\",\"Sengkang\",\"Tampines\",\"Woodlands\",\"Yishun\"],\"orientation\":\"h\",\"text\":[\"Males: 133,890 people\",\"Males:  82,320 people\",\"Males:  94,540 people\",\"Males: 111,290 people\",\"Males: 128,780 people\",\"Males:  98,150 people\",\"Males: 130,150 people\",\"Males: 138,900 people\",\"Males: 127,760 people\",\"Males: 112,920 people\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Males\",\"marker\":{\"color\":\"rgba(117,230,225,1)\",\"line\":{\"color\":\"rgba(117,230,225,1)\"}},\"textfont\":{\"color\":\"rgba(117,230,225,1)\"},\"error_y\":{\"color\":\"rgba(117,230,225,1)\"},\"error_x\":{\"color\":\"rgba(117,230,225,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.info style=\"color: #9DBCF3\"}\n## Insights\n\n-   **Tampines** and **Bedok** emerge as the two most populous PAs in 2024, each hosting nearly 280 000 residents, followed closely by Jurong West and Woodlands (\\~260 000 – 270 000).\\\n-   Across all top ten areas, **male counts slightly exceed female** counts, with the largest gender gap in Tampines (\\~10 000 more males).\\\n-   **Younger dormitory towns** like Punggol and Sengkang show narrower sex‐ratios (\\~5 000–7 000 difference), hinting at a more balanced or family‐oriented population.\\\n-   Established estates—Tampines, Bedok, Jurong West—display both high density and a persistent male majority, possibly reflecting workforce demographics in these hubs.\\\n-   **Policy takeaway**: Resource planning (housing, transport, healthcare) should account for both the sheer volume in these top PAs and their modest but consistent male‐leaning imbalance.\\\n:::\n\n## EDA 3: Comparing Top 5 Subzones（SZ) by Young (25–35) vs. Elderly (70 +) Populations\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(forcats)\nlibrary(scales)\n\nyoung_top5 <- population_age_sex_2024 %>%\n  mutate(AgeNum = as.numeric(Age)) %>%\n  filter(Time == 2024, AgeNum >= 25, AgeNum <= 35) %>%\n  group_by(SZ) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  slice_max(Pop, n = 5) %>%\n  mutate(SZ = fct_reorder(SZ, Pop))\n\nold_top5 <- population_age_sex_2024 %>%\n  mutate(AgeNum = as.numeric(Age)) %>%\n  filter(Time == 2024, AgeNum >= 70) %>%\n  group_by(SZ) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  slice_max(Pop, n = 5) %>%\n  mutate(SZ = fct_reorder(SZ, Pop))\n\n\np1 <- ggplot(young_top5, aes(x = SZ, y = Pop, fill = Pop)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  scale_y_continuous(labels = comma) +\n  labs(title = \"Top 5 Subzones: Age 25–35\", x = NULL, y = \"Population\") +\n  theme_minimal()\n\np2 <- ggplot(old_top5, aes(x = SZ, y = Pop, fill = Pop)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  scale_y_continuous(labels = comma) +\n  labs(title = \"Top 5 Subzones: Age 70+\", x = NULL, y = \"Population\") +\n  theme_minimal()\n\np1 + p2 + \n  plot_layout(ncol = 2) + \n  plot_annotation(\n    title = \"Comparison of Top 5 Subzones: Young vs. Elderly (2024)\",\n    theme = theme(plot.title = element_text(face = \"bold\"))\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n::: {.info style=\"color: #9DBCF3\"}\n## Insights\n\n-   Tampines East leads both 25–35 and 70+ groups, indicating a broad, intergenerational base.\\\n-   Woodlands East, Yishun East, Tampines West and Yunnan dominate the 25–35 bracket, reflecting an influx of working-age families into these newer estates.\\\n-   Bedok North, Bedok South and Hong Kah feature in the 70+ top-5, highlighting higher elderly concentrations in these mature precincts.\\\n-   Tampines West appears in both lists, suggesting a more balanced age profile.\\\n-   These spatial patterns pinpoint where to prioritize youth services (childcare, schools) versus eldercare resources (healthcare, senior centers).\\\n-   Planners can leverage this nuanced insight to allocate infrastructure and social programs more effectively.\\\n:::\n\n## Overall insight and conclusion \n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}